{"version":3,"file":"EditProperty-gNlv7Mkn.js","sources":["../../src/hooks/usePropertyDelete.ts","../../src/pages/EditProperty.tsx"],"sourcesContent":["import { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { supabase } from '@/lib/supabase';\nimport { ERROR_MESSAGES } from '@/constants';\nimport { AppError, handleError, handleSuccess } from '@/lib/errorHandler';\nimport { logger } from '@/services/logger';\nimport { useMediaUpload, type MediaUrls } from './useMediaUpload';\n\n/**\n * Hook for deleting properties\n * Handles both media deletion and database record removal\n */\nexport const usePropertyDelete = () => {\n  const [deleting, setDeleting] = useState(false);\n  const navigate = useNavigate();\n  const { deleteMedia } = useMediaUpload();\n\n  /**\n   * Delete a property and all its associated media\n   */\n  const deleteProperty = async (\n    propertyId: string,\n    userId: string,\n    mediaUrls: MediaUrls\n  ): Promise<void> => {\n    setDeleting(true);\n\n    try {\n      // 1. Verify ownership\n      const { data: property, error: fetchError } = await supabase\n        .from('properties')\n        .select('owner_id')\n        .eq('id', propertyId)\n        .single();\n\n      if (fetchError || !property) {\n        logger.error('Property not found', { error: fetchError, propertyId });\n        throw new AppError('PROPERTY_NOT_FOUND');\n      }\n\n      if (property.owner_id !== userId) {\n        logger.error('Unauthorized delete attempt', { propertyId, userId });\n        throw new AppError('OWNER_ONLY');\n      }\n\n      // 2. Delete all media from storage\n      await deleteMedia(mediaUrls);\n\n      // 3. Delete property from database\n      const { error: deleteError } = await supabase\n        .from('properties')\n        .delete()\n        .eq('id', propertyId);\n\n      if (deleteError) {\n        logger.error('Failed to delete property', { error: deleteError, propertyId });\n        throw new AppError('PROPERTY_DELETE_FAILED');\n      }\n\n      handleSuccess('PROPERTY_DELETED');\n      navigate('/mes-biens');\n    } catch (error) {\n      handleError(error, ERROR_MESSAGES.PROPERTY_DELETE_FAILED);\n    } finally {\n      setDeleting(false);\n    }\n  };\n\n  return {\n    deleting,\n    deleteProperty,\n  };\n};\n","import { useEffect, useState, useRef } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { z } from 'zod';\nimport { usePropertyForm } from '@/hooks/usePropertyForm';\nimport { useMediaUpload, type MediaFiles, type MediaUrls } from '@/hooks/useMediaUpload';\nimport { usePropertyDelete } from '@/hooks/usePropertyDelete';\nimport { usePropertyPermissions } from '@/hooks/usePropertyPermissions';\nimport { useAgencyMandates } from '@/hooks/useAgencyMandates';\nimport { supabase } from '@/lib/supabase';\nimport { toast } from '@/hooks/use-toast';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Info } from 'lucide-react';\nimport Navbar from '@/components/Navbar';\nimport Footer from '@/components/Footer';\nimport { DynamicBreadcrumb } from '@/components/navigation/DynamicBreadcrumb';\nimport { FormProgressIndicator, type Step } from '@/components/forms/FormProgressIndicator';\nimport { FormStepper } from '@/components/forms/FormStepper';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from '@/components/ui/alert-dialog';\nimport { Loader2, Trash2 } from 'lucide-react';\nimport { MediaUploader } from '@/components/property/MediaUploader';\nimport { type PropertyFormData } from '@/components/property/form/PropertyFormSchema';\nimport { PropertyBasicInfo } from '@/components/property/form/PropertyBasicInfo';\nimport { PropertyLocation } from '@/components/property/form/PropertyLocation';\nimport { PropertyCharacteristicsForm } from '@/components/property/form/PropertyCharacteristicsForm';\nimport { PropertyPricing } from '@/components/property/form/PropertyPricing';\nimport { PropertyWorkStatus } from '@/components/property/form/PropertyWorkStatus';\nimport { LocationPicker } from '@/components/property/LocationPicker';\n\nconst propertyFormSteps: Step[] = [\n  { id: 'basic', label: 'Type de bien' },\n  { id: 'location', label: 'Informations générales' },\n  { id: 'characteristics', label: 'Photos et description' },\n  { id: 'pricing', label: 'Prix et disponibilité' },\n  { id: 'media', label: 'Vérification' }\n];\n\nconst EditProperty = () => {\n  const { id } = useParams<{ id: string }>();\n  const navigate = useNavigate();\n  const { user, canEditProperty, requireOwnerAccess, hasAgencyPermission, activeMandates, asAgency } = usePropertyPermissions();\n  const { form, loading, submitting, submitProperty } = usePropertyForm(id);\n  const { uploading, uploadMedia } = useMediaUpload();\n  const { deleting, deleteProperty } = usePropertyDelete();\n  \n  const [propertyOwnerId, setPropertyOwnerId] = useState<string | null>(null);\n  const [activeMandate, setActiveMandate] = useState<any>(null);\n  \n  const [currentStep, setCurrentStep] = useState(0);\n  const basicInfoRef = useRef<HTMLDivElement>(null);\n  const locationRef = useRef<HTMLDivElement>(null);\n  const characteristicsRef = useRef<HTMLDivElement>(null);\n  const pricingRef = useRef<HTMLDivElement>(null);\n  const mediaRef = useRef<HTMLDivElement>(null);\n  \n  const [existingMedia, setExistingMedia] = useState<MediaUrls>({\n    images: [],\n    mainImage: null,\n    videoUrl: null,\n    panoramas: [],\n    floorPlans: [],\n  });\n  \n  const [mediaFiles, setMediaFiles] = useState<MediaFiles>({\n    images: [],\n    video: null,\n    panoramas: [],\n    floorPlans: [],\n    virtualTourUrl: '',\n  });\n\n  const [selectedLocation, setSelectedLocation] = useState<{lat: number, lng: number} | null>(null);\n  const [initialLocation, setInitialLocation] = useState<{lat: number, lng: number} | null>(null);\n\n  // Track scroll position to update current step\n  useEffect(() => {\n    const handleScroll = () => {\n      const sections = [\n        { ref: basicInfoRef, step: 0 },\n        { ref: locationRef, step: 1 },\n        { ref: characteristicsRef, step: 2 },\n        { ref: pricingRef, step: 3 },\n        { ref: mediaRef, step: 4 }\n      ];\n\n      for (let i = sections.length - 1; i >= 0; i--) {\n        const section = sections[i];\n        if (section.ref.current) {\n          const rect = section.ref.current.getBoundingClientRect();\n          if (rect.top <= 200) {\n            setCurrentStep(section.step);\n            break;\n          }\n        }\n      }\n    };\n\n    window.addEventListener('scroll', handleScroll);\n    return () => window.removeEventListener('scroll', handleScroll);\n  }, []);\n\n  // Load property data and media\n  useEffect(() => {\n    const loadPropertyMedia = async () => {\n      if (!id) return;\n\n      const { data: property, error } = await supabase\n        .from('properties')\n        .select('*')\n        .eq('id', id)\n        .single();\n\n      if (error || !property) {\n        toast({\n          title: \"Erreur\",\n          description: \"Bien introuvable\",\n          variant: \"destructive\",\n        });\n        navigate('/mes-biens');\n        return;\n      }\n\n      // Check ownership or agency permissions\n      setPropertyOwnerId(property.owner_id);\n      \n      if (!canEditProperty(property.owner_id, id)) {\n        toast({\n          title: \"Accès refusé\",\n          description: \"Vous ne pouvez pas modifier ce bien\",\n          variant: \"destructive\",\n        });\n        navigate('/mes-biens');\n        return;\n      }\n\n      // Find active mandate if user is an agency\n      if (user?.id && user.id !== property.owner_id) {\n        const mandate = activeMandates.find(m => \n          m.property_id === id || (!m.property_id && m.owner_id === property.owner_id)\n        );\n        setActiveMandate(mandate);\n      }\n\n      // Set existing media\n      setExistingMedia({\n        images: property.images || [],\n        mainImage: property.main_image || null,\n        videoUrl: property.video_url || null,\n        panoramas: (property.panoramic_images as any) || [],\n        floorPlans: (property.floor_plans as any) || [],\n      });\n\n      setMediaFiles(prev => ({\n        ...prev,\n        virtualTourUrl: property.virtual_tour_url || '',\n      }));\n\n      // Set initial location if available\n      if (property.latitude && property.longitude) {\n        setInitialLocation({ lat: property.latitude, lng: property.longitude });\n      }\n    };\n\n    loadPropertyMedia();\n  }, [id, canEditProperty, navigate]);\n\n  const onSubmit = async (data: PropertyFormData) => {\n    if (!id || !user) return;\n\n    try {\n      // Upload new media\n      const mediaUrls = await uploadMedia(id, mediaFiles, existingMedia);\n\n      // Update property with all data including media URLs\n      await submitProperty(data, mediaUrls, id, selectedLocation);\n\n      navigate('/mes-biens');\n    } catch (error) {\n      // Errors are already handled by the hooks\n    }\n  };\n\n  const handleDeleteProperty = async () => {\n    if (!id || !user) return;\n    await deleteProperty(id, user.id, existingMedia);\n  };\n\n  const accessCheck = requireOwnerAccess();\n  if (!accessCheck.hasAccess) {\n    return (\n      <div className=\"min-h-screen flex flex-col\">\n        <Navbar />\n        <main className=\"flex-1 container mx-auto px-4 py-12\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Accès refusé</CardTitle>\n              <CardDescription>{accessCheck.error}</CardDescription>\n            </CardHeader>\n          </Card>\n        </main>\n        <Footer />\n      </div>\n    );\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"h-8 w-8 animate-spin\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen flex flex-col\">\n      <Navbar />\n      <main className=\"flex-1 container mx-auto px-4 py-6 pt-24\">\n        <div className=\"max-w-4xl mx-auto\">\n          <DynamicBreadcrumb />\n          \n          <div className=\"flex justify-between items-center mb-6\">\n            <h1 className=\"text-3xl font-bold\">Modifier le bien</h1>\n            {propertyOwnerId && hasAgencyPermission(id!, propertyOwnerId, 'can_delete_properties') ? (\n              <AlertDialog>\n                <AlertDialogTrigger asChild>\n                  <Button variant=\"destructive\" disabled={deleting}>\n                    <Trash2 className=\"w-4 h-4 mr-2\" />\n                    Supprimer le bien\n                  </Button>\n                </AlertDialogTrigger>\n              <AlertDialogContent>\n                <AlertDialogHeader>\n                  <AlertDialogTitle>Êtes-vous sûr ?</AlertDialogTitle>\n                  <AlertDialogDescription>\n                    Cette action est irréversible. Le bien et toutes ses images seront supprimés définitivement.\n                  </AlertDialogDescription>\n                </AlertDialogHeader>\n                <AlertDialogFooter>\n                  <AlertDialogCancel>Annuler</AlertDialogCancel>\n                  <AlertDialogAction onClick={handleDeleteProperty}>\n                    Supprimer\n                  </AlertDialogAction>\n                </AlertDialogFooter>\n              </AlertDialogContent>\n            </AlertDialog>\n            ) : null}\n          </div>\n\n          {/* Agency mandate info */}\n          {activeMandate && propertyOwnerId && user?.id !== propertyOwnerId && (\n            <Alert className=\"mb-6\">\n              <Info className=\"h-4 w-4\" />\n              <AlertDescription>\n                <strong>Vous gérez ce bien en tant qu'agence</strong>\n                <div className=\"mt-2 text-sm\">\n                  <p className=\"font-medium mb-1\">Permissions accordées :</p>\n                  <ul className=\"list-disc list-inside space-y-1\">\n                    {activeMandate.permissions.can_edit_properties && <li>Modification du bien</li>}\n                    {activeMandate.permissions.can_view_applications && <li>Voir les candidatures</li>}\n                    {activeMandate.permissions.can_manage_applications && <li>Gérer les candidatures</li>}\n                    {activeMandate.permissions.can_create_leases && <li>Créer des baux</li>}\n                    {!activeMandate.permissions.can_delete_properties && (\n                      <li className=\"text-muted-foreground\">❌ Suppression non autorisée</li>\n                    )}\n                  </ul>\n                </div>\n              </AlertDescription>\n            </Alert>\n          )}\n\n          <FormStepper steps={propertyFormSteps} currentStep={currentStep} />\n          <FormProgressIndicator steps={propertyFormSteps} currentStep={currentStep} className=\"mt-6\" />\n\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n              <div ref={basicInfoRef} className=\"scroll-mt-32\">\n                <PropertyBasicInfo form={form} />\n              </div>\n              <div ref={locationRef} className=\"scroll-mt-32\">\n                <PropertyLocation form={form} />\n              </div>\n              \n              <LocationPicker \n                city={form.watch(\"city\")}\n                initialLat={initialLocation?.lat}\n                initialLng={initialLocation?.lng}\n                onLocationSelect={(lat, lng) => setSelectedLocation({ lat, lng })}\n              />\n\n              <div ref={characteristicsRef} className=\"scroll-mt-32\">\n                <PropertyCharacteristicsForm form={form} />\n              </div>\n              <div ref={pricingRef} className=\"scroll-mt-32\">\n                <PropertyPricing form={form} />\n              </div>\n              <PropertyWorkStatus form={form} />\n\n              <Card ref={mediaRef} className=\"scroll-mt-32\">\n                <CardHeader>\n                  <CardTitle>Médias</CardTitle>\n                  <CardDescription>Ajoutez ou modifiez les photos, vidéos et plans</CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <MediaUploader\n                    onImagesChange={(files) => setMediaFiles(prev => ({ ...prev, images: files }))}\n                    onVideoChange={(file) => setMediaFiles(prev => ({ ...prev, video: file }))}\n                    onPanoramaChange={(files) => setMediaFiles(prev => ({ ...prev, panoramas: files }))}\n                    onFloorPlanChange={(files) => setMediaFiles(prev => ({ ...prev, floorPlans: files }))}\n                    onVirtualTourUrlChange={(url) => setMediaFiles(prev => ({ ...prev, virtualTourUrl: url }))}\n                    uploading={uploading}\n                    existingImages={existingMedia.images}\n                    existingVideo={existingMedia.videoUrl}\n                    existingVirtualTourUrl={mediaFiles.virtualTourUrl}\n                    existingPanoramas={existingMedia.panoramas}\n                    existingFloorPlans={existingMedia.floorPlans}\n                  />\n                </CardContent>\n              </Card>\n\n              <div className=\"flex gap-4\">\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => navigate('/mes-biens')}\n                  disabled={submitting || uploading}\n                  className=\"flex-1\"\n                >\n                  Annuler\n                </Button>\n                <Button type=\"submit\" disabled={submitting || uploading} className=\"flex-1\">\n                  {submitting || uploading ? (\n                    <>\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                      Mise à jour en cours...\n                    </>\n                  ) : (\n                    'Enregistrer les modifications'\n                  )}\n                </Button>\n              </div>\n            </form>\n          </Form>\n        </div>\n      </main>\n      <Footer />\n    </div>\n  );\n};\n\nexport default EditProperty;\n"],"names":["usePropertyDelete","deleting","setDeleting","useState","navigate","useNavigate","deleteMedia","useMediaUpload","propertyId","userId","mediaUrls","property","fetchError","supabase","logger","AppError","deleteError","handleSuccess","error","handleError","ERROR_MESSAGES","propertyFormSteps","EditProperty","id","useParams","user","canEditProperty","requireOwnerAccess","hasAgencyPermission","activeMandates","usePropertyPermissions","form","loading","submitting","submitProperty","usePropertyForm","uploading","uploadMedia","deleteProperty","propertyOwnerId","setPropertyOwnerId","activeMandate","setActiveMandate","currentStep","setCurrentStep","basicInfoRef","useRef","locationRef","characteristicsRef","pricingRef","mediaRef","existingMedia","setExistingMedia","mediaFiles","setMediaFiles","selectedLocation","setSelectedLocation","initialLocation","setInitialLocation","useEffect","handleScroll","sections","i","section","toast","mandate","m","prev","onSubmit","data","handleDeleteProperty","accessCheck","jsx","Loader2","jsxs","Navbar","DynamicBreadcrumb","AlertDialog","AlertDialogTrigger","Button","Trash2","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","Alert","Info","AlertDescription","FormStepper","FormProgressIndicator","Form","PropertyBasicInfo","PropertyLocation","LocationPicker","lat","lng","PropertyCharacteristicsForm","PropertyPricing","PropertyWorkStatus","Card","CardHeader","CardTitle","CardDescription","CardContent","MediaUploader","files","file","url","Fragment","Footer"],"mappings":"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"}