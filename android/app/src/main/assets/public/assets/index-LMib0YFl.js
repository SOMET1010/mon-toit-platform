const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ExploreMap-DwJ-JqCl.js","assets/react-vendor-CPmH2tz8.js","assets/query-vendor-ByjIuei6.js","assets/monitoring-vendor-C7yD_Gmu.js","assets/ui-vendor-Dua12RDV.js","assets/common-vendor-CK5d0rWc.js","assets/styles-DXEvswlz.css","assets/route-admin-B1Ip8YDE.js","assets/charts-vendor-16YcNskv.js","assets/supabase-vendor-CzsKfTY-.js","assets/animation-vendor-BJe5VoH_.js","assets/route-property-b6Ka_7KN.js","assets/route-owner-C83ejxxl.js","assets/route-agency-BEE2sWoQ.js","assets/forms-vendor-DqOZ4YtP.js","assets/route-tenant-DNBKfVUX.js","assets/maps-vendor-B7X9GnXQ.js","assets/styles-BKWjo1HA.css","assets/FeaturedProperties-fpsYfsW4.js","assets/Offline-C6ZhGoZj.js","assets/MyMandates-4dUaJinv.js","assets/AddProperty-B0ajWnQ5.js","assets/LocationPicker-C-a9Wq3S.js","assets/FormProgressIndicator-BFIH4d_g.js","assets/FormStepper-CogL4h-a.js","assets/EditProperty-gNlv7Mkn.js","assets/Messages-_muaW2ep.js","assets/Application-Bjaa90b3.js","assets/Applications-RUk__IqI.js","assets/Leases-DmBdttAl.js","assets/Payments-BqGMhMEA.js","assets/Maintenance-Ck1SRhR6.js","assets/ScheduleVisit-Dk2FBewP.js"])))=>i.map(i=>d[i]);
var Tr=Object.defineProperty;var Pr=(s,t,r)=>t in s?Tr(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var at=(s,t,r)=>Pr(s,typeof t!="symbol"?t+"":t,r);import{r as i,j as e,cw as Ct,cx as St,cy as _t,cz as kt,X as _e,cA as At,cB as Tt,cC as Er,aK as Is,bJ as Us,cD as it,bc as oe,bI as Mr,bT as ys,_ as Pt,a5 as Ie,ah as U,af as ee,ai as Me,bL as bs,a8 as ms,an as rs,ac as Pe,bu as Ze,cE as Ir,cF as Lr,cG as zr,cH as Rr,cI as qr,cJ as Fr,cK as Vr,cL as Et,aJ as qe,av as Os,ax as Dr,bH as Mt,bd as It,c7 as Lt,ae as cs,aj as Ur,a$ as Ee,ak as es,cM as Bs,cN as zt,cO as Or,cP as Br,cQ as $r,bj as Rt,$ as $s,cR as Gr,cS as Hr,ad as ke,cT as Qr,ap as Y,al as Ls,cU as nt,c2 as Gs,cV as qt,b_ as Ns,bb as ns,bq as Kr,z as Xr,cW as Wr,cX as Ts,cY as Ft,cr as ws,cZ as Vt,c_ as us,bW as Yr,bX as Jr,bS as zs,bk as ls,c9 as Rs,ab as Re,bg as xs,aa as Fe,a6 as Hs,bG as hs,L as Qs,c$ as Zr,d0 as ea,bC as Ve,d1 as sa,bx as ta,bw as ra,bh as ps,a7 as Ps,bN as Dt,bO as aa,c8 as ia,a9 as K,bz as Ut,d2 as lt,bQ as qs,d3 as na,c4 as la,d4 as Ot,be as Ye,d5 as ca,d6 as oa,cq as Bt,d7 as da,d8 as ma,d9 as $t,da as Gt,db as ua,b4 as xa,c5 as ha,dc as pa,dd as fa,de as ga,cv as ja,cc as va,cd as ba,df as Na,dg as ya,dh as wa,di as Ca,bf as ct,dj as ot,b9 as dt,bM as mt,dk as Sa,dl as Ht,dm as _a,dn as ka,dp as q,dq as Aa,dr as Ta,R as Pa}from"./react-vendor-CPmH2tz8.js";import{l as T,c as te,aj as Ks,B as N,u as le,w as be,ai as ut,x as Ne,ac as as,ad as is,aE as Ea,_ as X,s as w,a as z,t as I,ah as Qt,aF as Ma,C as y,b as P,e as k,W as ze,a7 as fe,a8 as ge,a9 as je,aa as ve,ab as M,d as E,ag as L,aG as Kt,aH as Xt,$ as Le,D as Wt,h as Yt,K as Jt,L as Zt,M as er,j as O,X as ie,Z as ne,aC as fs,T as Be,y as $e,z as re,E as de,aI as Fs,aJ as Ia,aK as La,aL as za,aM as Ra,aN as qa,aD as ae,am as Fa,aO as Ke,aB as Oe,A as Va,m as Da,n as Ua,o as Oa,p as Ba,q as $a,r as Ga,v as Ha,aP as Xs,ae as sr,a6 as Qa,aq as Ka,al as Xe,F as Xa,aQ as Wa}from"./route-admin-B1Ip8YDE.js";import{b as Ya}from"./query-vendor-ByjIuei6.js";import{cl as Ja,cm as Za,cn as ei,co as si,cp as ti,cd as ri,cq as ai,cr as ii,cj as xe,ce as tr,cf as rr,cs as ni,ct as li}from"./common-vendor-CK5d0rWc.js";import{m as R,u as ci,a as ar,A as Cs,b as oi,d as di}from"./animation-vendor-BJe5VoH_.js";import{a as Ws,R as mi,O as ui,C as xi,b as hi,c as pi,d as fi,e as gi,f as ji,P as vi}from"./route-property-b6Ka_7KN.js";import{u as bi,t as we,P as Ys}from"./route-agency-BEE2sWoQ.js";import{S as Se,C as Ni,a as yi,b as wi,M as Ci,L as gs,P as Si}from"./route-tenant-DNBKfVUX.js";import{D as ss}from"./route-owner-C83ejxxl.js";import{o as Js,e as _i,s as We}from"./forms-vendor-DqOZ4YtP.js";import{m as he}from"./maps-vendor-B7X9GnXQ.js";import{c as ki,d as Ai,r as Ti}from"./monitoring-vendor-C7yD_Gmu.js";import"./ui-vendor-Dua12RDV.js";import"./charts-vendor-16YcNskv.js";import"./supabase-vendor-CzsKfTY-.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};s.SENTRY_RELEASE={id:"b65e2d84341e79b518aed72b6e71dcc77eba934a"}}catch{}})();try{(function(){var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new s.Error().stack;t&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[t]="a97d4657-8be7-40e4-96dc-658c846c2e7c",s._sentryDebugIdIdentifier="sentry-dbid-a97d4657-8be7-40e4-96dc-658c846c2e7c")})()}catch{}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();const Ss=new Ya({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,refetchOnWindowFocus:!1,refetchOnReconnect:!0,retry:(s,t)=>(t==null?void 0:t.status)===401||(t==null?void 0:t.status)===403?(T.warn("Erreur d'authentification détectée",{error:t}),!1):(t==null?void 0:t.status)===404?!1:s<2},mutations:{onSuccess:(s,t,r)=>{T.info("Mutation successful",{context:r||"unknown"})},onError:(s,t,r)=>{T.error("Mutation failed",{message:s==null?void 0:s.message,context:r||"unknown"})}}}}),Pi=()=>{Ss.clear(),T.info("All cache cleared on logout")},Gc=Object.freeze(Object.defineProperty({__proto__:null,clearCacheOnLogout:Pi,queryClient:Ss},Symbol.toStringTag,{value:"Module"})),Ei={CLS:.1,FCP:1800,LCP:2500,TTFB:800,INP:200},ds=s=>{const{name:t,value:r,rating:a}=s;T.info(`Web Vital: ${t}`,{value:r,rating:a}),typeof window<"u"&&window.gtag&&window.gtag("event",t,{value:Math.round(r),metric_rating:a,metric_delta:Math.round(r),event_category:"Web Vitals",non_interaction:!0});const n=Ei[t];n&&r>n&&T.warn(`⚠️ ${t} exceeds threshold`,{value:Math.round(r),threshold:n,delta:Math.round(r-n)})},Mi=()=>{Ja(ds),Za(ds),ei(ds),si(ds),ti(ds),T.info("Performance monitoring initialized")},Ii=Er,ir=i.forwardRef(({className:s,...t},r)=>e.jsx(Ct,{ref:r,className:te("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));ir.displayName=Ct.displayName;const Li=ri("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),nr=i.forwardRef(({className:s,variant:t,...r},a)=>e.jsx(St,{ref:a,className:te(Li({variant:t}),s),...r}));nr.displayName=St.displayName;const zi=i.forwardRef(({className:s,...t},r)=>e.jsx(_t,{ref:r,className:te("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",s),...t}));zi.displayName=_t.displayName;const lr=i.forwardRef(({className:s,...t},r)=>e.jsx(kt,{ref:r,className:te("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(_e,{className:"h-4 w-4"})}));lr.displayName=kt.displayName;const cr=i.forwardRef(({className:s,...t},r)=>e.jsx(At,{ref:r,className:te("text-sm font-semibold",s),...t}));cr.displayName=At.displayName;const or=i.forwardRef(({className:s,...t},r)=>e.jsx(Tt,{ref:r,className:te("text-sm opacity-90",s),...t}));or.displayName=Tt.displayName;function Ri(){const{toasts:s}=Ks();return e.jsxs(Ii,{children:[s.map(function({id:t,title:r,description:a,action:n,...l}){return e.jsxs(nr,{...l,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(cr,{children:r}),a&&e.jsx(or,{children:a})]}),n,e.jsx(lr,{})]},t)}),e.jsx(ir,{})]})}const qi=({...s})=>{const{theme:t="system"}=ai();return e.jsx(ii,{theme:t,className:"toaster group",position:"top-center",duration:2e3,toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg animate-in slide-in-from-top-2 fade-in",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})},Fi=({icon:s,title:t,description:r,action:a,className:n})=>e.jsxs(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:te("flex flex-col items-center justify-center text-center py-10 px-4",n),children:[e.jsx(R.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring",stiffness:200},className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-2xl"}),e.jsx(s,{className:"h-16 w-16 text-primary relative",strokeWidth:1.5})]})}),e.jsx(R.h3,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-2xl font-semibold mb-2",children:t}),r&&e.jsx(R.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"text-muted-foreground max-w-md mb-6",children:r}),a&&e.jsx(R.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:e.jsx(N,{onClick:a.onClick,size:"lg",variant:"default",children:a.label})})]}),Z=({children:s,allowedUserTypes:t,requiredRoles:r,requireAll:a=!1})=>{const{user:n,profile:l,hasRole:c,loading:o}=le();return o?e.jsx("div",{className:"flex items-center justify-center min-h-screen page-background",children:e.jsx(R.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.3},children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-xl animate-pulse"}),e.jsx(Is,{className:"h-16 w-16 text-primary animate-pulse relative"})]})})}):n?t&&l&&!t.includes(l.user_type)?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs(be,{variant:"destructive",className:"max-w-md",children:[e.jsx(it,{className:"h-5 w-5"}),e.jsx(ut,{children:"Accès refusé"}),e.jsx(Ne,{children:"Votre type de compte ne permet pas d'accéder à cette page."})]})}):r&&r.length>0&&!(a?r.every(h=>c(h)):r.some(h=>c(h)))?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs(be,{variant:"destructive",className:"max-w-md",children:[e.jsx(it,{className:"h-5 w-5"}),e.jsx(ut,{children:"Accès refusé"}),e.jsx(Ne,{children:"Vous n'avez pas les permissions nécessaires pour accéder à cette page."})]})}):e.jsx(e.Fragment,{children:s}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen page-background flex items-center justify-center",children:e.jsx(Fi,{icon:Is,title:"Connexion requise",description:"Vous devez être connecté pour accéder à cette page. Redirection en cours..."})}),e.jsx(Us,{to:"/auth",replace:!0})]})},Vi=["Comment créer mon dossier ?","Qu'est-ce qu'ANSUT ?","Comment publier un bien ?","Quels sont les tarifs ?"],Di=()=>{const[s,t]=i.useState(!1),[r,a]=i.useState([{role:"assistant",content:"👋 Bonjour ! Je suis Sarrah, votre assistante Mon Toit. Comment puis-je vous aider aujourd'hui ?"}]),[n,l]=i.useState(""),[c,o]=i.useState(!1),[d,h]=i.useState(null),[m]=i.useState(()=>crypto.randomUUID()),x=i.useRef(null),{user:j}=le();i.useEffect(()=>{x.current&&(x.current.scrollTop=x.current.scrollHeight)},[r]);const p=async g=>{var S;if(!g.trim()||c)return;const C={role:"user",content:g};a(_=>[..._,C]),l(""),o(!0);try{const{data:{session:_}}=await w.auth.getSession(),b=await fetch("undefined/functions/v1/sarah-chat",{method:"POST",headers:{"Content-Type":"application/json",...(_==null?void 0:_.access_token)&&{Authorization:`Bearer ${_.access_token}`}},body:JSON.stringify({message:g,conversationId:d,sessionId:m})});if(!b.ok){const B=await b.json();throw new Error(B.error||"Erreur de communication")}const f=(S=b.body)==null?void 0:S.getReader(),v=new TextDecoder;let A="",V=d;for(a(B=>[...B,{role:"assistant",content:""}]);;){const{done:B,value:Ce}=await f.read();if(B)break;const $=v.decode(Ce).split(`
`);for(const W of $)if(W.startsWith("data: ")){const F=W.slice(6);if(F==="[DONE]")continue;try{const J=JSON.parse(F);J.conversationId&&!V&&(V=J.conversationId,h(V)),J.content&&(A+=J.content,a(ce=>{const ye=[...ce];return ye[ye.length-1]={role:"assistant",content:A},ye}))}catch{}}}}catch(_){T.error("Error sending Sarah chat message",{error:_}),a(b=>[...b.slice(0,-1),{role:"assistant",content:"Désolée, j'ai rencontré un problème. Pouvez-vous réessayer ?"}])}finally{o(!1)}},u=g=>{p(g)};return e.jsxs(e.Fragment,{children:[e.jsx(N,{onClick:()=>t(!s),className:"fixed bottom-6 right-6 h-14 w-14 rounded-full shadow-lg hover:scale-110 transition-transform z-50 bg-gradient-to-br from-primary to-secondary",size:"icon",children:s?e.jsx(_e,{className:"h-6 w-6"}):e.jsx("span",{className:"text-2xl",children:"✨"})}),s&&e.jsxs("div",{className:"fixed bottom-24 right-6 w-96 h-[600px] bg-background border rounded-lg shadow-2xl flex flex-col z-50 animate-in slide-in-from-bottom-5",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border-b bg-primary text-primary-foreground rounded-t-lg",children:[e.jsx(as,{className:"h-10 w-10 bg-gradient-to-br from-primary to-secondary",children:e.jsx(is,{className:"bg-transparent text-primary-foreground",children:e.jsx("span",{className:"text-2xl",children:"✨"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:"Sarrah"}),e.jsx("p",{className:"text-xs opacity-90",children:"Assistante Mon Toit"})]})]}),e.jsx(Ea,{className:"flex-1 p-4",ref:x,children:e.jsxs("div",{className:"space-y-4",children:[r.map((g,C)=>e.jsxs("div",{className:`flex gap-2 ${g.role==="user"?"justify-end":"justify-start"}`,children:[g.role==="assistant"&&e.jsx(as,{className:"h-8 w-8 mt-1 bg-gradient-to-br from-primary to-secondary",children:e.jsx(is,{className:"bg-transparent text-primary-foreground",children:e.jsx("span",{className:"text-xl",children:"✨"})})}),e.jsx("div",{className:`max-w-[80%] rounded-lg p-3 ${g.role==="user"?"bg-primary text-primary-foreground":"bg-muted"}`,children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:g.content})})]},C)),c&&e.jsxs("div",{className:"flex gap-2 justify-start",children:[e.jsx(as,{className:"h-8 w-8 mt-1 bg-gradient-to-br from-primary to-secondary",children:e.jsx(is,{className:"bg-transparent text-primary-foreground",children:e.jsx("span",{className:"text-xl",children:"✨"})})}),e.jsx("div",{className:"bg-muted rounded-lg p-3",children:e.jsx(oe,{className:"h-4 w-4 animate-spin"})})]})]})}),r.length===1&&!c&&e.jsxs("div",{className:"p-3 border-t bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"💡 Suggestions :"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Vi.map((g,C)=>e.jsx(N,{variant:"outline",size:"sm",onClick:()=>u(g),className:"text-xs h-7",children:g},C))})]}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs("form",{onSubmit:g=>{g.preventDefault(),p(n)},className:"flex gap-2",children:[e.jsx(X,{value:n,onChange:g=>l(g.target.value),placeholder:"Votre message...",disabled:c,className:"flex-1"}),e.jsx(N,{type:"submit",size:"icon",disabled:c||!n.trim(),children:e.jsx(Mr,{className:"h-4 w-4"})})]})})]})]})},Ui=()=>{const s=ys(),t=Pt(),{user:r}=le();i.useEffect(()=>{if(r&&s.pathname==="/"){const a=setTimeout(()=>{t.prefetchQuery({queryKey:["properties","public",{limit:5}],queryFn:async()=>{const{data:n}=await w.from("properties").select("id, title, price, location, main_image, status, moderation_status, view_count").eq("moderation_status","approved").eq("status","disponible").order("view_count",{ascending:!1}).limit(5);return n},staleTime:3e5})},2e3);return()=>clearTimeout(a)}},[s.pathname,t,r])},Oi=()=>{const s=Ie();i.useEffect(()=>{const t=r=>{r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||((r.ctrlKey||r.metaKey)&&r.key==="k"&&(r.preventDefault(),s("/recherche")),r.key==="Escape"&&s(-1),r.key==="h"&&!r.ctrlKey&&!r.metaKey&&s("/"),r.key==="s"&&!r.ctrlKey&&!r.metaKey&&s("/recherche"),r.key==="p"&&!r.ctrlKey&&!r.metaKey&&s("/profil"))};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[s])},Bi=()=>{const{favorites:s}=Ws(),t=new Date;t.setDate(t.getDate()-1);const r=s.filter(a=>!0).length;return r>0?r:0},dr=i.memo(({item:s,isActive:t})=>{const r=s.icon,l=bi({onLongPress:()=>{s.path==="/messages"&&I({title:"Actions rapides",description:"Ouvrir un nouveau message"})},onClick:()=>{we("light")},delay:500});return e.jsxs(U,{to:s.path,...l,className:te("flex flex-col items-center justify-center gap-1 px-3 py-2 rounded-lg transition-all duration-200 active:scale-95 relative min-h-[44px] min-w-[44px] group touch-feedback",t?"text-primary bg-primary/10":"text-muted-foreground hover:text-foreground hover:bg-muted/50 active:bg-muted"),"aria-label":s.ariaLabel,"aria-current":t?"page":void 0,children:[e.jsxs("div",{className:"relative",children:[e.jsx(r,{className:te("h-5 w-5 transition-all duration-200",t&&"scale-110",!t&&"group-hover:scale-105"),"aria-hidden":"true"}),s.badge&&s.badge>0&&e.jsxs(z,{variant:"destructive",className:"absolute -top-2 -right-2 h-4 min-w-4 px-1 flex items-center justify-center text-xs font-semibold animate-in zoom-in-50",role:"status","aria-live":"polite",children:[e.jsxs("span",{className:"sr-only",children:[s.badge," notifications non lues"]}),s.badge>99?"99+":s.badge]})]}),e.jsx("span",{className:te("text-xs font-medium leading-none transition-all",t&&"font-semibold"),children:s.label}),t&&e.jsx("div",{className:"absolute bottom-0 left-1/2 -translate-x-1/2 w-12 h-0.5 bg-primary rounded-t-full animate-in slide-in-from-bottom-1 duration-200"})]})});dr.displayName="NavButton";const $i=()=>{const{user:s}=le(),t=ys(),r=Qt(),{unreadCount:a}=Ma(),n=Bi();if(!r||!s)return null;const l=i.useMemo(()=>[{label:"Accueil",icon:ee,path:"/",ariaLabel:"Aller à l'accueil"},{label:"Recherche",icon:Me,path:"/recherche",ariaLabel:"Rechercher des propriétés"},{label:"Favoris",icon:bs,path:"/favoris",ariaLabel:"Voir mes favoris",badge:n>0?n:void 0},{label:"Messages",icon:ms,path:"/messages",ariaLabel:"Messages",badge:a>0?a:void 0},{label:"Profil",icon:rs,path:"/profil",ariaLabel:"Voir mon profil"}],[a,n]),c=i.useMemo(()=>o=>o==="/"?t.pathname==="/":t.pathname.startsWith(o),[t.pathname]);return e.jsxs("nav",{className:te("fixed bottom-0 left-0 right-0 z-50","bg-background/95 backdrop-blur-md supports-[backdrop-filter]:bg-background/80","border-t border-border shadow-lg","safe-area-inset-bottom","animate-in slide-in-from-bottom-4 duration-300"),"aria-label":"Navigation principale mobile",role:"navigation",children:[e.jsx("div",{className:"flex items-center justify-around h-16 px-2 max-w-screen-xl mx-auto",children:l.map(o=>e.jsx(dr,{item:o,isActive:c(o.path)},o.path))}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)]"})]})},Gi=i.memo($i),mr={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.05}}},Qe={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{type:"spring",stiffness:100}}},Hi=()=>e.jsx(R.div,{className:"min-h-screen bg-background",variants:mr,initial:"hidden",animate:"visible",children:e.jsxs("div",{className:"container mx-auto px-4 py-6 space-y-6",children:[e.jsx(R.div,{variants:Qe,children:e.jsx(Se,{className:"h-96 w-full rounded-2xl"})}),e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 space-y-4",children:[e.jsx(R.div,{variants:Qe,children:e.jsx(Se,{className:"h-8 w-3/4"})}),e.jsx(R.div,{variants:Qe,children:e.jsx(Se,{className:"h-6 w-1/2"})}),e.jsx(R.div,{variants:Qe,children:e.jsx(Se,{className:"h-32 w-full"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(R.div,{variants:Qe,children:e.jsx(Se,{className:"h-48 w-full rounded-xl"})}),e.jsx(R.div,{variants:Qe,children:e.jsx(Se,{className:"h-12 w-full rounded-xl"})})]})]})]})}),ue=()=>e.jsx(R.div,{className:"container mx-auto px-4 py-20",variants:mr,initial:"hidden",animate:"visible",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(s=>e.jsx(R.div,{variants:Qe,children:e.jsxs(y,{className:"overflow-hidden",children:[e.jsx(Se,{className:"aspect-video rounded-none"}),e.jsxs(P,{className:"p-4 sm:p-6 pb-3",children:[e.jsx(Se,{className:"h-6 w-full mb-2"}),e.jsx(Se,{className:"h-8 w-1/2"})]}),e.jsxs(k,{className:"space-y-4 p-4 sm:p-6 pt-0",children:[e.jsx(Se,{className:"h-4 w-3/4"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(Se,{className:"h-10 flex-1"}),e.jsx(Se,{className:"h-10 flex-1"}),e.jsx(Se,{className:"h-10 flex-1"})]}),e.jsx(Se,{className:"h-10 w-full"})]})]})},s))})}),Qi=()=>{const[s,t]=i.useState(new Date);i.useEffect(()=>{const l=setInterval(()=>{t(new Date)},1e3);return()=>clearInterval(l)},[]);const r=i.useCallback(l=>{const c={hour:"2-digit",minute:"2-digit",timeZone:"Africa/Abidjan",...(l==null?void 0:l.includeSeconds)&&{second:"2-digit"}};return s.toLocaleTimeString("fr-FR",c)},[s]),a=i.useCallback(()=>s.toLocaleDateString("fr-FR",{weekday:"short",day:"2-digit",month:"short",timeZone:"Africa/Abidjan"}),[s]),n=i.useCallback(()=>{const l=s.getHours();return l<12?"Matin":l<18?"Après-midi":"Soir"},[s]);return{formatTime:r,formatDate:a,dayPeriod:n(),currentTime:s}},Ki=[{name:"Cocody",lat:5.3599,lng:-3.9889,bounds:{latMin:5.32,latMax:5.4,lngMin:-4.02,lngMax:-3.95}},{name:"Plateau",lat:5.3244,lng:-4.0125,bounds:{latMin:5.31,latMax:5.34,lngMin:-4.03,lngMax:-4}},{name:"Marcory",lat:5.2869,lng:-3.9967,bounds:{latMin:5.27,latMax:5.31,lngMin:-4.01,lngMax:-3.98}},{name:"Yopougon",lat:5.3456,lng:-4.0889,bounds:{latMin:5.3,latMax:5.39,lngMin:-4.15,lngMax:-4.05}},{name:"Abobo",lat:5.4167,lng:-4.0167,bounds:{latMin:5.38,latMax:5.45,lngMin:-4.05,lngMax:-3.98}},{name:"Adjamé",lat:5.35,lng:-4.0333,bounds:{latMin:5.33,latMax:5.37,lngMin:-4.05,lngMax:-4.01}},{name:"Treichville",lat:5.2889,lng:-4.0089,bounds:{latMin:5.27,latMax:5.31,lngMin:-4.03,lngMax:-4}},{name:"Koumassi",lat:5.3,lng:-3.95,bounds:{latMin:5.28,latMax:5.32,lngMin:-3.97,lngMax:-3.93}},{name:"Port-Bouët",lat:5.25,lng:-3.9333,bounds:{latMin:5.23,latMax:5.27,lngMin:-3.96,lngMax:-3.91}},{name:"Attécoubé",lat:5.3333,lng:-4.05,bounds:{latMin:5.31,latMax:5.36,lngMin:-4.08,lngMax:-4.03}}],xt="user_location",ht="user_location_timestamp",pt=5*60*1e3,Xi=(s,t)=>{for(const r of Ki)if(s>=r.bounds.latMin&&s<=r.bounds.latMax&&t>=r.bounds.lngMin&&t<=r.bounds.lngMax)return r.name},Wi=()=>{const[s,t]=i.useState({city:"Abidjan",country:"Côte d'Ivoire",neighborhood:void 0}),[r,a]=i.useState(!0),[n,l]=i.useState(null),c=i.useCallback(async()=>{a(!0),l(null);try{const o=localStorage.getItem(xt),d=localStorage.getItem(ht);if(o&&d&&Date.now()-parseInt(d)<pt){t(JSON.parse(o)),a(!1);return}if("geolocation"in navigator){const h=await new Promise((u,g)=>{navigator.geolocation.getCurrentPosition(u,g,{timeout:5e3,maximumAge:pt})}),{latitude:m,longitude:x}=h.coords,p={city:"Abidjan",country:"Côte d'Ivoire",neighborhood:Xi(m,x),latitude:m,longitude:x};t(p),localStorage.setItem(xt,JSON.stringify(p)),localStorage.setItem(ht,Date.now().toString())}else t({city:"Abidjan",country:"Côte d'Ivoire"})}catch(o){l(o),t({city:"Abidjan",country:"Côte d'Ivoire"})}finally{a(!1)}},[]);return i.useEffect(()=>{c()},[]),{location:s,isLoading:r,error:n,refresh:c}},Es={temperature:28,description:"Ensoleillé",icon:"sun",humidity:75,windSpeed:12},ft="weather_data",gt="weather_timestamp",Yi=30*60*1e3,Ji=30*60*1e3,Zi=()=>{const[s,t]=i.useState(Es),[r,a]=i.useState(!0),[n,l]=i.useState(null),c=i.useCallback(async()=>{a(!0),l(null);try{const o=localStorage.getItem(ft),d=localStorage.getItem(gt);if(o&&d&&Date.now()-parseInt(d)<Yi){t(JSON.parse(o)),a(!1);return}const{data:h,error:m}=await w.functions.invoke("get-weather",{body:{city:"Abidjan"}});if(m)throw new Error("Weather API error");if(h!=null&&h.weather){const x={...h.weather,feelsLike:h.weather.feelsLike||h.weather.temperature};t(x),localStorage.setItem(ft,JSON.stringify(x)),localStorage.setItem(gt,Date.now().toString())}else t(Es)}catch(o){T.warn("Weather fetch error",{error:o}),l(o),t(Es)}finally{a(!1)}},[]);return i.useEffect(()=>{c()},[]),i.useEffect(()=>{const o=setInterval(()=>{c()},Ji);return()=>clearInterval(o)},[]),{weather:s,isLoading:r,error:n,refresh:c}},Zs=({isLoading:s,hasError:t,onClick:r,children:a,ariaLabel:n})=>(T.debug("Widget rendering"),e.jsx("button",{onClick:r,"aria-label":n,className:te("group flex items-center gap-2 px-3 py-1.5 rounded-full transition-all duration-300","bg-background/40 hover:bg-background/60 hover:scale-105","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2","active:scale-95",t&&"border border-destructive/50"),children:s?e.jsxs(e.Fragment,{children:[e.jsx(ze,{className:"h-4 w-4 rounded-full"}),e.jsx(ze,{className:"h-4 w-20"})]}):t?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"h-4 w-4 text-destructive"}),e.jsx("span",{className:"text-sm font-medium text-destructive",children:"Erreur"})]}):a})),en=({location:s,isLoading:t,error:r,onRefresh:a})=>e.jsxs(Zs,{isLoading:t,hasError:!!r,onClick:a,ariaLabel:"Localisation actuelle - Cliquer pour rafraîchir",children:[e.jsx(Ze,{className:"h-4 w-4 text-primary group-hover:animate-pulse"}),e.jsx("span",{className:"font-semibold text-sm",children:s.city}),s.neighborhood&&e.jsxs("span",{className:"text-xs text-muted-foreground hidden lg:inline",children:["• ",s.neighborhood]})]}),sn={sun:Et,moon:Vr,cloud:Fr,"cloud-sun":qr,"cloud-moon":Rr,"cloud-rain":zr,"cloud-lightning":Lr,snowflake:Ir},tn=({weather:s,isLoading:t,error:r,onRefresh:a})=>{const n=sn[s.icon]||Et;return e.jsxs(Zs,{isLoading:t,hasError:!!r,onClick:a,ariaLabel:"Météo actuelle - Cliquer pour rafraîchir",children:[e.jsx(n,{className:"h-4 w-4 text-warning group-hover:scale-110 transition-transform"}),e.jsxs("span",{className:"font-semibold text-sm",children:[s.temperature,"°C"]}),e.jsx("span",{className:"text-xs text-muted-foreground hidden sm:inline",children:s.description})]})},rn=({formatTime:s,formatDate:t,dayPeriod:r})=>{const[a,n]=i.useState(!1);return e.jsxs(Zs,{onClick:()=>n(!a),ariaLabel:"Heure et date actuelles - Cliquer pour basculer l'affichage des secondes",children:[e.jsx(qe,{className:"h-4 w-4 text-primary group-hover:rotate-12 transition-transform"}),e.jsx("span",{className:"font-semibold text-sm",children:s({includeSeconds:a})}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t()}),e.jsxs("span",{className:"text-xs text-primary/70 hidden xl:inline",children:["• ",r]})]})},an=()=>{const[s,t]=i.useState(!0),{formatTime:r,formatDate:a,dayPeriod:n}=Qi(),{location:l,isLoading:c,error:o,refresh:d}=Wi(),{weather:h,isLoading:m,error:x,refresh:j}=Zi(),p=async()=>{await d(),xe.success("Localisation actualisée")},u=async()=>{await j(),xe.success("Météo actualisée")};return e.jsx("div",{className:"w-full bg-gradient-to-r from-primary/5 via-accent/10 to-primary/5 border-b border-border/50 backdrop-blur-md relative z-30",role:"banner","aria-label":"Barre d'informations contextuelles",children:s?e.jsx("div",{className:"container mx-auto px-4 max-w-7xl",children:e.jsx("div",{className:"h-8 flex items-center justify-center",children:e.jsxs(N,{variant:"ghost",size:"sm",onClick:()=>t(!1),className:"text-xs text-muted-foreground hover:text-primary",children:[e.jsx(Os,{className:"h-3 w-3 mr-1"}),"Infos contextuelles"]})})}):e.jsx("div",{className:"container mx-auto px-4 max-w-7xl",children:e.jsx("div",{className:"py-3 flex flex-col gap-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 md:gap-6 text-sm flex-1 justify-center",children:[e.jsx(en,{location:l,isLoading:c,error:o,onRefresh:p}),e.jsx("span",{className:"text-border/40","aria-hidden":"true",children:"•"}),e.jsx(tn,{weather:h,isLoading:m,error:x,onRefresh:u}),e.jsx("span",{className:"text-border/40 hidden md:inline","aria-hidden":"true",children:"•"}),e.jsx("div",{className:"hidden md:block",children:e.jsx(rn,{formatTime:r,formatDate:a,dayPeriod:n})})]}),e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>t(!0),className:"text-xs text-muted-foreground hover:text-primary",children:e.jsx(Dr,{className:"h-3 w-3"})})]})})})})},nn=()=>{const{scrollYProgress:s}=ci(),t=ar(s,{stiffness:100,damping:30,restDelta:.001});return e.jsx(R.div,{className:"fixed top-0 left-0 right-0 h-1 bg-gradient-to-r from-primary via-secondary to-primary z-50 origin-left",style:{scaleX:t}})},ln=()=>{const[s,t]=i.useState(null),[r,a]=i.useState(!1),[n,l]=i.useState(!1);i.useEffect(()=>{(()=>{const m=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");l(m)})();const h=m=>{m.preventDefault(),t(m);const x=localStorage.getItem("pwa-install-dismissed");(!x||Date.now()-parseInt(x)>7*24*60*60*1e3)&&a(!0)};return window.addEventListener("beforeinstallprompt",h),window.addEventListener("appinstalled",()=>{l(!0),a(!1),localStorage.removeItem("pwa-install-dismissed")}),()=>{window.removeEventListener("beforeinstallprompt",h)}},[]);const c=async()=>{if(!s)return;s.prompt();const{outcome:d}=await s.userChoice;d==="accepted"?(console.log("PWA installée avec succès"),a(!1)):(console.log("Installation PWA refusée"),o()),t(null)},o=()=>{a(!1),localStorage.setItem("pwa-install-dismissed",Date.now().toString())};return n||!r?null:e.jsx(Cs,{children:e.jsx(R.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:1},exit:{y:100,opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"fixed bottom-20 left-4 right-4 md:left-auto md:right-4 md:max-w-md z-50",children:e.jsxs("div",{className:"bg-gradient-to-r from-primary via-primary/90 to-secondary text-white p-4 rounded-2xl shadow-2xl border border-white/20 backdrop-blur-sm",children:[e.jsx("button",{onClick:o,className:"absolute top-2 right-2 p-1 hover:bg-white/20 rounded-full transition-colors","aria-label":"Fermer",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"bg-white/20 p-2 rounded-xl",children:e.jsx(Mt,{className:"h-6 w-6"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-lg mb-1",children:"Installer Mon Toit"}),e.jsx("p",{className:"text-sm text-white/90",children:"Accédez rapidement à Mon Toit depuis votre écran d'accueil. Expérience rapide et hors ligne."})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3 text-xs",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"font-semibold",children:"⚡"}),e.jsx("div",{className:"opacity-90",children:"Rapide"})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"font-semibold",children:"📱"}),e.jsx("div",{className:"opacity-90",children:"Native"})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-2 text-center",children:[e.jsx("div",{className:"font-semibold",children:"🔒"}),e.jsx("div",{className:"opacity-90",children:"Sécurisé"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(N,{onClick:c,className:"flex-1 bg-white text-primary hover:bg-white/90 font-bold shadow-lg",size:"lg",children:[e.jsx(It,{className:"h-4 w-4 mr-2"}),"Installer"]}),e.jsx(N,{onClick:o,variant:"ghost",className:"text-white hover:bg-white/20",size:"lg",children:"Plus tard"})]})]})})})},cn=()=>{const[s,t]=i.useState(!1);return i.useEffect(()=>{const r=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://"),a=sessionStorage.getItem("splash-shown");if(r&&!a){t(!0),sessionStorage.setItem("splash-shown","true");const n=setTimeout(()=>{t(!1)},2e3);return()=>clearTimeout(n)}},[]),e.jsx(Cs,{children:s&&e.jsx(R.div,{initial:{opacity:1},exit:{opacity:0},transition:{duration:.5},className:"fixed inset-0 z-[9999] flex items-center justify-center bg-gradient-to-br from-primary via-primary/90 to-secondary",children:e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsxs(R.div,{initial:{scale:.5,opacity:0},animate:{scale:[.5,1.2,1],opacity:1},transition:{duration:1,times:[0,.6,1],ease:"easeOut"},className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-white/20 rounded-full blur-2xl scale-150"}),e.jsx("div",{className:"relative bg-white rounded-3xl p-6 shadow-2xl",children:e.jsx(ee,{className:"h-20 w-20 text-primary",strokeWidth:2})}),e.jsx(R.div,{animate:{scale:[1,1.3,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"absolute inset-0 bg-white rounded-3xl"})]}),e.jsxs(R.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.5},className:"text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Mon Toit"}),e.jsx("p",{className:"text-white/80 text-sm",children:"Le logement, en toute confiance"})]}),e.jsx(R.div,{initial:{width:0},animate:{width:"100%"},transition:{duration:2,ease:"easeInOut"},className:"w-32 h-1 bg-white/30 rounded-full overflow-hidden",children:e.jsx(R.div,{animate:{x:["-100%","100%"]},transition:{duration:1,repeat:1/0,ease:"easeInOut"},className:"h-full w-1/2 bg-white rounded-full"})})]})})})},on=({children:s,onClick:t,...r})=>{const[a,n]=i.useState([]),l=c=>{const o=c.currentTarget.getBoundingClientRect(),d=c.clientX-o.left,h=c.clientY-o.top,m={x:d,y:h,id:Date.now()};n([...a,m]),setTimeout(()=>{n(x=>x.filter(j=>j.id!==m.id))},600),t&&t(c)};return e.jsxs(N,{...r,onClick:l,className:`relative overflow-hidden ${r.className||""}`,children:[a.map(c=>e.jsx(R.span,{className:"absolute bg-white/30 rounded-full pointer-events-none",style:{left:c.x,top:c.y},initial:{width:0,height:0,opacity:1},animate:{width:300,height:300,opacity:0,x:-150,y:-150},transition:{duration:.6,ease:"easeOut"}},c.id)),s]})},dn=({value:s,duration:t=2,suffix:r="",prefix:a=""})=>{const n=i.useRef(null),l=oi(n,{once:!0}),c=ar(0,{duration:t*1e3}),o=di(c,d=>Math.round(d).toLocaleString("fr-FR"));return i.useEffect(()=>{l&&c.set(s)},[c,s,l]),e.jsxs("span",{ref:n,children:[a,e.jsx(R.span,{children:o}),r]})},mn=()=>{const[s,t]=i.useState(""),[r,a]=i.useState("all"),[n,l]=i.useState("all"),[c,o]=i.useState(""),d=Ie(),h=()=>{const m=new URLSearchParams;s.trim()&&m.append("q",s.trim()),r!=="all"&&m.append("city",r),n!=="all"&&m.append("type",n),c&&m.append("budget",c);const x=m.toString();d(`/explorer${x?"?"+x:""}`)};return e.jsxs("section",{className:"relative min-h-[600px] flex items-center justify-center overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 z-0",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url('https://images.unsplash.com/photo-1566073771259-6a8506099945?w=1920&q=80')"}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/90 via-primary/70 to-secondary/80"}),e.jsx("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:`repeating-linear-gradient(
              45deg,
              transparent,
              transparent 10px,
              rgba(255, 255, 255, 0.1) 10px,
              rgba(255, 255, 255, 0.1) 20px
            ),
            repeating-linear-gradient(
              -45deg,
              transparent,
              transparent 10px,
              rgba(255, 255, 255, 0.05) 10px,
              rgba(255, 255, 255, 0.05) 20px
            )`}})]}),e.jsx("div",{className:"relative z-10 container mx-auto px-4 py-16 max-w-5xl",children:e.jsxs(R.div,{className:"flex flex-col gap-8 items-center justify-center text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[e.jsxs(R.div,{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-semibold shadow-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2,duration:.5},children:[e.jsx(Lt,{className:"h-4 w-4"}),"Plateforme N°1 en Côte d'Ivoire"]}),e.jsxs(R.h1,{className:"text-5xl md:text-7xl font-bold text-white leading-tight",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.6},children:["Trouvez votre"," ",e.jsx("span",{className:"bg-gradient-to-r from-yellow-300 via-orange-400 to-yellow-300 bg-clip-text text-transparent animate-pulse-slow",children:"Toit Idéal"})]}),e.jsx(R.p,{className:"text-xl md:text-2xl text-white/90 max-w-2xl",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.6},children:"Location immobilière certifiée ANSUT • Baux sécurisés • Paiement en ligne"}),e.jsx(R.div,{className:"w-full max-w-4xl bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl p-6 md:p-8",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{delay:.5,duration:.6},children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs(fe,{value:r,onValueChange:a,children:[e.jsxs(ge,{className:"h-14 border-2 focus:border-primary bg-white",children:[e.jsx(Ze,{className:"h-5 w-5 mr-2 text-primary"}),e.jsx(je,{placeholder:"Ville"})]}),e.jsxs(ve,{className:"bg-white border border-border z-50",children:[e.jsx(M,{value:"all",children:"Toutes les villes"}),e.jsx(M,{value:"Abidjan",children:"Abidjan"}),e.jsx(M,{value:"Yopougon",children:"Yopougon"}),e.jsx(M,{value:"Cocody",children:"Cocody"}),e.jsx(M,{value:"Marcory",children:"Marcory"}),e.jsx(M,{value:"Koumassi",children:"Koumassi"}),e.jsx(M,{value:"Plateau",children:"Plateau"})]})]}),e.jsxs(fe,{value:n,onValueChange:l,children:[e.jsxs(ge,{className:"h-14 border-2 focus:border-primary bg-white",children:[e.jsx(ee,{className:"h-5 w-5 mr-2 text-primary"}),e.jsx(je,{placeholder:"Type de bien"})]}),e.jsxs(ve,{className:"bg-white border border-border z-50",children:[e.jsx(M,{value:"all",children:"Tous les types"}),e.jsx(M,{value:"Appartement",children:"Appartement"}),e.jsx(M,{value:"Villa",children:"Villa"}),e.jsx(M,{value:"Studio",children:"Studio"}),e.jsx(M,{value:"Bureau",children:"Bureau"}),e.jsx(M,{value:"Magasin",children:"Magasin"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(cs,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx(X,{type:"text",placeholder:"Budget max (FCFA)",value:c,onChange:m=>{const x=m.target.value.replace(/\D/g,"");o(x)},className:"pl-12 h-14 border-2 focus:border-primary bg-white"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(on,{onClick:h,size:"lg",className:"flex-1 h-14 text-lg font-bold shadow-lg hover:shadow-xl transition-shadow",children:[e.jsx(Me,{className:"h-5 w-5 mr-2"}),"Rechercher"]}),e.jsx(N,{variant:"secondary",size:"lg",asChild:!0,className:"h-14 px-6 font-bold shadow-lg hover:shadow-xl transition-shadow",children:e.jsxs("a",{href:"/publier",children:[e.jsx(Ur,{className:"h-5 w-5 mr-2"}),"Publier"]})})]})]})}),e.jsxs(R.div,{className:"w-full max-w-4xl",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.6},children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-6 md:gap-10 text-white",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex",children:[...Array(5)].map((m,x)=>e.jsx("span",{className:"text-yellow-300 text-xl",children:"⭐"},x))}),e.jsx("span",{className:"font-bold text-lg",children:"4.8/5"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-5 w-5"}),e.jsxs("span",{className:"text-lg",children:[e.jsx("strong",{className:"font-bold",children:e.jsx(dn,{value:1e4,suffix:"+"})})," Ivoiriens"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(es,{className:"h-5 w-5"}),e.jsxs("span",{className:"text-lg",children:[e.jsx("strong",{className:"font-bold",children:"100%"})," Gratuit"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Bs,{className:"h-5 w-5 text-yellow-300"}),e.jsx("span",{className:"text-lg font-semibold",children:"Certifié ANSUT"})]})]}),e.jsx("p",{className:"text-center text-white/80 mt-4 text-sm",children:e.jsx(U,{to:"/a-propos",className:"underline hover:text-yellow-300 transition-colors",children:"Pourquoi nous faire confiance ?"})})]})]})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 z-10",children:e.jsx("svg",{viewBox:"0 0 1440 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-full h-auto",children:e.jsx("path",{d:"M0,64L48,69.3C96,75,192,85,288,80C384,75,480,53,576,48C672,43,768,53,864,58.7C960,64,1056,64,1152,58.7C1248,53,1344,43,1392,37.3L1440,32L1440,120L1392,120C1344,120,1248,120,1152,120C1056,120,960,120,864,120C768,120,672,120,576,120C480,120,384,120,288,120C192,120,96,120,48,120L0,120Z",fill:"currentColor",className:"text-background"})})})]})},un=()=>{const[s,t]=i.useState("all"),[r,a]=i.useState("all"),n=Ie(),l=()=>{const c=new URLSearchParams;s!=="all"&&c.append("city",s),r!=="all"&&c.append("type",r);const o=c.toString();n(`/explorer${o?"?"+o:""}`)};return e.jsxs("section",{className:"relative min-h-[400px] flex items-center justify-center overflow-hidden bg-gradient-to-br from-primary via-primary/90 to-secondary",children:[e.jsx("div",{className:"absolute inset-0 opacity-5",style:{backgroundImage:`repeating-linear-gradient(
            45deg,
            transparent,
            transparent 10px,
            rgba(255, 255, 255, 0.1) 10px,
            rgba(255, 255, 255, 0.1) 20px
          )`}}),e.jsx("div",{className:"relative z-10 w-full px-4 py-8",children:e.jsxs(R.div,{className:"flex flex-col gap-6 items-center text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white text-sm font-semibold shadow-lg",children:[e.jsx(Lt,{className:"h-3 w-3"}),"N°1 en Côte d'Ivoire"]}),e.jsxs("h1",{className:"text-3xl font-bold text-white leading-tight",children:["Trouvez votre"," ",e.jsx("span",{className:"bg-gradient-to-r from-yellow-300 via-orange-400 to-yellow-300 bg-clip-text text-transparent",children:"Toit Idéal"})]}),e.jsx("p",{className:"text-sm text-white/90 max-w-sm",children:"Location certifiée ANSUT • Baux sécurisés"}),e.jsx("div",{className:"w-full max-w-md bg-white/95 backdrop-blur-sm rounded-2xl shadow-xl p-4",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(fe,{value:s,onValueChange:t,children:[e.jsxs(ge,{className:"h-12 border-2 focus:border-primary bg-white",children:[e.jsx(Ze,{className:"h-4 w-4 mr-2 text-primary"}),e.jsx(je,{placeholder:"Ville"})]}),e.jsxs(ve,{className:"bg-white border border-border z-50",children:[e.jsx(M,{value:"all",children:"Toutes les villes"}),e.jsx(M,{value:"Abidjan",children:"Abidjan"}),e.jsx(M,{value:"Cocody",children:"Cocody"}),e.jsx(M,{value:"Marcory",children:"Marcory"}),e.jsx(M,{value:"Yopougon",children:"Yopougon"}),e.jsx(M,{value:"Plateau",children:"Plateau"})]})]}),e.jsxs(fe,{value:r,onValueChange:a,children:[e.jsxs(ge,{className:"h-12 border-2 focus:border-primary bg-white",children:[e.jsx(ee,{className:"h-4 w-4 mr-2 text-primary"}),e.jsx(je,{placeholder:"Type de bien"})]}),e.jsxs(ve,{className:"bg-white border border-border z-50",children:[e.jsx(M,{value:"all",children:"Tous les types"}),e.jsx(M,{value:"Appartement",children:"Appartement"}),e.jsx(M,{value:"Villa",children:"Villa"}),e.jsx(M,{value:"Studio",children:"Studio"}),e.jsx(M,{value:"Bureau",children:"Bureau"})]})]}),e.jsxs(N,{onClick:l,size:"lg",className:"h-12 text-base font-bold shadow-lg",children:[e.jsx(Me,{className:"h-5 w-5 mr-2"}),"Rechercher"]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 w-full max-w-md text-white",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold",children:"3500+"}),e.jsx("div",{className:"text-xs opacity-90",children:"Biens"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold",children:"10000+"}),e.jsx("div",{className:"text-xs opacity-90",children:"Utilisateurs"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold",children:"98%"}),e.jsx("div",{className:"text-xs opacity-90",children:"Satisfaction"})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-3",children:[e.jsx("div",{className:"text-2xl font-bold",children:"24h"}),e.jsx("div",{className:"text-xs opacity-90",children:"Support"})]})]})]})})]})},xn=()=>{const[s,t]=i.useState(!1);return i.useEffect(()=>{const r=()=>{const a=window.innerWidth<768,n=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);t(a||n)};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),s},Je=i.forwardRef(({className:s,...t},r)=>e.jsxs(zt,{ref:r,className:te("relative flex w-full touch-none select-none items-center",s),...t,children:[e.jsx(Or,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(Br,{className:"absolute h-full bg-primary"})}),e.jsx($r,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Je.displayName=zt.displayName;const ur=({onFilterChange:s,onReset:t})=>{const[r,a]=i.useState(!1),[n,l]=i.useState({}),[c,o]=i.useState([0,1e6]),[d,h]=i.useState([0,500]),m=(p,u)=>{const g={...n,[p]:u};l(g),s(g)},x=()=>{l({}),o([0,1e6]),h([0,500]),t()},j=Object.keys(n).filter(p=>n[p]!==void 0).length;return e.jsx(y,{className:"mb-6",children:e.jsx(P,{children:e.jsxs(Ni,{open:r,onOpenChange:a,children:[e.jsx(yi,{asChild:!0,children:e.jsxs(N,{variant:"ghost",className:"w-full justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rt,{className:"h-4 w-4"}),e.jsx(E,{children:"Filtres de recherche"}),j>0&&e.jsx("span",{className:"bg-primary text-primary-foreground text-xs px-2 py-1 rounded-full",children:j})]}),e.jsx("span",{className:"text-muted-foreground text-sm",children:r?"Masquer":"Afficher"})]})}),e.jsx(wi,{children:e.jsxs(k,{className:"space-y-6 pt-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Ville"}),e.jsxs(fe,{onValueChange:p=>m("city",p),value:n.city,children:[e.jsx(ge,{children:e.jsx(je,{placeholder:"Ex: Abidjan, Yopougon, Cocody..."})}),e.jsx(ve,{children:Kt.map(p=>e.jsx(M,{value:p,children:p},p))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Type de bien"}),e.jsxs(fe,{onValueChange:p=>m("propertyType",p),value:n.propertyType,children:[e.jsx(ge,{children:e.jsx(je,{placeholder:"Ex: Appartement, Villa, Studio..."})}),e.jsx(ve,{children:Xt.map(p=>e.jsx(M,{value:p,children:p},p))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Statut"}),e.jsxs(fe,{onValueChange:p=>m("status",p),value:n.status,children:[e.jsx(ge,{children:e.jsx(je,{placeholder:"Tous"})}),e.jsxs(ve,{children:[e.jsx(M,{value:"disponible",children:"Disponible"}),e.jsx(M,{value:"loué",children:"Loué"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Ajouté"}),e.jsxs(fe,{onValueChange:p=>m("addedPeriod",p),value:n.addedPeriod,children:[e.jsx(ge,{children:e.jsx(je,{placeholder:"Tout"})}),e.jsxs(ve,{children:[e.jsx(M,{value:"today",children:"Aujourd'hui"}),e.jsx(M,{value:"week",children:"Cette semaine"}),e.jsx(M,{value:"month",children:"Ce mois-ci"}),e.jsx(M,{value:"all",children:"Tout"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Chambres (min)"}),e.jsx(X,{type:"number",min:0,placeholder:"0",value:n.bedrooms||"",onChange:p=>m("bedrooms",p.target.value?parseInt(p.target.value):void 0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Salles de bain (min)"}),e.jsx(X,{type:"number",min:0,placeholder:"0",value:n.bathrooms||"",onChange:p=>m("bathrooms",p.target.value?parseInt(p.target.value):void 0)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Prix mensuel (FCFA)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(X,{type:"number",placeholder:"Min",value:c[0],onChange:p=>{const u=[parseInt(p.target.value)||0,c[1]];o(u),m("minPrice",u[0])}}),e.jsx("span",{children:"-"}),e.jsx(X,{type:"number",placeholder:"Max",value:c[1],onChange:p=>{const u=[c[0],parseInt(p.target.value)||1e6];o(u),m("maxPrice",u[1])}})]}),e.jsx(Je,{min:0,max:1e6,step:1e4,value:c,onValueChange:p=>{o(p),m("minPrice",p[0]),m("maxPrice",p[1])}}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[c[0].toLocaleString()," - ",c[1].toLocaleString()," FCFA"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Surface (m²)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(X,{type:"number",placeholder:"Min",value:d[0],onChange:p=>{const u=[parseInt(p.target.value)||0,d[1]];h(u),m("minSurface",u[0])}}),e.jsx("span",{children:"-"}),e.jsx(X,{type:"number",placeholder:"Max",value:d[1],onChange:p=>{const u=[d[0],parseInt(p.target.value)||500];h(u),m("maxSurface",u[1])}})]}),e.jsx(Je,{min:0,max:500,step:10,value:d,onValueChange:p=>{h(p),m("minSurface",p[0]),m("maxSurface",p[1])}}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[d[0]," - ",d[1]," m²"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(L,{children:"Équipements"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{id:"furnished",checked:n.isFurnished,onCheckedChange:p=>m("isFurnished",p)}),e.jsx(L,{htmlFor:"furnished",className:"font-normal cursor-pointer",children:"Meublé"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{id:"ac",checked:n.hasAc,onCheckedChange:p=>m("hasAc",p)}),e.jsx(L,{htmlFor:"ac",className:"font-normal cursor-pointer",children:"Climatisation"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{id:"parking",checked:n.hasParking,onCheckedChange:p=>m("hasParking",p)}),e.jsx(L,{htmlFor:"parking",className:"font-normal cursor-pointer",children:"Parking"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{id:"garden",checked:n.hasGarden,onCheckedChange:p=>m("hasGarden",p)}),e.jsx(L,{htmlFor:"garden",className:"font-normal cursor-pointer",children:"Jardin"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(L,{children:"Visites & Médias"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{id:"video",checked:n.hasVideo,onCheckedChange:p=>m("hasVideo",p)}),e.jsx(L,{htmlFor:"video",className:"font-normal cursor-pointer",children:"Avec vidéo"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{id:"360view",checked:n.has360View,onCheckedChange:p=>m("has360View",p)}),e.jsx(L,{htmlFor:"360view",className:"font-normal cursor-pointer",children:"Vue 360°"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{id:"virtualtour",checked:n.hasVirtualTour,onCheckedChange:p=>m("hasVirtualTour",p)}),e.jsx(L,{htmlFor:"virtualtour",className:"font-normal cursor-pointer",children:"Visite virtuelle"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(L,{children:"Certification"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Le,{id:"ansutCertified",checked:n.isAnsutCertified,onCheckedChange:p=>m("isAnsutCertified",p)}),e.jsxs(L,{htmlFor:"ansutCertified",className:"font-normal cursor-pointer flex items-center gap-2",children:[e.jsx("span",{className:"text-secondary",children:"✓"})," Baux certifiés ANSUT uniquement"]})]})]}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsxs(N,{variant:"outline",onClick:x,children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Réinitialiser"]})})]})})]})})})},He=({className:s="",variant:t="default"})=>{const r="bg-gradient-to-r from-gray-200 via-gray-300 to-gray-200 rounded",a={default:"h-4 w-full",card:"h-64 w-full",text:"h-3 w-3/4",circle:"h-16 w-16 rounded-full"};return e.jsx(R.div,{className:`${r} ${a[t]} ${s}`,animate:{backgroundPosition:["0% 50%","100% 50%","0% 50%"]},transition:{duration:2,repeat:1/0,ease:"linear"},style:{backgroundSize:"200% 100%"}})},xr=()=>e.jsxs(R.div,{className:"bg-white rounded-xl shadow-md overflow-hidden",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:[e.jsx(He,{variant:"card"}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx(He,{variant:"default",className:"h-6"}),e.jsx(He,{variant:"text"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(He,{variant:"default",className:"h-4 w-16"}),e.jsx(He,{variant:"default",className:"h-4 w-16"}),e.jsx(He,{variant:"default",className:"h-4 w-16"})]}),e.jsx(He,{variant:"default",className:"h-8 w-32"})]})]}),hn=({children:s,delay:t=0,direction:r="up"})=>{const a={up:{y:50},down:{y:-50},left:{x:50},right:{x:-50}};return e.jsx(R.div,{initial:{opacity:0,...a[r]},whileInView:{opacity:1,y:0,x:0},transition:{duration:.6,delay:t,ease:[.25,.46,.45,.94]},viewport:{once:!0,margin:"-100px"},children:s})},pn=({limit:s=16,showFilters:t=!0})=>{console.log("[PropertyGrid] Rendering with limit:",s);const{user:r}=le(),[a,n]=i.useState(s),[l,c]=i.useState("recent"),[o,d]=i.useState({}),{data:h=[],isLoading:m,isError:x,error:j}=$s({queryKey:["properties"],queryFn:async()=>{const{data:f,error:v}=await w.from("properties").select("*").eq("moderation_status","approved").order("created_at",{ascending:!1});if(v)throw v;return f}}),p=h.filter(f=>!(o.city&&f.city!==o.city||o.propertyType&&f.property_type!==o.propertyType||o.minPrice&&f.monthly_rent<o.minPrice||o.maxPrice&&f.monthly_rent>o.maxPrice||o.minSurface&&f.surface_area&&f.surface_area<o.minSurface||o.maxSurface&&f.surface_area&&f.surface_area>o.maxSurface||o.bedrooms&&f.bedrooms<o.bedrooms||o.bathrooms&&f.bathrooms<o.bathrooms||o.isFurnished&&!f.is_furnished||o.hasAc&&!f.has_ac||o.hasParking&&!f.has_parking||o.hasGarden&&!f.has_garden||o.status&&f.status!==o.status)),u=[...p].sort((f,v)=>l==="recent"?new Date(v.created_at).getTime()-new Date(f.created_at).getTime():l==="price_asc"?f.monthly_rent-v.monthly_rent:l==="price_desc"?v.monthly_rent-f.monthly_rent:0),g=u.slice(0,a),C=u.length>a,S=()=>{n(f=>f+12)},_=f=>{d(f)},b=()=>{d({})};return e.jsx("section",{className:"bg-background",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-[1400px]",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{children:p.length})," bien",p.length>1?"s":""," disponible",p.length>1?"s":""]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("select",{value:l,onChange:f=>c(f.target.value),className:"text-sm border rounded-md px-3 py-1.5 bg-background","aria-label":"Trier les résultats",children:[e.jsx("option",{value:"recent",children:"Plus récents"}),e.jsx("option",{value:"price_asc",children:"Prix croissant"}),e.jsx("option",{value:"price_desc",children:"Prix décroissant"})]})})]}),t&&e.jsx(ur,{onFilterChange:_,onReset:b}),e.jsx("div",{className:"mt-6",children:m?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:Array.from({length:12}).map((f,v)=>e.jsx(xr,{},v))}):x?e.jsx(be,{variant:"destructive",children:e.jsxs(Ne,{children:["Erreur lors du chargement des propriétés. ",j==null?void 0:j.message]})}):p.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx("p",{className:"text-xl text-muted-foreground mb-4",children:"Aucun bien ne correspond à vos critères"}),e.jsx(N,{onClick:b,variant:"outline",children:"Réinitialiser les filtres"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",role:"list","aria-label":"Liste des biens immobiliers",children:g.map((f,v)=>e.jsx(hn,{delay:Math.min(v*.05,.4),direction:"up",children:e.jsx("div",{role:"listitem",children:e.jsx(Ys,{property:f,variant:"compact",onFavoriteClick:A=>{if(!r){I({title:"Connexion requise",description:"Connectez-vous pour ajouter des favoris",variant:"destructive"});return}},isFavorite:!1})})},f.id))}),C&&e.jsx("div",{className:"text-center mt-8",children:e.jsxs(N,{onClick:S,size:"lg",variant:"outline",className:"min-w-[200px]",children:[e.jsx(Gr,{className:"h-4 w-4 mr-2"}),"Charger plus de biens (",u.length-a," restants)"]})})]})})]})})},fn=()=>{const[s,t]=i.useState(!1);i.useEffect(()=>{localStorage.getItem("onboarding_seen")||setTimeout(()=>{t(!0)},1e3)},[]);const r=()=>{localStorage.setItem("onboarding_seen","true"),t(!1)},a=()=>{localStorage.setItem("onboarding_seen","true")};return e.jsx(Wt,{open:s,onOpenChange:t,children:e.jsxs(Yt,{className:"w-full h-full md:h-auto md:max-w-5xl md:w-auto mx-auto",children:[e.jsx("button",{onClick:r,className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":"Fermer",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsxs(Jt,{children:[e.jsx(Zt,{className:"text-3xl md:text-4xl font-bold text-center",children:"Bienvenue sur Mon Toit ! 👋"}),e.jsx(er,{className:"text-lg text-center mt-2",children:"Que souhaitez-vous faire aujourd'hui ?"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-8",children:[e.jsx(U,{to:"/explorer",onClick:a,className:"group",children:e.jsxs(y,{className:"p-6 text-center hover:shadow-2xl hover:scale-105 transition-all duration-300 cursor-pointer border-2 hover:border-blue-600",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center group-hover:bg-blue-600 transition-colors",children:e.jsx(ee,{className:"h-8 w-8 text-blue-600 group-hover:text-white transition-colors"})})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Je cherche un logement"}),e.jsx("p",{className:"text-muted-foreground",children:"Trouvez votre logement idéal en 48h"})]})}),e.jsx(U,{to:"/publier",onClick:a,className:"group",children:e.jsxs(y,{className:"p-6 text-center hover:shadow-2xl hover:scale-105 transition-all duration-300 cursor-pointer border-2 hover:border-primary",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center group-hover:bg-primary transition-colors",children:e.jsx(Hr,{className:"h-8 w-8 text-primary group-hover:text-white transition-colors"})})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Je suis propriétaire"}),e.jsx("p",{className:"text-muted-foreground",children:"Publiez votre bien gratuitement"})]})}),e.jsx(U,{to:"/agence",onClick:a,className:"group",children:e.jsxs(y,{className:"p-6 text-center hover:shadow-2xl hover:scale-105 transition-all duration-300 cursor-pointer border-2 hover:border-secondary",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"w-16 h-16 bg-secondary/10 rounded-full flex items-center justify-center group-hover:bg-secondary transition-colors",children:e.jsx(ke,{className:"h-8 w-8 text-secondary group-hover:text-white transition-colors"})})}),e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Je suis une agence"}),e.jsx("p",{className:"text-muted-foreground",children:"Gérez vos biens avec notre CRM"})]})})]}),e.jsx("div",{className:"border-t pt-4 mt-6",children:e.jsx(N,{variant:"ghost",className:"w-full",onClick:r,children:"Explorer sans compte"})})]})})},gn=()=>(console.log("[Index] Rendering Index page"),e.jsxs(Ci,{children:[e.jsxs(Qr,{children:[e.jsx("title",{children:"Mon Toit - Location Immobilière Certifiée ANSUT en Côte d'Ivoire"}),e.jsx("meta",{name:"description",content:"Trouvez votre logement idéal en Côte d'Ivoire. Baux certifiés ANSUT, dossiers vérifiés, signature électronique. Plus de 3,500 logements à Abidjan, Yopougon, Cocody."}),e.jsx("link",{rel:"canonical",href:"https://montoit.ci"})]}),e.jsxs("main",{role:"main",children:[xn()?e.jsx(un,{}):e.jsx(mn,{}),e.jsx(pn,{limit:16,showFilters:!0}),e.jsx("section",{className:"py-8 bg-gradient-to-b from-primary/5 to-background border-t border-primary/10",children:e.jsx("div",{className:"container mx-auto px-4 max-w-4xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2 text-foreground",children:"Pas encore trouvé votre toit idéal ?"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Explorez plus de biens ou découvrez pourquoi 10 000+ Ivoiriens nous font confiance"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center items-center",children:[e.jsx(N,{asChild:!0,size:"lg",className:"shadow-md min-w-[200px]",children:e.jsxs(U,{to:"/explorer",children:[e.jsx(Me,{className:"h-4 w-4 mr-2"}),"Explorer plus de biens"]})}),e.jsx(N,{asChild:!0,variant:"outline",size:"lg",className:"shadow-sm min-w-[200px]",children:e.jsxs(U,{to:"/a-propos",children:[e.jsx(es,{className:"h-4 w-4 mr-2"}),"Pourquoi Mon Toit ?"]})})]})]})})})]}),e.jsx(fn,{})]})),jn=({onVerified:s,onCancel:t})=>{const[r,a]=i.useState(""),[n,l]=i.useState(!1),[c,o]=i.useState(!1),[d,h]=i.useState(!1),[m,x]=i.useState(0);i.useEffect(()=>{(async()=>{const{data:u,error:g}=await w.rpc("check_mfa_rate_limit");!g&&u===!1&&h(!0)})()},[m]);const j=async()=>{var u;if(r.length<6)return;if(d){I({title:"Trop de tentatives",description:"Veuillez réessayer dans 15 minutes",variant:"destructive"});return}l(!0);let p=!1;try{if(c){const{data:g,error:C}=await w.rpc("verify_backup_code",{_backup_code:r});if(C)throw C;if(g)p=!0,await w.rpc("log_mfa_attempt",{_success:!0,_attempt_type:"backup_code"}),I({title:"Code de récupération valide",description:"Connexion en cours..."}),s();else throw new Error("Code de récupération invalide")}else{const{data:g}=await w.auth.mfa.listFactors(),C=(u=g==null?void 0:g.totp)==null?void 0:u[0];if(!C)throw new Error("Aucun facteur 2FA trouvé");const S=await w.auth.mfa.challenge({factorId:C.id});if(S.error)throw S.error;const _=await w.auth.mfa.verify({factorId:C.id,challengeId:S.data.id,code:r});if(_.error)throw _.error;p=!0,await w.rpc("log_mfa_attempt",{_success:!0,_attempt_type:"totp"}),I({title:"Vérification réussie",description:"Connexion en cours..."}),s()}}catch{await w.rpc("log_mfa_attempt",{_success:!1,_attempt_type:c?"backup_code":"totp"}),x(C=>C+1),I({title:c?"Code de récupération invalide":"Code invalide",description:"Veuillez vérifier le code et réessayer",variant:"destructive"}),a("")}finally{l(!1)}};return e.jsxs(y,{className:"w-full max-w-md",children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5"}),"Authentification à deux facteurs"]}),e.jsx(O,{children:c?"Entrez un code de récupération":"Entrez le code à 6 chiffres de votre application d'authentification"})]}),e.jsxs(k,{className:"space-y-4",children:[d&&e.jsxs(be,{variant:"destructive",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx(Ne,{children:"Trop de tentatives échouées. Veuillez réessayer dans 15 minutes."})]}),e.jsx(X,{type:"text",placeholder:c?"XXXXXXXX":"000000",maxLength:c?8:6,value:r,onChange:p=>a(c?p.target.value.toUpperCase():p.target.value.replace(/\D/g,"")),className:"text-center text-2xl tracking-widest",autoFocus:!0,disabled:d}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(N,{onClick:j,disabled:n||r.length<6||d,className:"flex-1",children:[n&&e.jsx(oe,{className:"h-4 w-4 mr-2 animate-spin"}),"Vérifier"]}),e.jsx(N,{variant:"outline",onClick:t,children:"Annuler"})]}),e.jsx(N,{variant:"link",onClick:()=>{o(!c),a("")},className:"text-sm",children:c?"Utiliser le code d'authentification":"Utiliser un code de récupération"})]})]})]})},vn=async()=>{try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip||"0.0.0.0"}catch(s){return T.logError(s,{context:"ipUtils",action:"getClientIP"}),"0.0.0.0"}},bn=()=>{const s=document.createElement("canvas"),t=s.getContext("2d");if(!t)return"unknown";t.textBaseline="top",t.font="14px Arial",t.fillText("Fingerprint",2,2);const r=s.toDataURL().slice(-50),a={userAgent:navigator.userAgent,language:navigator.language,colorDepth:screen.colorDepth,screenResolution:`${screen.width}x${screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,canvas:r};return btoa(JSON.stringify(a)).slice(0,64)},Nn=s=>{const t=new Date(s).getTime()-Date.now();if(t<=0)return"maintenant";const r=Math.ceil(t/6e4);if(r<60)return`${r} minute${r>1?"s":""}`;const a=Math.ceil(r/60);return`${a} heure${a>1?"s":""}`},yn=({variant:s="auth"})=>{const r={auth:[{to:"/explorer",icon:ee,label:"Explorer les biens"},{to:"/guide",icon:nt,label:"Comment ça marche"},{to:"/guide#aide",icon:Ls,label:"Besoin d'aide ?"}],dashboard:[{to:"/recherche",icon:Me,label:"Rechercher"},{to:"/explorer",icon:ee,label:"Explorer"},{to:"/guide",icon:nt,label:"Guide"}],property:[{to:"/recherche",icon:Me,label:"Autres biens"},{to:"/dashboard",icon:ee,label:"Mon espace"},{to:"/guide",icon:Ls,label:"Aide"}]}[s];return e.jsxs(y,{className:"p-4 bg-muted/30 border-border/50",children:[e.jsx("p",{className:"text-sm font-medium text-foreground/80 mb-3",children:"Accès rapide"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.map(({to:a,icon:n,label:l})=>e.jsxs(U,{to:a,className:"flex items-center gap-2 px-3 py-1.5 rounded-md bg-background hover:bg-primary/10 text-sm font-medium text-foreground/70 hover:text-primary transition-smooth border border-border/50",children:[e.jsx(n,{className:"h-4 w-4"}),l]},a))})]})},wn=({backTo:s,backLabel:t="Retour",showHome:r=!0})=>e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s&&e.jsx(N,{variant:"ghost",size:"sm",asChild:!0,children:e.jsxs(U,{to:s,className:"gap-2",children:[e.jsx(Gs,{className:"h-4 w-4"}),t]})}),r&&e.jsx(N,{variant:"ghost",size:"sm",asChild:!0,children:e.jsxs(U,{to:"/",className:"gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Accueil"})]})})]}),Cn=Js({email:We().email({message:"Email invalide"}),password:We().min(8,{message:"Le mot de passe doit contenir au moins 8 caractères"}).regex(/[A-Z]/,{message:"Le mot de passe doit contenir au moins une majuscule"}).regex(/[a-z]/,{message:"Le mot de passe doit contenir au moins une minuscule"}).regex(/[0-9]/,{message:"Le mot de passe doit contenir au moins un chiffre"}).regex(/[^A-Za-z0-9]/,{message:"Le mot de passe doit contenir au moins un caractère spécial"}),fullName:We().min(2,{message:"Le nom complet doit contenir au moins 2 caractères"}),userType:_i(["locataire","proprietaire","agence"])}),Sn=Js({email:We().email({message:"Email invalide"}),password:We().min(6,{message:"Le mot de passe doit contenir au moins 6 caractères"})}),_n=()=>{const{signUp:s,signIn:t,user:r,hasRole:a}=le(),n=Ie(),[l]=qt(),c=l.get("type"),[o,d]=i.useState(""),[h,m]=i.useState(""),[x,j]=i.useState(""),[p,u]=i.useState(c||"locataire"),[g,C]=i.useState({}),[S,_]=i.useState(""),[b,f]=i.useState(""),[v,A]=i.useState({}),[V,B]=i.useState(!1),[Ce,D]=i.useState(!1),[$,W]=i.useState(null),[F,J]=i.useState(!1),[ce,ye]=i.useState(!1),[Ge,Ae]=i.useState(!1),[os,Nr]=i.useState(""),[rt,yr]=i.useState(null);i.useEffect(()=>{var se;r&&(c&&c!==((se=r.user_metadata)==null?void 0:se.user_type)?(I({title:"Déjà connecté",description:"Vous êtes déjà connecté. Rendez-vous dans votre profil pour gérer vos rôles."}),n("/profil",{replace:!0})):n("/",{replace:!0}))},[r,n,c]);const wr=async se=>{se.preventDefault(),C({});const De=Cn.safeParse({email:o,password:h,fullName:x,userType:p});if(!De.success){const pe={};De.error.errors.forEach(Te=>{const js=Te.path[0];pe[js]=Te.message}),C(pe);return}B(!0);const{error:me}=await s(o,h,x,p);B(!1),me||n("/")},Cr=async se=>{se.preventDefault(),A({}),Ae(!1);const De=Sn.safeParse({email:S,password:b});if(!De.success){const me={};De.error.errors.forEach(pe=>{const Te=pe.path[0];me[Te]=pe.message}),A(me);return}B(!0);try{const me=await vn(),pe=bn(),{data:Te}=await w.rpc("check_login_rate_limit",{_email:S,_ip_address:me});if(Te&&typeof Te=="object"&&"allowed"in Te&&!Te.allowed){Ae(!0),Nr(Te.reason||"Trop de tentatives"),Te.retry_after&&yr(Nn(Te.retry_after)),B(!1);return}const{error:js}=await t(S,b);if(await w.from("login_attempts").insert({email:S,ip_address:me,user_agent:navigator.userAgent,success:!js,fingerprint:pe}),B(!1),!js){const{data:{user:ks}}=await w.auth.getUser();if(ks){const{data:As}=await w.from("user_roles").select("role").eq("user_id",ks.id);if(As==null?void 0:As.some(ts=>ts.role==="admin")){const{data:ts}=await w.auth.mfa.listFactors();if(ts!=null&&ts.totp&&ts.totp.length>0){W(ks.id),D(!0);return}}}n("/")}}catch(me){T.logError(me,{context:"Auth",action:"signIn",email:S}),B(!1)}},Sr=()=>{D(!1),W(null),n("/")},_r=async()=>{await w.auth.signOut(),D(!1),W(null)},kr=async()=>{if(!S){I({title:"Email requis",description:"Veuillez entrer votre email d'abord",variant:"destructive"});return}const{error:se}=await w.auth.resetPasswordForEmail(S,{redirectTo:`${window.location.origin}/reset-password`});se?I({title:"Erreur",description:se.message,variant:"destructive"}):I({title:"Email envoyé",description:"Consultez votre boîte mail pour réinitialiser votre mot de passe"})},Ar=async()=>{var se,De;try{B(!0);const{data:me,error:pe}=await w.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/`,queryParams:{access_type:"offline",prompt:"consent"}}});if(pe)throw T.logError(pe,{context:"Auth",action:"googleOAuth",stage:"initial"}),pe;if(!me.url)throw new Error("Aucune URL de redirection OAuth reçue");T.debug("Redirection vers Google OAuth",{url:me.url})}catch(me){T.logError(me,{context:"Auth",action:"googleSignIn",stage:"complete"});let pe="Impossible de se connecter avec Google";(se=me.message)!=null&&se.includes("OAuth")?pe="Le service Google OAuth n'est pas configuré ou temporairement indisponible. Veuillez utiliser l'email et le mot de passe pour vous connecter.":(De=me.message)!=null&&De.includes("network")?pe="Erreur de connexion. Vérifiez votre connexion internet et réessayez.":me.message&&(pe=me.message),I({title:"Erreur de connexion Google",description:pe,variant:"destructive"})}finally{B(!1)}};return Ce?e.jsxs(e.Fragment,{children:[e.jsx(ie,{}),e.jsx("div",{className:"min-h-screen bg-background pt-20",children:e.jsx("div",{className:"container mx-auto px-4 py-8 max-w-md",children:e.jsx(jn,{onVerified:Sr,onCancel:_r})})}),e.jsx(ne,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{}),e.jsx("div",{className:"min-h-screen bg-background pt-20",children:e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-6xl",children:[e.jsx(ss,{}),e.jsx("div",{className:"mb-8",children:e.jsx(gs,{src:fs("ivorian-family-house"),alt:"Trouvez votre logement en Côte d'Ivoire",className:"w-full h-[250px] md:h-[300px] rounded-2xl",animate:!0})}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 items-start",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(wn,{backTo:"/",backLabel:"Retour à l'accueil"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-4xl font-bold text-foreground",children:"Bienvenue sur Mon Toit"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"La plateforme immobilière certifiée ANSUT pour la Côte d'Ivoire"}),e.jsxs("ul",{className:"space-y-3",children:[e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(Y,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Sécurité garantie"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Tous les utilisateurs sont vérifiés par l'ANSUT"})]})]}),e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(ee,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-foreground",children:"Biens certifiés"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Des logements vérifiés et conformes"})]})]})]})]}),e.jsx(yn,{variant:"auth"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(Be,{defaultValue:"signin",className:"w-full",children:[e.jsxs($e,{className:"grid w-full grid-cols-2",children:[e.jsx(re,{value:"signin",children:"Connexion"}),e.jsx(re,{value:"signup",children:"Inscription"})]}),e.jsx(de,{value:"signin",children:e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(E,{children:"Connexion"}),e.jsx(O,{children:"Connectez-vous à votre compte Mon Toit"}),c&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2 bg-muted/50 p-2 rounded",children:["💡 ",e.jsx("strong",{children:"Vous avez déjà un compte ?"})," Connectez-vous puis gérez vos rôles depuis ",e.jsx(U,{to:"/profil",className:"text-primary hover:underline font-medium",children:"votre profil"})]})]}),e.jsxs("form",{onSubmit:Cr,children:[e.jsxs(k,{className:"space-y-4",children:[Ge&&e.jsxs(be,{variant:"destructive",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsxs(Ne,{children:[os,rt&&` Réessayez dans ${rt}.`]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"signin-email",children:"Email"}),e.jsx(X,{id:"signin-email",type:"email",inputMode:"email",autoComplete:"email",placeholder:"votre@email.com",value:S,onChange:se=>_(se.target.value),required:!0}),v.email&&e.jsx("p",{className:"text-sm text-destructive",children:v.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"signin-password",children:"Mot de passe"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{id:"signin-password",type:F?"text":"password",autoComplete:"current-password",placeholder:"••••••••",value:b,onChange:se=>f(se.target.value),required:!0}),e.jsx("button",{type:"button",onClick:()=>J(!F),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors","aria-label":F?"Masquer le mot de passe":"Afficher le mot de passe",children:F?e.jsx(Ns,{className:"h-4 w-4"}):e.jsx(ns,{className:"h-4 w-4"})})]}),v.password&&e.jsx("p",{className:"text-sm text-destructive",children:v.password})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:kr,className:"text-sm text-primary hover:underline",children:"Mot de passe oublié ?"})})]}),e.jsxs(Fs,{className:"flex-col gap-3",children:[e.jsx(N,{type:"submit",className:"w-full",disabled:V,children:V?"Connexion...":"Se connecter"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:"Ou continuer avec"})})]}),e.jsxs(N,{type:"button",variant:"outline",className:"w-full",onClick:Ar,children:[e.jsxs("svg",{className:"mr-2 h-4 w-4",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continuer avec Google"]})]})]})]})}),e.jsx(de,{value:"signup",children:e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(E,{children:"Inscription"}),e.jsxs(O,{children:[c==="agence"&&"Créez votre compte Agence immobilière",c==="proprietaire"&&"Créez votre compte Propriétaire",c==="locataire"&&"Créez votre compte Locataire",!c&&"Créez votre compte Mon Toit"]}),c&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2 bg-muted/50 p-2 rounded",children:["💡 ",e.jsx("strong",{children:"Vous voulez ajouter ce rôle à un compte existant ?"})," Connectez-vous puis ",e.jsx(U,{to:"/profil",className:"text-primary hover:underline font-medium",children:"gérez vos rôles depuis votre profil"})]})]}),e.jsxs("form",{onSubmit:wr,children:[e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"fullname",children:"Nom complet"}),e.jsx(X,{id:"fullname",type:"text",placeholder:"Jean Kouamé",value:x,onChange:se=>j(se.target.value),required:!0}),g.fullName&&e.jsx("p",{className:"text-sm text-destructive",children:g.fullName})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"signup-email",children:"Email"}),e.jsx(X,{id:"signup-email",type:"email",inputMode:"email",autoComplete:"email",placeholder:"votre@email.com",value:o,onChange:se=>d(se.target.value),required:!0}),g.email&&e.jsx("p",{className:"text-sm text-destructive",children:g.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"signup-password",children:"Mot de passe"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{id:"signup-password",type:ce?"text":"password",autoComplete:"new-password",placeholder:"••••••••",value:h,onChange:se=>m(se.target.value),required:!0}),e.jsx("button",{type:"button",onClick:()=>ye(!ce),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors","aria-label":ce?"Masquer le mot de passe":"Afficher le mot de passe",children:ce?e.jsx(Ns,{className:"h-4 w-4"}):e.jsx(ns,{className:"h-4 w-4"})})]}),g.password&&e.jsx("p",{className:"text-sm text-destructive",children:g.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"usertype",children:"Type de compte"}),e.jsxs(fe,{value:p,onValueChange:se=>u(se),children:[e.jsx(ge,{id:"usertype",children:e.jsx(je,{})}),e.jsxs(ve,{children:[e.jsx(M,{value:"locataire",children:"🏠 Locataire - Je cherche un logement"}),e.jsx(M,{value:"proprietaire",children:"🏢 Propriétaire - Je loue mes biens"}),e.jsx(M,{value:"agence",children:"🏪 Agence - Je gère un portfolio"})]})]}),g.userType&&e.jsx("p",{className:"text-sm text-destructive",children:g.userType})]})]}),e.jsxs(Fs,{className:"flex-col gap-2",children:[e.jsx(N,{type:"submit",className:"w-full",disabled:V,children:V?"Création...":"Créer mon compte"}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(Y,{className:"h-3 w-3"}),e.jsx("span",{children:"Plateforme certifiée ANSUT"})]})]})]})]})})]}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:["En créant un compte, vous acceptez nos"," ",e.jsx(U,{to:"/conditions",className:"text-primary hover:underline",children:"conditions d'utilisation"})]})]})]})]})}),e.jsx(ne,{})]})},_s=()=>e.jsxs("svg",{className:"absolute inset-0 w-full h-full opacity-5 pointer-events-none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("defs",{children:e.jsxs("pattern",{id:"kente",x:"0",y:"0",width:"100",height:"100",patternUnits:"userSpaceOnUse",children:[e.jsx("rect",{x:"0",y:"0",width:"100",height:"10",fill:"hsl(30 100% 50%)"}),e.jsx("rect",{x:"0",y:"20",width:"100",height:"10",fill:"hsl(142 76% 36%)"}),e.jsx("rect",{x:"0",y:"40",width:"100",height:"10",fill:"hsl(45 100% 51%)"}),e.jsx("rect",{x:"0",y:"0",width:"10",height:"100",fill:"hsl(30 100% 50%)",opacity:"0.5"}),e.jsx("rect",{x:"30",y:"0",width:"10",height:"100",fill:"hsl(142 76% 36%)",opacity:"0.5"}),e.jsx("rect",{x:"60",y:"0",width:"10",height:"100",fill:"hsl(45 100% 51%)",opacity:"0.5"}),e.jsx("circle",{cx:"25",cy:"25",r:"5",fill:"hsl(30 100% 50%)"}),e.jsx("circle",{cx:"75",cy:"75",r:"5",fill:"hsl(142 76% 36%)"})]})}),e.jsx("rect",{width:"100%",height:"100%",fill:"url(#kente)"})]}),hr=()=>e.jsxs("svg",{className:"absolute inset-0 w-full h-full opacity-5 pointer-events-none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("defs",{children:e.jsxs("pattern",{id:"akan",x:"0",y:"0",width:"60",height:"60",patternUnits:"userSpaceOnUse",children:[e.jsx("path",{d:"M 30 15 Q 35 20, 30 25 Q 25 30, 20 25 Q 15 20, 20 15 Q 25 10, 30 15",stroke:"hsl(45 100% 51%)",strokeWidth:"1.5",fill:"none"}),e.jsx("line",{x1:"30",y1:"35",x2:"30",y2:"55",stroke:"hsl(142 76% 36%)",strokeWidth:"2"}),e.jsx("line",{x1:"20",y1:"45",x2:"40",y2:"45",stroke:"hsl(142 76% 36%)",strokeWidth:"2"})]})}),e.jsx("rect",{width:"100%",height:"100%",fill:"url(#akan)"})]}),kn=s=>{const t=i.useRef(null);return i.useEffect(()=>{if(!s)return;const r=t.current;if(!r)return;const a=r.querySelectorAll('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])'),n=a[0],l=a[a.length-1],c=o=>{o.key==="Tab"&&(o.shiftKey?document.activeElement===n&&(o.preventDefault(),l==null||l.focus()):document.activeElement===l&&(o.preventDefault(),n==null||n.focus()))};return n==null||n.focus(),document.addEventListener("keydown",c),()=>document.removeEventListener("keydown",c)},[s]),t},An=({onFilterChange:s,onReset:t,currentFilters:r={}})=>{const[a,n]=i.useState(!1),[l,c]=i.useState(1),o=kn(a),[d,h]=i.useState(r),[m,x]=i.useState([r.minPrice??0,r.maxPrice??1e6]),[j,p]=i.useState([r.minSurface??0,r.maxSurface??500]),u=()=>m[0]>m[1]?(I({title:"Erreur de validation",description:"Le prix minimum ne peut pas être supérieur au prix maximum",variant:"destructive"}),!1):j[0]>j[1]?(I({title:"Erreur de validation",description:"La surface minimum ne peut pas être supérieure à la surface maximum",variant:"destructive"}),!1):!0,g=()=>{if(!u())return;const f={...d,minPrice:m[0],maxPrice:m[1],minSurface:j[0],maxSurface:j[1]};we("medium"),s(f),n(!1),I({description:"✓ Filtres appliqués",duration:2e3})},C=()=>{we("light"),l===1?h({...d,city:void 0}):l===2?(x([0,1e6]),p([0,500])):l===3?h({...d,propertyType:void 0,bedrooms:void 0,bathrooms:void 0}):l===4&&h({...d,isFurnished:void 0,hasAc:void 0,hasParking:void 0,hasGarden:void 0,hasVideo:void 0,has360View:void 0,hasVirtualTour:void 0,isAnsutCertified:void 0})},S=()=>{we("medium"),h({}),x([0,1e6]),p([0,500]),t(),n(!1),I({description:"Tous les filtres ont été réinitialisés",duration:2e3})},_=Object.keys(d).filter(f=>d[f]!==void 0).length,b=[{number:1,title:"Localisation"},{number:2,title:"Budget"},{number:3,title:"Type de bien"},{number:4,title:"Options"}];return e.jsxs(Ia,{open:a,onOpenChange:n,children:[e.jsx(La,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:"relative","aria-label":"Ouvrir les filtres de recherche",children:[e.jsx(Rt,{className:"h-4 w-4 mr-2","aria-hidden":"true"}),"Filtres",_>0&&e.jsx(z,{className:"ml-2 h-5 w-5 rounded-full p-0 flex items-center justify-center",children:_})]})}),e.jsxs(za,{ref:o,side:"bottom",className:"h-[90vh] flex flex-col","aria-labelledby":"filters-title",children:[e.jsxs(Ra,{children:[e.jsx(qa,{id:"filters-title",children:"Filtres de recherche"}),e.jsx("div",{className:"flex justify-between items-center pt-4",children:b.map((f,v)=>e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold transition-colors ${l===f.number?"bg-primary text-primary-foreground":l>f.number?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:f.number}),e.jsx("span",{className:"text-xs mt-1 text-center",children:f.title})]}),v<b.length-1&&e.jsx("div",{className:`h-0.5 flex-1 -mt-5 ${l>f.number?"bg-primary":"bg-muted"}`})]},f.number))})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto py-6 space-y-4",children:[l===1&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Ville"}),e.jsxs(fe,{value:d.city,onValueChange:f=>{we("light"),h({...d,city:f})},children:[e.jsx(ge,{children:e.jsx(je,{placeholder:"Sélectionnez une ville"})}),e.jsx(ve,{children:Kt.map(f=>e.jsx(M,{value:f,children:f},f))})]})]})}),l===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(L,{children:"Prix mensuel (FCFA)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{type:"number",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Min",value:m[0],onChange:f=>{const v=parseInt(f.target.value)||0;x([v,m[1]])}}),e.jsx("span",{children:"-"}),e.jsx(X,{type:"number",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Max",value:m[1],onChange:f=>{const v=parseInt(f.target.value)||1e6;x([m[0],v])}})]}),e.jsx(Je,{min:0,max:1e6,step:1e4,value:m,onValueChange:f=>{we("light"),x(f)},className:"py-4"}),e.jsxs("p",{className:"text-sm text-muted-foreground text-center",children:[m[0].toLocaleString()," - ",m[1].toLocaleString()," FCFA"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(L,{children:"Surface (m²)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{type:"number",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Min",value:j[0],onChange:f=>{const v=parseInt(f.target.value)||0;p([v,j[1]])}}),e.jsx("span",{children:"-"}),e.jsx(X,{type:"number",inputMode:"numeric",pattern:"[0-9]*",placeholder:"Max",value:j[1],onChange:f=>{const v=parseInt(f.target.value)||500;p([j[0],v])}})]}),e.jsx(Je,{min:0,max:500,step:10,value:j,onValueChange:f=>{we("light"),p(f)},className:"py-4"}),e.jsxs("p",{className:"text-sm text-muted-foreground text-center",children:[j[0]," - ",j[1]," m²"]})]})]}),l===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Type de bien"}),e.jsxs(fe,{value:d.propertyType,onValueChange:f=>{we("light"),h({...d,propertyType:f})},children:[e.jsx(ge,{children:e.jsx(je,{placeholder:"Sélectionnez un type"})}),e.jsx(ve,{children:Xt.map(f=>e.jsx(M,{value:f,children:f},f))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Chambres (min)"}),e.jsx(X,{type:"number",inputMode:"numeric",pattern:"[0-9]*",min:0,placeholder:"0",value:d.bedrooms||"",onChange:f=>{we("light"),h({...d,bedrooms:f.target.value?parseInt(f.target.value):void 0})}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{children:"Salles de bain (min)"}),e.jsx(X,{type:"number",inputMode:"numeric",pattern:"[0-9]*",min:0,placeholder:"0",value:d.bathrooms||"",onChange:f=>{we("light"),h({...d,bathrooms:f.target.value?parseInt(f.target.value):void 0})}})]})]})]}),l===4&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(L,{children:"Équipements"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{key:"isFurnished",label:"Meublé"},{key:"hasAc",label:"Climatisation"},{key:"hasParking",label:"Parking"},{key:"hasGarden",label:"Jardin"}].map(({key:f,label:v})=>e.jsx(N,{variant:d[f]?"default":"outline",className:"min-h-[44px] py-3",onClick:()=>{we("light"),h({...d,[f]:!d[f]})},children:v},f))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(L,{children:"Visites & Médias"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{key:"hasVideo",label:"Avec vidéo"},{key:"has360View",label:"Vue 360°"},{key:"hasVirtualTour",label:"Visite virtuelle"},{key:"isAnsutCertified",label:"Certifié ANSUT"}].map(({key:f,label:v})=>e.jsx(N,{variant:d[f]?"default":"outline",className:"min-h-[44px] py-3",onClick:()=>{we("light"),h({...d,[f]:!d[f]})},children:v},f))})]})]})]}),e.jsxs("div",{className:"border-t pt-4 pb-safe space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(N,{variant:"outline",size:"sm",onClick:C,className:"flex-1",children:[e.jsx(_e,{className:"h-4 w-4 mr-1"}),"Reset section"]}),e.jsx(N,{variant:"outline",size:"sm",onClick:S,className:"flex-1",children:"Reset tout"})]}),e.jsxs("div",{className:"flex gap-2",children:[l>1&&e.jsxs(N,{variant:"outline",onClick:()=>{we("light"),c(l-1)},className:"flex-1",children:[e.jsx(Kr,{className:"h-4 w-4 mr-1"}),"Précédent"]}),l<4?e.jsxs(N,{onClick:()=>{we("light"),c(l+1)},className:"flex-1",children:["Suivant",e.jsx(Xr,{className:"h-4 w-4 ml-1"})]}):e.jsx(N,{onClick:g,className:"flex-1",children:"Appliquer les filtres"})]})]})]})]})},Tn=()=>{const[s,t]=i.useState(!1);return i.useEffect(()=>{const r=window.matchMedia("(prefers-reduced-motion: reduce)");t(r.matches);const a=n=>{t(n.matches)};return r.addEventListener("change",a),()=>r.removeEventListener("change",a)},[]),s},Pn=({onRefresh:s,children:t})=>{const[r,a]=i.useState(!1),n=i.useRef(Date.now()),l=i.useRef(0),c=i.useRef(null),o=i.useRef(!1),d=Tn(),[{y:h},m]=Wr(()=>({y:0}));return i.useEffect(()=>{const x=c.current;if(!x)return;const j=g=>{window.scrollY===0&&!r&&(l.current=g.touches[0].clientY,o.current=!1)},p=g=>{if(l.current===0||r)return;const S=g.touches[0].clientY-l.current;if(S>0){const _=Math.pow(S/300,.7),b=Math.min(S*_,120);m.start({y:b,immediate:!0}),b>80&&!o.current&&(we("medium"),o.current=!0),S>10&&g.preventDefault()}},u=async()=>{if(h.get()>80&&!r){if(Date.now()-n.current<5e3){I({description:"⏳ Veuillez patienter avant de rafraîchir à nouveau",duration:2e3}),m.start({y:0,config:{tension:200,friction:20}}),l.current=0;return}m.start({y:60}),a(!0),n.current=Date.now();try{await s(),I({description:"✓ Liste rafraîchie",duration:2e3})}catch{I({title:"Erreur",description:"Impossible de rafraîchir la liste",variant:"destructive"})}finally{a(!1)}}m.start({y:0,config:d?{tension:500,friction:50}:{tension:200,friction:20}}),l.current=0,o.current=!1};return x.addEventListener("touchstart",j,{passive:!0}),x.addEventListener("touchmove",p,{passive:!1}),x.addEventListener("touchend",u),()=>{x.removeEventListener("touchstart",j),x.removeEventListener("touchmove",p),x.removeEventListener("touchend",u)}},[r,s,m,h]),e.jsxs("div",{ref:c,className:"relative",children:[e.jsx(Ts.div,{className:"absolute top-0 left-0 right-0 flex justify-center items-center -translate-y-full",style:{opacity:h.to(x=>x>0?1:0),height:h.to(x=>`${x}px`)},children:r?e.jsx(oe,{className:"h-6 w-6 animate-spin text-primary"}):e.jsx(Ts.div,{style:{transform:h.to(x=>`rotate(${Math.min(x/80*180,180)}deg) rotate(${x*3}deg)`)},children:e.jsx(Os,{className:"h-6 w-6 text-primary"})})}),e.jsx(Ts.div,{style:{transform:h.to(x=>`translateY(${x}px)`)},children:t})]})},pr=()=>localStorage.getItem("mapbox_token")||"";pr();const jt={streets:"mapbox://styles/mapbox/streets-v12",satellite:"mapbox://styles/mapbox/satellite-v9",hybrid:"mapbox://styles/mapbox/satellite-streets-v12"},En=({properties:s,onPropertyClick:t,onLocationSearch:r,showLocationButton:a=!0})=>{const n=i.useRef(null),l=i.useRef(null),c=i.useRef([]),[o,d]=i.useState(!1),[h,m]=i.useState(!1),[x,j]=i.useState(()=>localStorage.getItem("preferredMapStyle")||"streets"),[p,u]=i.useState(pr()),[g,C]=i.useState(""),S=()=>{g.trim()&&(localStorage.setItem("mapbox_token",g.trim()),u(g.trim()),window.location.reload())};i.useEffect(()=>{if(!(!n.current||l.current)){try{if(!p){T.warn("Mapbox token not configured");return}he.accessToken=p,l.current=new he.Map({container:n.current,style:jt[x],center:[-4.0305,5.3599],zoom:11}),l.current.addControl(new he.NavigationControl,"top-right"),l.current.addControl(new he.FullscreenControl,"top-right"),l.current.on("load",()=>{d(!0)})}catch(v){T.logError(v,{context:"Map initialization"})}return()=>{var v;(v=l.current)==null||v.remove(),l.current=null}}},[x,p]);const _=()=>{if(!l.current||!o)return;c.current.forEach(A=>A.remove()),c.current=[];const v=s.filter(A=>A.latitude!==null&&A.longitude!==null);if(v.length!==0&&(v.forEach(A=>{const V=document.createElement("div");V.className="property-marker",V.innerHTML=`
        <div class="relative group">
          <div class="absolute -inset-1 bg-gradient-to-r from-primary to-secondary rounded-full blur opacity-25 group-hover:opacity-50 transition-opacity"></div>
          <div class="relative w-10 h-10 rounded-full bg-primary border-2 border-white shadow-lg flex items-center justify-center text-white font-bold text-xs group-hover:scale-110 transition-transform">
            ${(A.monthly_rent/1e3).toFixed(0)}k
          </div>
        </div>
      `,V.style.cursor="pointer";const B=`
        <div class="min-w-[200px]">
          ${A.main_image?`
            <img 
              src="${A.main_image}" 
              alt="${A.title}"
              class="w-full h-32 object-cover rounded-t-lg mb-2"
            />
          `:""}
          <div class="p-3">
            <h3 class="font-semibold text-sm mb-2 text-foreground">${A.title}</h3>
            <div class="flex items-center gap-1 text-xs text-muted-foreground mb-2">
              <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
              </svg>
              <span>${A.city}</span>
            </div>
            <p class="text-base font-bold text-primary">${A.monthly_rent.toLocaleString()} FCFA<span class="text-xs font-normal">/mois</span></p>
          </div>
        </div>
      `,Ce=new he.Popup({offset:25,className:"property-popup"}).setHTML(B),D=new he.Marker(V).setLngLat([A.longitude,A.latitude]).setPopup(Ce).addTo(l.current);V.addEventListener("click",()=>{t&&t(A.id)}),c.current.push(D)}),v.length>0)){const A=new he.LngLatBounds;v.forEach(V=>{A.extend([V.longitude,V.latitude])}),l.current.fitBounds(A,{padding:50,maxZoom:15})}};i.useEffect(()=>{_()},[s,o,t]);const b=v=>{!l.current||x===v||(j(v),localStorage.setItem("preferredMapStyle",v),l.current.once("style.load",()=>{_()}),l.current.setStyle(jt[v]))},f=()=>{m(!0),"geolocation"in navigator?navigator.geolocation.getCurrentPosition(v=>{const{latitude:A,longitude:V}=v.coords;l.current&&(l.current.flyTo({center:[V,A],zoom:13,essential:!0}),new he.Marker({color:"#3b82f6"}).setLngLat([V,A]).addTo(l.current)),r&&r(A,V),m(!1)},v=>{T.logError(v,{context:"Geolocation"}),m(!1)}):m(!1)};return e.jsxs("div",{className:"relative w-full h-[600px]",children:[p?e.jsx("div",{ref:n,className:"absolute inset-0 rounded-lg"}):e.jsxs(y,{className:"p-6 flex flex-col items-center justify-center h-full",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Configuration Mapbox requise"}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4 text-center max-w-md",children:["Veuillez entrer votre token PUBLIC Mapbox (pk.xxx) pour afficher la carte.",e.jsx("br",{}),e.jsx("a",{href:"https://account.mapbox.com/access-tokens/",target:"_blank",rel:"noopener noreferrer",className:"text-primary underline",children:"Obtenez votre token ici"})]}),e.jsxs("div",{className:"flex gap-2 w-full max-w-md",children:[e.jsx(X,{type:"text",placeholder:"pk.xxxxxxxxxxxxx",value:g,onChange:v=>C(v.target.value),className:"flex-1"}),e.jsx(N,{onClick:S,disabled:!g.trim(),children:"Enregistrer"})]})]}),p&&a&&e.jsx("div",{className:"absolute top-4 left-4 z-10",children:e.jsxs(N,{onClick:f,disabled:h,size:"sm",className:"shadow-lg",children:[e.jsx(Ft,{className:"h-4 w-4 mr-2"}),h?"Localisation...":"Autour de moi"]})}),p&&e.jsxs("div",{className:"absolute top-16 left-4 z-10 flex flex-col gap-2",children:[e.jsxs(N,{onClick:()=>b("streets"),size:"sm",variant:x==="streets"?"default":"outline",className:"shadow-lg",children:[e.jsx(ws,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Rues"})]}),e.jsxs(N,{onClick:()=>b("satellite"),size:"sm",variant:x==="satellite"?"default":"outline",className:"shadow-lg",children:[e.jsx(Vt,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Satellite"})]}),e.jsxs(N,{onClick:()=>b("hybrid"),size:"sm",variant:x==="hybrid"?"default":"outline",className:"shadow-lg",children:[e.jsx(us,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Hybride"})]})]}),p&&s.filter(v=>v.latitude===null||v.longitude===null).length>0&&e.jsx(y,{className:"absolute bottom-4 left-4 right-4 p-3 z-10 bg-background/95 backdrop-blur",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.filter(v=>v.latitude===null||v.longitude===null).length," bien(s) sans géolocalisation"]})})]})},Mn=(s,t)=>t&&s.owner_id===t?!0:s.status!=="loué";function vt(s){if(!s)return"Une erreur inconnue est survenue";const t=(s==null?void 0:s.message)||String(s),r=s==null?void 0:s.code;return r==="23505"?"Une propriété similaire existe déjà. Vérifiez vos données.":r==="23503"?"Référence invalide. Assurez-vous que toutes les informations sont correctes.":r==="23502"?"Champs obligatoires manquants. Veuillez remplir tous les champs requis.":t.includes("RLS")||t.includes("policy")?"Permissions insuffisantes. Connectez-vous avec un compte propriétaire.":t.includes("latitude")||t.includes("longitude")?"Erreur de localisation. Veuillez sélectionner un emplacement valide sur la carte.":t.includes("timeout")||t.includes("network")?"Problème de connexion. Vérifiez votre connexion internet et réessayez.":t.includes("invalid")||t.includes("invalide")?"Données invalides. Vérifiez que tous les champs sont correctement remplis.":t.length>100?"Erreur lors de la création de la propriété. Veuillez réessayer.":t}const In={async fetchAll(s){var c;if(T.debug("PropertyService fetchAll called with filters",{filters:s}),s!=null&&s.isAnsutCertified){const{data:o,error:d}=await w.from("properties").select(`
          *,
          leases!inner(certification_status)
        `).eq("leases.certification_status","certified").order("created_at",{ascending:!1});if(d)throw T.logError(d,{context:"propertyService",action:"fetchCertifiedProperties"}),d;const h=o.reduce((m,x)=>(m.find(p=>p.id===x.id)||m.push(x),m),[]);return T.info("ANSUT certified properties found",{count:h.length}),h}const{data:t,error:r}=await w.rpc("get_public_properties",{p_city:(s==null?void 0:s.city)||null,p_property_type:((c=s==null?void 0:s.propertyType)==null?void 0:c[0])||null,p_min_rent:(s==null?void 0:s.minPrice)||null,p_max_rent:(s==null?void 0:s.maxPrice)||null,p_min_bedrooms:(s==null?void 0:s.minBedrooms)||null,p_status:null});if(r){T.logError(r,{context:"propertyService",action:"fetchAllProperties"});const o=new Error(`Failed to fetch properties: ${r.message||"Unknown error"}. ${r.code?`Error code: ${r.code}`:""}`);throw o.originalError=r,o}T.debug("Properties received from API",{count:(t==null?void 0:t.length)||0});let a=t||[];const{data:{user:n}}=await w.auth.getUser(),l=a.length;if(a=a.filter(o=>Mn(o,n==null?void 0:n.id)),T.debug("Properties filtered by visibility",{before:l,after:a.length}),s!=null&&s.propertyType&&s.propertyType.length>1){const o=a.length;a=a.filter(d=>{var h;return(h=s.propertyType)==null?void 0:h.includes(d.property_type)}),T.debug("Properties filtered by type",{before:o,after:a.length})}if(s!=null&&s.minBathrooms){const o=a.length;a=a.filter(d=>d.bathrooms>=s.minBathrooms),T.debug("Properties filtered by bathrooms",{before:o,after:a.length})}if(s!=null&&s.minSurface){const o=a.length;a=a.filter(d=>d.surface_area&&d.surface_area>=s.minSurface),T.debug("Properties filtered by surface",{before:o,after:a.length})}if((s==null?void 0:s.isFurnished)!==void 0){const o=a.length;a=a.filter(d=>d.is_furnished===s.isFurnished),T.debug("Properties filtered by furnished status",{before:o,after:a.length})}if((s==null?void 0:s.hasParking)!==void 0){const o=a.length;a=a.filter(d=>d.has_parking===s.hasParking),T.debug("Properties filtered by parking",{before:o,after:a.length})}if((s==null?void 0:s.hasGarden)!==void 0){const o=a.length;a=a.filter(d=>d.has_garden===s.hasGarden),T.debug("Properties filtered by garden",{before:o,after:a.length})}if((s==null?void 0:s.hasAc)!==void 0){const o=a.length;a=a.filter(d=>d.has_ac===s.hasAc),T.debug("Properties filtered by AC",{before:o,after:a.length})}return T.info("Final property results after filtering",{count:a.length}),a},async fetchById(s){const{data:{user:t}}=await w.auth.getUser();if(t){const{data:n,error:l}=await w.from("properties").select("*").eq("id",s).maybeSingle();if(!l&&n)return n}const{data:r,error:a}=await w.rpc("get_public_property",{p_property_id:s});return!a&&r&&r.length>0?r[0]:null},async fetchByOwner(s){const{data:t,error:r}=await w.from("properties").select("*").eq("owner_id",s).order("created_at",{ascending:!1});if(r)throw T.logError(r,{context:"propertyService",action:"fetchByOwner",ownerId:s}),r;return t||[]},async update(s,t){const{data:r,error:a}=await w.from("properties").update(t).eq("id",s).select().single();if(a){T.logError(a,{context:"propertyService",action:"updateProperty",propertyId:s});const n=vt(a);throw new Error(n)}return r},async delete(s){const{error:t}=await w.from("properties").delete().eq("id",s);if(t){T.logError(t,{context:"propertyService",action:"deleteProperty",propertyId:s});const r=vt(t);throw new Error(r)}},async incrementViewCount(s){const{data:t}=await w.from("properties").select("view_count").eq("id",s).single();if(t){const{error:r}=await w.from("properties").update({view_count:(t.view_count||0)+1}).eq("id",s);if(r)throw T.logError(r,{context:"propertyService",action:"incrementViewCount",propertyId:s}),r}},async getStats(s){var c;const[t,r,a]=await Promise.all([w.from("user_favorites").select("*",{count:"exact",head:!0}).eq("property_id",s),w.from("rental_applications").select("*",{count:"exact",head:!0}).eq("property_id",s),w.from("properties").select("view_count").eq("id",s).single()]),n=((c=a.data)==null?void 0:c.view_count)||0,l=r.count||0;return{views:n,favorites:t.count||0,applications:l,conversionRate:n>0?Math.round(l/n*100):0}},async searchNearby(s,t,r,a){const n=await this.fetchAll(a),{calculateDistance:l}=await ae(async()=>{const{calculateDistance:c}=await Promise.resolve().then(()=>zn);return{calculateDistance:c}},void 0);return n.filter(c=>!c.latitude||!c.longitude?!1:l(s,t,c.latitude,c.longitude)<=r)}},Ln=s=>$s({queryKey:["properties",s],queryFn:()=>In.fetchAll(s),staleTime:6e4,retry:2}),et=s=>s.latitude!=null&&s.longitude!=null;function fr(s,t,r,a){const l=vs(r-s),c=vs(a-t),o=Math.sin(l/2)*Math.sin(l/2)+Math.cos(vs(s))*Math.cos(vs(r))*Math.sin(c/2)*Math.sin(c/2);return 6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))}function vs(s){return s*Math.PI/180}function gr(){return new Promise((s,t)=>{if(!navigator.geolocation){t(new Error("Geolocation is not supported by your browser"));return}navigator.geolocation.getCurrentPosition(r=>{s({latitude:r.coords.latitude,longitude:r.coords.longitude})},r=>{t(r)})})}const zn=Object.freeze(Object.defineProperty({__proto__:null,calculateDistance:fr,getCurrentLocation:gr,hasCoordinates:et},Symbol.toStringTag,{value:"Module"})),Rn=s=>{const{user:t}=le(),[r,a]=i.useState(s),[n,l]=i.useState(null);return i.useEffect(()=>{a(s)},[s]),{filteredProperties:r,userLocation:n,handleFilterChange:h=>{let m=[...s];h.city&&(m=m.filter(x=>x.city.toLowerCase().includes(h.city.toLowerCase()))),h.minPrice&&(m=m.filter(x=>x.monthly_rent>=h.minPrice)),h.maxPrice&&(m=m.filter(x=>x.monthly_rent<=h.maxPrice)),h.propertyType&&h.propertyType.length>0&&(m=m.filter(x=>h.propertyType.includes(x.property_type))),h.minBedrooms&&(m=m.filter(x=>x.bedrooms>=h.minBedrooms)),h.minBathrooms&&(m=m.filter(x=>x.bathrooms>=h.minBathrooms)),h.minSurface&&(m=m.filter(x=>x.surface_area&&x.surface_area>=h.minSurface)),h.furnished&&(m=m.filter(x=>x.is_furnished)),h.parking&&(m=m.filter(x=>x.has_parking)),h.garden&&(m=m.filter(x=>x.has_garden)),h.ac&&(m=m.filter(x=>x.has_ac)),a(m)},handleLocationSearch:async(h=5)=>{try{const m=await gr();l(m);const x=s.filter(et).filter(j=>fr(m.latitude,m.longitude,j.latitude,j.longitude)<=h);a(x),t&&await w.functions.invoke("track-search",{body:{userId:t.id,filters:{location:m,radius:h},resultCount:x.length}})}catch(m){T.error("Error getting location",{error:m,userId:t==null?void 0:t.id,radiusKm:h})}},handleReset:()=>{a(s),l(null)}}},qn=()=>{Ie();const[s]=qt(),{user:t,profile:r}=le(),{toggleFavorite:a,isFavorite:n}=Ws(),{data:l=[],isLoading:c,error:o,refetch:d}=Ln({currentUserId:t==null?void 0:t.id}),[h,m]=i.useState("grid"),x=Qt(),{filteredProperties:j,handleFilterChange:p,handleReset:u}=Rn(l);i.useEffect(()=>{if(l.length>0){const C=s.get("location"),S=s.get("type"),_=s.get("maxPrice");if(C||S||_){const b={};C&&(b.city=C),S&&(b.propertyType=S),_&&(b.maxPrice=parseInt(_)),p(b)}}},[s,l.length]);const g=async C=>{if(!t){xe.error("Vous devez être connecté pour ajouter des favoris");return}await a(C)};return e.jsxs("div",{className:"min-h-screen flex flex-col page-background",children:[e.jsx(ie,{}),e.jsxs("main",{className:"flex-1 page-container section-spacing pt-24",children:[e.jsx(ss,{}),e.jsxs("div",{className:"mb-8 relative",children:[e.jsx(_s,{}),e.jsx("div",{className:"relative z-10",children:e.jsxs("h1",{className:"text-h1 mb-4",children:[e.jsx("span",{className:"text-gradient-primary",children:"Rechercher"})," un bien"]})}),e.jsxs("p",{className:"text-lg text-muted-foreground",children:["Trouvez le logement idéal parmi ",l.length," annonces"]})]}),e.jsx("div",{className:"mb-6",children:x?e.jsx(An,{onFilterChange:p,onReset:u,currentFilters:{}}):e.jsx(ur,{onFilterChange:p,onReset:u})}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[j.length," ",j.length>1?"biens trouvés":"bien trouvé"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{variant:h==="grid"?"default":"outline",size:"sm",onClick:()=>m("grid"),children:e.jsx(Yr,{className:"h-4 w-4"})}),e.jsx(N,{variant:h==="list"?"default":"outline",size:"sm",onClick:()=>m("list"),children:e.jsx(Jr,{className:"h-4 w-4"})}),e.jsx(N,{variant:h==="map"?"default":"outline",size:"sm",onClick:()=>m("map"),children:e.jsx(ws,{className:"h-4 w-4"})})]})]}),e.jsx(Pn,{onRefresh:async()=>{await d()},children:h==="map"?e.jsx(y,{className:"p-4",children:e.jsx(En,{properties:j.filter(et)})}):e.jsx(e.Fragment,{children:c?e.jsx("div",{className:h==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:[1,2,3,4,5,6].map(C=>e.jsx(xr,{},C))}):j.length>0?e.jsx("div",{className:h==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4",children:j.map(C=>e.jsx(Ys,{property:C,isFavorite:n(C.id),onFavoriteClick:g,variant:h==="list"?"compact":"default"},C.id))}):e.jsxs(y,{className:"p-12 text-center space-y-6",children:[e.jsx(Me,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-semibold mb-2",children:s.get("location")?e.jsxs(e.Fragment,{children:["Aucun bien disponible à ",e.jsx("span",{className:"capitalize text-primary",children:s.get("location")})]}):"Aucun bien trouvé"}),e.jsx("p",{className:"text-muted-foreground",children:s.get("location")?"Essayez d'élargir votre recherche à d'autres villes ou désactivez certains filtres":"Essayez de modifier vos critères de recherche pour voir plus de résultats"})]}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(N,{onClick:()=>d(),variant:"outline",size:"lg",children:"🔄 Actualiser"}),e.jsx(N,{onClick:u,variant:"primary-gradient",size:"lg",children:"Réinitialiser les filtres"})]})]})})}),t&&e.jsx("div",{className:"mt-12",children:e.jsx(mi,{userId:t.id,type:"properties"})})]}),e.jsx(ne,{})]})},Fn=({variant:s="default",clickable:t=!0})=>{const r=e.jsxs("div",{className:"inline-flex items-center gap-2 bg-background border-2 border-secondary px-4 py-2 rounded-full shadow-card hover:shadow-primary transition-smooth",children:[e.jsx(Y,{className:"h-5 w-5 text-secondary fill-secondary/20"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs font-semibold text-secondary uppercase tracking-wide",children:"Certifié ANSUT"}),s==="default"&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"Plateforme sécurisée"})]})]});return t?e.jsx(U,{to:"/certification",className:"inline-block",children:r}):r},Vn=()=>{const s=[{icon:Y,title:"Vérification d'identité",description:"Tous les utilisateurs sont vérifiés via Smile ID pour garantir l'authenticité des profils."},{icon:Is,title:"Transactions sécurisées",description:"Paiements cryptés (AES-256) et conformes aux normes bancaires ivoiriennes."},{icon:zs,title:"Validation des annonces",description:"Chaque bien est vérifié par l'équipe ANSUT avant publication."},{icon:Ee,title:"Conformité légale",description:"Respect de la loi ivoirienne 2013-450 sur la protection des données."}];return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ie,{}),e.jsxs("main",{className:"flex-1 pt-24",children:[e.jsxs("section",{className:"relative h-96 overflow-hidden mb-12",children:[e.jsx(gs,{src:fs("certification-ansut-illustration"),alt:"Certification officielle ANSUT",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/90 to-secondary/80 flex items-center justify-center",children:e.jsxs("div",{className:"container mx-auto px-4 text-center text-white",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx(Fn,{clickable:!1})}),e.jsx("h1",{className:"text-h1 mb-4",children:e.jsx("span",{className:"text-gradient-animated",children:"Certification ANSUT"})}),e.jsx("p",{className:"text-lg max-w-2xl mx-auto opacity-95",children:"Mon Toit est propulsé par l'Agence Nationale de Soutien à l'Urbanisme et au Territoire (ANSUT), garantissant sécurité, fiabilité et conformité pour tous vos projets immobiliers."})]})})]}),e.jsx("section",{className:"py-6 md:py-10",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-4xl",children:[e.jsxs("div",{className:"bg-gradient-primary/10 border-2 border-primary/20 rounded-xl p-8 mb-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Qu'est-ce que la certification ANSUT ?"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"La certification ANSUT est un label de confiance délivré aux plateformes immobilières qui respectent les standards les plus élevés en matière de sécurité, transparence et conformité réglementaire en Côte d'Ivoire."}),e.jsx("p",{className:"text-muted-foreground",children:"Mon Toit s'engage à protéger vos données personnelles, vérifier l'authenticité de chaque annonce et garantir la sécurité de vos transactions financières."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-12",children:s.map((t,r)=>{const a=t.icon;return e.jsx("div",{className:"bg-card border border-border rounded-xl p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-gradient-primary shrink-0",children:e.jsx(a,{className:"h-6 w-6 text-primary-foreground"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.description})]})]})},r)})}),e.jsxs("div",{className:"bg-muted/50 rounded-xl p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Une plateforme 100% ivoirienne"}),e.jsx("p",{className:"text-muted-foreground max-w-2xl mx-auto",children:"Développée en Côte d'Ivoire, pour les Ivoiriens. Mon Toit s'adapte aux réalités locales et propose des solutions de paiement compatibles avec Mobile Money (Orange Money, MTN Money, Moov Money)."})]})]})})]}),e.jsx(ne,{})]})},Dn=Js({password:We().min(6,{message:"Le mot de passe doit contenir au moins 6 caractères"}),confirmPassword:We()}).refine(s=>s.password===s.confirmPassword,{message:"Les mots de passe ne correspondent pas",path:["confirmPassword"]}),Un=()=>{const s=Ie(),[t,r]=i.useState(""),[a,n]=i.useState(""),[l,c]=i.useState(!1),[o,d]=i.useState(!1),[h,m]=i.useState({}),[x,j]=i.useState(!1);i.useEffect(()=>{const{data:{subscription:u}}=w.auth.onAuthStateChange((C,S)=>{C==="PASSWORD_RECOVERY"&&S&&j(!0)});w.auth.getSession().then(({data:{session:C}})=>{C&&j(!0)});const g=setTimeout(()=>{x||(I({title:"Lien invalide",description:"Le lien de réinitialisation est expiré ou invalide. Veuillez redemander un nouveau lien.",variant:"destructive"}),s("/auth"))},3e3);return()=>{u.unsubscribe(),clearTimeout(g)}},[x,s]);const p=async u=>{u.preventDefault(),m({});const g=Dn.safeParse({password:t,confirmPassword:a});if(!g.success){const S={};g.error.errors.forEach(_=>{S[_.path[0]]=_.message}),m(S);return}d(!0);const{error:C}=await w.auth.updateUser({password:t});d(!1),C?I({title:"Erreur",description:C.message,variant:"destructive"}):(I({title:"Mot de passe réinitialisé",description:"Vous pouvez maintenant vous connecter avec votre nouveau mot de passe"}),s("/auth"))};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-primary/5 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md space-y-6",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsxs(U,{to:"/",className:"inline-flex items-center gap-2 text-2xl font-bold text-primary",children:[e.jsx(ee,{className:"h-8 w-8"}),"Mon Toit"]}),e.jsx("p",{className:"text-muted-foreground",children:"Propulsé par ANSUT"})]}),e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(E,{children:"Réinitialiser le mot de passe"}),e.jsx(O,{children:"Entrez votre nouveau mot de passe"})]}),e.jsxs("form",{onSubmit:p,children:[e.jsxs(k,{className:"space-y-4",children:[!x&&e.jsxs("div",{className:"flex items-center justify-center py-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),e.jsx("p",{className:"ml-3 text-muted-foreground",children:"Vérification du lien..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"password",children:"Nouveau mot de passe"}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{id:"password",type:l?"text":"password",placeholder:"••••••••",value:t,onChange:u=>r(u.target.value),required:!0}),e.jsx("button",{type:"button",onClick:()=>c(!l),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:l?e.jsx(Ns,{className:"h-4 w-4"}):e.jsx(ns,{className:"h-4 w-4"})})]}),h.password&&e.jsx("p",{className:"text-sm text-destructive",children:h.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"confirmPassword",children:"Confirmer le mot de passe"}),e.jsx(X,{id:"confirmPassword",type:l?"text":"password",placeholder:"••••••••",value:a,onChange:u=>n(u.target.value),required:!0}),h.confirmPassword&&e.jsx("p",{className:"text-sm text-destructive",children:h.confirmPassword})]})]}),e.jsx(Fs,{children:e.jsx(N,{type:"submit",className:"w-full",disabled:o||!x,children:o?"Réinitialisation...":"Réinitialiser le mot de passe"})})]})]})]})})},st=({score:s,showIcon:t=!0,size:r="md",className:a})=>{const l=(h=>h>=75?{label:"Excellent",variant:"default",icon:ls,bgClass:"bg-green-600 hover:bg-green-700",textClass:"text-white"}:h>=60?{label:"Bon",variant:"secondary",icon:Y,bgClass:"bg-yellow-600 hover:bg-yellow-700",textClass:"text-white"}:{label:"À risque",variant:"destructive",icon:Pe,bgClass:"bg-red-600 hover:bg-red-700",textClass:"text-white"})(s),c=l.icon,o={sm:"text-xs px-2 py-0.5",md:"text-sm px-3 py-1",lg:"text-base px-4 py-1.5"},d={sm:"h-3 w-3",md:"h-4 w-4",lg:"h-5 w-5"};return e.jsxs(z,{variant:l.variant,className:te(l.bgClass,l.textClass,o[r],"font-semibold flex items-center gap-1.5",a),children:[t&&e.jsx(c,{className:d[r]}),e.jsxs("span",{children:[s,"/100"]}),e.jsxs("span",{className:"hidden sm:inline",children:["• ",l.label]})]})},jr=({currentScore:s,oneciVerified:t=!1,faceVerified:r=!1})=>{const a=[{icon:Y,label:"Identité ONECI vérifiée",points:40,verified:t,description:"Vérification de votre Carte Nationale d'Identité",action:t?null:"Compléter ma vérification ONECI"},{icon:Rs,label:"Vérification faciale",points:30,verified:r,description:"Vérification biométrique Smile ID",action:r?null:"Activer la vérification faciale"},{icon:Re,label:"Documents fournis",points:20,verified:!1,description:"Fiches de paie, contrat de travail, etc.",action:"Ajouter mes documents"},{icon:qe,label:"Historique de location",points:10,verified:!1,description:"Attestations de bons paiements",action:"Ajouter mon historique"}],n=100,l=a.reduce((o,d)=>o+(d.verified?d.points:0),0),c=n-l;return e.jsxs(Wt,{children:[e.jsx(Fa,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(Ls,{className:"h-4 w-4"})})}),e.jsxs(Yt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Jt,{children:[e.jsxs(Zt,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-primary"}),"Comment fonctionne le Score de Fiabilité ?"]}),e.jsx(er,{children:"Votre score est calculé automatiquement selon vos vérifications et votre profil"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Votre score actuel"}),e.jsxs("span",{className:"text-2xl font-bold text-primary",children:[s,"/",n]})]}),e.jsx(Ke,{value:s,className:"h-3"}),c>0&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["+",c," points possibles pour atteindre le score maximum"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-4",children:"📋 Composition du Score (100 points max)"}),e.jsx("div",{className:"space-y-3",children:a.map((o,d)=>{const h=o.icon;return e.jsx("div",{className:`p-4 rounded-lg border ${o.verified?"bg-green-50 border-green-200 dark:bg-green-950/20 dark:border-green-900":"bg-muted/50 border-border"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(h,{className:`h-5 w-5 mt-0.5 ${o.verified?"text-green-600":"text-muted-foreground"}`}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-medium text-sm",children:o.label})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:o.description}),o.action&&!o.verified&&e.jsxs("p",{className:"text-xs text-primary font-medium mt-2",children:["→ ",o.action]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o.verified?e.jsx(xs,{className:"h-5 w-5 text-green-600"}):e.jsx(Fe,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("span",{className:`text-sm font-bold ${o.verified?"text-green-600":"text-muted-foreground"}`,children:["+",o.points]})]})]})},d)})})]}),e.jsxs("div",{className:"p-4 bg-primary/5 rounded-lg border border-primary/20",children:[e.jsx("h4",{className:"font-semibold mb-2 flex items-center gap-2",children:"💡 Conseils pour améliorer votre score"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[!t&&e.jsx("li",{children:"• Complétez votre vérification ONECI pour gagner +40 points immédiatement"}),!r&&e.jsx("li",{children:"• Activez la vérification faciale pour +30 points supplémentaires"}),e.jsx("li",{children:"• Un score élevé augmente vos chances d'obtenir un logement"}),e.jsx("li",{children:"• Les propriétaires privilégient les profils vérifiés"})]})]})]})]})]})},bt=[{value:"messages",label:"Messages",icon:ms,description:"Nouveaux messages et réponses"},{value:"applications",label:"Candidatures",icon:Re,description:"Nouvelles candidatures et mises à jour"},{value:"properties",label:"Biens immobiliers",icon:ee,description:"Nouveaux biens et favoris"},{value:"payments",label:"Paiements",icon:cs,description:"Paiements et transactions"},{value:"system",label:"Système",icon:Hs,description:"Notifications système importantes"}],On=()=>{const{user:s}=le(),{toast:t}=Ks(),[r,a]=i.useState([]),[n,l]=i.useState(!0);i.useEffect(()=>{s&&c()},[s]);const c=async()=>{if(s)try{const{data:d,error:h}=await w.from("notification_preferences").select("*").eq("user_id",s.id);if(h)throw h;const m=(d==null?void 0:d.map(j=>j.category))||[],x=bt.map(j=>j.value).filter(j=>!m.includes(j));if(x.length>0){const j=x.map(u=>({user_id:s.id,category:u,enabled:!0,email_enabled:!1,push_enabled:!0})),{data:p}=await w.from("notification_preferences").insert(j).select();a([...d||[],...p||[]])}else a(d||[])}catch(d){T.logError(d,{context:"NotificationPreferences",action:"fetch"}),t({title:"Erreur",description:"Impossible de charger les préférences",variant:"destructive"})}finally{l(!1)}},o=async(d,h,m)=>{if(s)try{const{error:x}=await w.from("notification_preferences").update({[h]:m}).eq("user_id",s.id).eq("category",d);if(x)throw x;a(j=>j.map(p=>p.category===d?{...p,[h]:m}:p)),t({title:"Préférences mises à jour",description:"Vos préférences de notifications ont été enregistrées"})}catch(x){T.logError(x,{context:"NotificationPreferences",action:"update"}),t({title:"Erreur",description:"Impossible de mettre à jour les préférences",variant:"destructive"})}};return n?e.jsxs(y,{children:[e.jsx(P,{children:e.jsx(E,{children:"Préférences de notifications"})}),e.jsx(k,{children:e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(E,{children:"Préférences de notifications"}),e.jsx(O,{children:"Gérez comment vous souhaitez recevoir vos notifications"})]}),e.jsx(k,{className:"space-y-6",children:bt.map(({value:d,label:h,icon:m,description:x})=>{const j=r.find(p=>p.category===d);return j?e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(m,{className:"h-5 w-5 mt-0.5 text-muted-foreground"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:h}),e.jsx("p",{className:"text-sm text-muted-foreground",children:x})]})]}),e.jsxs("div",{className:"grid gap-3 pl-8",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(L,{htmlFor:`${d}-enabled`,className:"text-sm",children:"Activer les notifications"}),e.jsx(Oe,{id:`${d}-enabled`,checked:j.enabled,onCheckedChange:p=>o(d,"enabled",p)})]}),j.enabled&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hs,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(L,{htmlFor:`${d}-push`,className:"text-sm",children:"Notifications push"})]}),e.jsx(Oe,{id:`${d}-push`,checked:j.push_enabled,onCheckedChange:p=>o(d,"push_enabled",p)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(L,{htmlFor:`${d}-email`,className:"text-sm",children:"Notifications par email"})]}),e.jsx(Oe,{id:`${d}-email`,checked:j.email_enabled,onCheckedChange:p=>o(d,"email_enabled",p)})]})]})]})]},d):null})})]})},Bn=()=>{const{user:s,roles:t,profile:r}=le(),[a,n]=i.useState({mfaEnabled:!1,backupCodesCount:0,unusedCodesCount:0,mfaRequired:!1,gracePeriodDays:0,loading:!0,complianceStatus:{daysRemaining:0,isExpired:!1,expiresAt:null}});return i.useEffect(()=>{if(!s){n({mfaEnabled:!1,backupCodesCount:0,unusedCodesCount:0,mfaRequired:!1,gracePeriodDays:0,loading:!1,complianceStatus:{daysRemaining:0,isExpired:!1,expiresAt:null}});return}(async()=>{try{const{data:o,error:d}=await w.from("mfa_backup_codes").select("id, used_at").eq("user_id",s.id);if(d)throw d;const h=(o==null?void 0:o.length)||0,m=(o==null?void 0:o.filter(g=>!g.used_at).length)||0,x=h>0;let j=!1,p=0;if(t.length>0){const g=t.filter(C=>["admin","super_admin","tiers_de_confiance","user"].includes(C));if(g.length>0){const{data:C,error:S}=await w.from("mfa_policies").select("role, mfa_required, grace_period_days").in("role",g);if(S)throw S;const _=C==null?void 0:C.find(b=>b.mfa_required);_&&(j=!0,p=_.grace_period_days||0)}}let u={daysRemaining:0,isExpired:!1,expiresAt:null};if(j&&!x&&(r!=null&&r.created_at)){const g=new Date(r.created_at),C=new Date(g);C.setDate(C.getDate()+p);const S=new Date,_=Math.ceil((C.getTime()-S.getTime())/(1e3*60*60*24));u={daysRemaining:Math.max(0,_),isExpired:_<0,expiresAt:C}}n({mfaEnabled:x,backupCodesCount:h,unusedCodesCount:m,mfaRequired:j,gracePeriodDays:p,loading:!1,complianceStatus:u})}catch(o){T.logError(o,{context:"useMfaStatus",action:"fetch"}),n(d=>({...d,loading:!1}))}})()},[s,t,r]),{...a,refreshStatus:async()=>{if(n(c=>({...c,loading:!0})),s){const{data:c}=await w.from("mfa_backup_codes").select("id, used_at").eq("user_id",s.id),o=(c==null?void 0:c.length)||0,d=(c==null?void 0:c.filter(h=>!h.used_at).length)||0;n(h=>{let m=h.complianceStatus;if(h.mfaRequired&&o===0&&(r!=null&&r.created_at)){const x=new Date(r.created_at),j=new Date(x);j.setDate(j.getDate()+h.gracePeriodDays);const p=new Date,u=Math.ceil((j.getTime()-p.getTime())/(1e3*60*60*24));m={daysRemaining:Math.max(0,u),isExpired:u<0,expiresAt:j}}else o>0&&(m={daysRemaining:0,isExpired:!1,expiresAt:null});return{...h,mfaEnabled:o>0,backupCodesCount:o,unusedCodesCount:d,loading:!1,complianceStatus:m}})}}}},$n=({codes:s,onDownload:t})=>{const r=()=>{const a=`Codes de récupération 2FA - Mon Toit

IMPORTANT : Conservez ces codes en lieu sûr !
Ces codes vous permettront de vous connecter si vous perdez l'accès à votre application d'authentification.

Chaque code ne peut être utilisé qu'une seule fois.

${s.map((o,d)=>`${d+1}. ${o}`).join(`
`)}

Généré le : ${new Date().toLocaleString("fr-FR")}
`,n=new Blob([a],{type:"text/plain"}),l=URL.createObjectURL(n),c=document.createElement("a");c.href=l,c.download=`montoit-backup-codes-${Date.now()}.txt`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l),t&&t()};return e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-green-600"}),"Codes de récupération 2FA"]}),e.jsx(O,{children:"Ces codes vous permettront de vous connecter si vous perdez l'accès à votre application d'authentification"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs(be,{variant:"destructive",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsxs(Ne,{children:[e.jsx("strong",{children:"IMPORTANT :"})," Conservez ces codes en lieu sûr. Chaque code ne peut être utilisé qu'une seule fois."]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 p-4 bg-muted rounded-lg font-mono text-sm",children:s.map((a,n)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-muted-foreground",children:[n+1,"."]}),e.jsx("code",{className:"font-bold tracking-wider",children:a})]},n))}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(N,{onClick:r,className:"flex-1",children:[e.jsx(It,{className:"h-4 w-4 mr-2"}),"Télécharger les codes"]})}),e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Vous pouvez voir vos codes restants dans votre profil"})]})]})},Gn=()=>{const{mfaEnabled:s,mfaRequired:t,unusedCodesCount:r,loading:a,refreshStatus:n}=Bn(),[l,c]=i.useState("idle"),[o,d]=i.useState(""),[h,m]=i.useState(""),[x,j]=i.useState(""),[p,u]=i.useState(""),[g,C]=i.useState([]),[S,_]=i.useState(!1),[b,f]=i.useState(!1);i.useEffect(()=>{s&&l==="idle"&&c("enabled")},[s,l]);const v=async()=>{_(!0);try{const{data:D,error:$}=await w.auth.mfa.enroll({factorType:"totp"});if($)throw $;if(D){const W=D.totp.uri||"";W.length>500&&T.warn("QR URI too long, truncating",{uriLength:W.length}),d(W.substring(0,500)),m(D.totp.secret),j(D.id),c("qr")}}catch(D){I({title:"Erreur",description:D.message,variant:"destructive"})}finally{_(!1)}},A=()=>{const D=[];for(let $=0;$<10;$++){const W=Math.random().toString(36).substring(2,10).toUpperCase();D.push(W)}return D},V=async(D,$)=>{const{data:{user:W}}=await w.auth.getUser();if(W){for(const F of D){const ce=new TextEncoder().encode(F),ye=await crypto.subtle.digest("SHA-256",ce),Ae=Array.from(new Uint8Array(ye)).map(os=>os.toString(16).padStart(2,"0")).join("");await w.from("mfa_backup_codes").insert({user_id:$,code_hash:Ae})}await w.from("admin_audit_logs").insert({admin_id:$,action_type:"mfa_backup_codes_generated",target_type:"user",target_id:$,action_metadata:{codes_count:D.length,timestamp:new Date().toISOString()}})}},B=async()=>{if(!(!p||!x)){_(!0);try{const D=await w.auth.mfa.challenge({factorId:x});if(D.error)throw D.error;const $=await w.auth.mfa.verify({factorId:x,challengeId:D.data.id,code:p});if($.error)throw $.error;const{data:{user:W}}=await w.auth.getUser();if(W){const F=A();await V(F,W.id),C(F),await w.from("admin_audit_logs").insert({admin_id:W.id,action_type:"mfa_enabled",target_type:"user",target_id:W.id,action_metadata:{timestamp:new Date().toISOString()}})}I({title:"2FA activé",description:"Authentification à deux facteurs activée avec succès"}),c("codes"),await n()}catch{I({title:"Code invalide",description:"Veuillez vérifier le code et réessayer",variant:"destructive"})}finally{_(!1)}}},Ce=async()=>{var D;_(!0);try{const{data:$}=await w.auth.mfa.listFactors(),W=(D=$==null?void 0:$.totp)==null?void 0:D[0];W&&await w.auth.mfa.unenroll({factorId:W.id});const{data:{user:F}}=await w.auth.getUser();F&&(await w.from("mfa_backup_codes").delete().eq("user_id",F.id),await w.from("admin_audit_logs").insert({admin_id:F.id,action_type:"mfa_disabled",target_type:"user",target_id:F.id,action_metadata:{timestamp:new Date().toISOString()}})),I({title:"2FA désactivé",description:"Authentification à deux facteurs désactivée"}),c("idle"),f(!1),await n()}catch($){I({title:"Erreur",description:$.message,variant:"destructive"})}finally{_(!1)}};return a?e.jsx(y,{children:e.jsx(P,{children:e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-5 w-5 animate-spin"}),"Chargement..."]})})}):l==="codes"?e.jsx("div",{className:"space-y-4",children:e.jsx($n,{codes:g,onDownload:()=>{c("enabled")}})}):l==="enabled"?e.jsxs(e.Fragment,{children:[e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(Qs,{className:"h-5 w-5 text-green-600"}),"2FA Activé"]}),e.jsx(O,{children:"Votre compte est protégé par l'authentification à deux facteurs"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Codes de récupération"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r," codes restants"]})]}),r<3&&e.jsx(Pe,{className:"h-5 w-5 text-orange-500"})]}),e.jsxs(N,{variant:"destructive",onClick:()=>f(!0),disabled:S,children:[S&&e.jsx(oe,{className:"h-4 w-4 mr-2 animate-spin"}),"Désactiver 2FA"]})]})]}),e.jsx(Va,{open:b,onOpenChange:f,children:e.jsxs(Da,{children:[e.jsxs(Ua,{children:[e.jsx(Oa,{children:"Désactiver 2FA ?"}),e.jsxs(Ba,{children:["Vous êtes sur le point de désactiver l'authentification à deux facteurs. Cela réduira la sécurité de votre compte.",t&&e.jsxs(be,{variant:"destructive",className:"mt-4",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsxs(Ne,{children:[e.jsx("strong",{children:"Attention :"})," La 2FA est obligatoire pour votre rôle. Vous devrez la réactiver."]})]})]})]}),e.jsxs($a,{children:[e.jsx(Ga,{children:"Annuler"}),e.jsx(Ha,{onClick:Ce,className:"bg-destructive text-destructive-foreground",children:"Désactiver"})]})]})})]}):l==="qr"?e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(E,{children:"Scanner le QR Code"}),e.jsx(O,{children:"Utilisez une application d'authentification (Google Authenticator, Authy, etc.)"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center bg-white p-4 rounded-lg",children:e.jsx(Zr,{value:o,size:200})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Ou entrez ce code manuellement :"}),e.jsx("code",{className:"block bg-muted p-2 rounded text-sm break-all",children:h})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Code de vérification"}),e.jsx(X,{type:"text",placeholder:"000000",maxLength:6,value:p,onChange:D=>u(D.target.value.replace(/\D/g,""))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{onClick:B,disabled:S||p.length!==6,className:"flex-1",children:"Vérifier et Activer"}),e.jsx(N,{variant:"outline",onClick:()=>c("idle"),children:"Annuler"})]})]})]}):e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5"}),"Authentification à deux facteurs"]}),e.jsx(O,{children:"Renforcez la sécurité de votre compte administrateur"})]}),e.jsxs(k,{className:"space-y-4",children:[t&&e.jsxs(be,{variant:"destructive",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsxs(Ne,{children:[e.jsx("strong",{children:"Obligatoire :"})," La 2FA est requise pour votre rôle. Vous devez l'activer pour garantir la sécurité."]})]}),e.jsxs(N,{onClick:v,disabled:S,children:[S&&e.jsx(oe,{className:"h-4 w-4 mr-2 animate-spin"}),"Activer 2FA"]})]})]})},Hn=()=>{var C;const{user:s,refreshProfile:t}=le(),r=Pt(),[a,n]=i.useState(!1),[l,c]=i.useState(null),[o,d]=i.useState(null),[h,m]=i.useState(0),x=async()=>{if(!s)return;const{data:S,error:_}=await w.from("user_active_roles").select("*").eq("user_id",s.id).single();if(_){T.logError(_,{context:"useRoleSwitch",action:"fetchActiveRoles"});return}c(S)},j=S=>{const _=(S==null?void 0:S.message)||"";if(_.includes("Rate limit")||_.includes("Too many")){const b=_.match(/(\d+)\s*(hour|minute)/i);return{type:"rate_limit",message:"Trop de changements récents. Veuillez patienter.",retryAfter:b?parseInt(b[1])*(b[2].toLowerCase()==="hour"?60:1):60}}return _.includes("not available")||_.includes("pas disponible")?{type:"unavailable",message:"Ce rôle n'est pas disponible pour votre compte."}:_.includes("NetworkError")||_.includes("Failed to fetch")?{type:"network",message:"Problème de connexion. Vérifiez votre réseau."}:_.includes("Unauthorized")||_.includes("not authenticated")?{type:"unauthorized",message:"Session expirée. Veuillez vous reconnecter."}:{type:"unknown",message:_||"Une erreur inattendue s'est produite."}},p=async(S,_=!1)=>{if(!s){const b={type:"unauthorized",message:"Vous devez être connecté"};d(b),I({title:"Erreur",description:b.message,variant:"destructive"});return}d(null),n(!0);try{const{data:b,error:f}=await w.functions.invoke("switch-role",{body:{newRole:S}});if(f)throw f;m(0),I({title:"✅ Rôle changé",description:b.message||`Vous êtes maintenant ${S}`,duration:3e3}),await t(),await x(),r.invalidateQueries(),setTimeout(()=>{window.location.reload()},500)}catch(b){const f=j(b);if(d(f),f.type==="network"&&h<2&&!_){m(A=>A+1),setTimeout(()=>{p(S,!0)},2e3),I({title:"Reconnexion...",description:`Tentative ${h+1}/2`});return}const v=f.retryAfter?`${f.message} Réessayez dans ${f.retryAfter} minute${f.retryAfter>1?"s":""}.`:f.message;I({title:"Erreur",description:v,variant:"destructive",duration:f.type==="rate_limit"?5e3:4e3})}finally{n(!1)}},u=()=>d(null),g=async S=>{if(s){n(!0);try{const{error:_}=await w.rpc("add_available_role",{p_user_id:s.id,p_new_role:S});if(_)throw _;I({title:"✅ Rôle ajouté",description:`Le rôle ${S} est maintenant disponible`}),await x()}catch(_){I({title:"Erreur",description:_.message,variant:"destructive"})}finally{n(!1)}}};return{activeRoles:l,currentRole:l==null?void 0:l.current_role,availableRoles:(l==null?void 0:l.available_roles)||[],isLoading:a,error:o,retryCount:h,switchRole:p,addAvailableRole:g,fetchActiveRoles:x,clearError:u,hasMultipleRoles:(((C=l==null?void 0:l.available_roles)==null?void 0:C.length)||0)>1}},Nt={locataire:{label:"Locataire",description:"Recherchez et postulez aux annonces",icon:ee,gradient:"from-primary/10 via-primary/5 to-transparent",borderColor:"border-primary/30",iconColor:"text-primary",badgeColor:"bg-primary/10 text-primary"},proprietaire:{label:"Propriétaire",description:"Gérez vos biens et recevez des candidatures",icon:ke,gradient:"from-secondary/10 via-secondary/5 to-transparent",borderColor:"border-secondary/30",iconColor:"text-secondary",badgeColor:"bg-secondary/10 text-secondary"},agence:{label:"Agence Immobilière",description:"Gérez un portefeuille de biens",icon:ea,gradient:"from-accent/10 via-accent/5 to-transparent",borderColor:"border-accent/30",iconColor:"text-accent-foreground",badgeColor:"bg-accent/10 text-accent-foreground"}},Qn=()=>{const{currentRole:s,availableRoles:t,isLoading:r,error:a,switchRole:n,fetchActiveRoles:l,hasMultipleRoles:c}=Hn(),[o,d]=i.useState(null);if(i.useEffect(()=>{l()},[]),!s)return null;const h=async x=>{x===s||r||(d(x),await n(x),d(null))},m=t.filter(x=>x!=="admin_ansut"&&x in Nt);return e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-5 w-5"}),"Gestion des Rôles"]}),e.jsx(O,{children:c?"Basculez entre vos différents rôles sans vous reconnecter":"Ajoutez un nouveau rôle pour accéder à plus de fonctionnalités"})]}),e.jsxs(k,{className:"space-y-4",children:[a&&e.jsxs(be,{variant:"destructive",children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsx(Ne,{children:a.message})]}),e.jsx("div",{className:"grid gap-3",children:m.map(x=>{const j=Nt[x],p=j.icon,u=x===s,g=o===x;return e.jsxs("div",{className:te("relative overflow-hidden rounded-xl border-2 transition-all duration-800","hover:shadow-md cursor-pointer",u?te(j.borderColor,"shadow-soft"):"border-border/50 hover:border-border"),onClick:()=>!u&&h(x),children:[e.jsx("div",{className:te("absolute inset-0 bg-gradient-to-br opacity-50",u&&j.gradient)}),e.jsx("div",{className:"relative p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:te("p-2.5 rounded-lg transition-all duration-800",u?j.badgeColor:"bg-muted"),children:e.jsx(p,{className:te("h-5 w-5 transition-colors duration-800",u?j.iconColor:"text-muted-foreground")})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold text-foreground",children:j.label}),u&&e.jsxs(z,{variant:"default",className:te("text-xs",j.badgeColor),children:[e.jsx(Qs,{className:"h-3 w-3 mr-1"}),"Actif"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-0.5",children:j.description})]})]}),!u&&e.jsx(N,{variant:"ghost",size:"sm",disabled:r,className:"hover:bg-primary/10",children:g?e.jsx(oe,{className:"h-4 w-4 animate-spin"}):"Activer"})]})})]},x)})}),!c&&e.jsx("div",{className:"mt-4 p-4 bg-muted/50 rounded-lg border border-border/50",children:e.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"💡 Vous pouvez ajouter d'autres rôles selon vos besoins"})})]})]})},Kn=()=>{const{user:s}=le(),[t,r]=i.useState([]),[a,n]=i.useState(!0),[l,c]=i.useState(!1),[o,d]=i.useState({city:"",property_type:"",min_rent:"",max_rent:"",min_bedrooms:""});i.useEffect(()=>{s&&h()},[s]);const h=async()=>{try{const{data:u,error:g}=await w.from("property_alerts").select("*").eq("user_id",s==null?void 0:s.id).order("created_at",{ascending:!1});if(g)throw g;r(u||[])}catch{T.error("Failed to fetch property alerts"),xe.error("Erreur lors du chargement des alertes")}finally{n(!1)}},m=async()=>{if(s){if(!o.city){xe.error("Veuillez sélectionner une ville");return}try{const{error:u}=await w.from("property_alerts").insert({user_id:s.id,alert_type:"new_similar",search_criteria:{city:o.city,property_type:o.property_type||null,min_rent:o.min_rent?parseInt(o.min_rent):null,max_rent:o.max_rent?parseInt(o.max_rent):null,min_bedrooms:o.min_bedrooms?parseInt(o.min_bedrooms):null},email_enabled:!0,push_enabled:!0,is_active:!0});if(u)throw u;xe.success("Alerte créée avec succès"),c(!1),d({city:"",property_type:"",min_rent:"",max_rent:"",min_bedrooms:""}),h()}catch{T.error("Failed to create property alert"),xe.error("Erreur lors de la création de l'alerte")}}},x=async(u,g,C)=>{try{const{error:S}=await w.from("property_alerts").update({[g]:C}).eq("id",u);if(S)throw S;r(t.map(_=>_.id===u?{..._,[g]:C}:_)),xe.success("Préférences mises à jour")}catch{T.error("Failed to update property alert",{alertId:u,field:g}),xe.error("Erreur lors de la mise à jour")}},j=async u=>{if(confirm("Êtes-vous sûr de vouloir supprimer cette alerte ?"))try{const{error:g}=await w.from("property_alerts").delete().eq("id",u);if(g)throw g;r(t.filter(C=>C.id!==u)),xe.success("Alerte supprimée")}catch{T.error("Failed to delete property alert",{alertId:u}),xe.error("Erreur lors de la suppression")}},p=u=>{const g=[];return u.city&&g.push(u.city),u.property_type&&g.push(u.property_type),(u.min_rent||u.max_rent)&&g.push(`${u.min_rent||0} - ${u.max_rent||"∞"} FCFA`),u.min_bedrooms&&g.push(`${u.min_bedrooms}+ chambres`),g.join(" • ")};return a?e.jsx("div",{className:"flex justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e.jsx("div",{className:"space-y-6",children:e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(Hs,{className:"h-5 w-5"}),"Mes Alertes Immobilières"]}),e.jsx(O,{children:"Recevez des notifications quand de nouveaux biens correspondent à vos critères"})]}),e.jsxs(k,{className:"space-y-4",children:[t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(sa,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Aucune alerte configurée"}),e.jsx("p",{className:"text-sm",children:"Créez votre première alerte pour ne manquer aucune opportunité"})]}):e.jsx("div",{className:"space-y-4",children:t.map(u=>e.jsx(y,{className:"border-2",children:e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Oe,{checked:u.is_active,onCheckedChange:g=>x(u.id,"is_active",g)}),e.jsx("span",{className:"font-medium",children:p(u.search_criteria)})]}),u.last_triggered_at&&e.jsxs("p",{className:"text-xs text-muted-foreground mb-2",children:["Dernière alerte: ",new Date(u.last_triggered_at).toLocaleDateString("fr-FR"),u.trigger_count>0&&` (${u.trigger_count} notifications envoyées)`]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-4 w-4"}),e.jsx(Oe,{checked:u.email_enabled,onCheckedChange:g=>x(u.id,"email_enabled",g),disabled:!u.is_active}),e.jsx("span",{children:"Email"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx(Mt,{className:"h-4 w-4"}),e.jsx(Oe,{checked:u.push_enabled,onCheckedChange:g=>x(u.id,"push_enabled",g),disabled:!u.is_active}),e.jsx("span",{children:"Push"})]})]})]}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>j(u.id),className:"text-destructive hover:text-destructive",children:e.jsx(ta,{className:"h-4 w-4"})})]})})},u.id))}),l?e.jsx(y,{className:"border-2 border-primary",children:e.jsxs(k,{className:"p-4 space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"Nouvelle alerte"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(L,{children:"Ville *"}),e.jsxs(fe,{value:o.city,onValueChange:u=>d({...o,city:u}),children:[e.jsx(ge,{children:e.jsx(je,{placeholder:"Sélectionner une ville"})}),e.jsxs(ve,{children:[e.jsx(M,{value:"Abidjan",children:"Abidjan"}),e.jsx(M,{value:"Yamoussoukro",children:"Yamoussoukro"}),e.jsx(M,{value:"Bouaké",children:"Bouaké"}),e.jsx(M,{value:"San-Pédro",children:"San-Pédro"})]})]})]}),e.jsxs("div",{children:[e.jsx(L,{children:"Type de bien"}),e.jsxs(fe,{value:o.property_type,onValueChange:u=>d({...o,property_type:u}),children:[e.jsx(ge,{children:e.jsx(je,{placeholder:"Tous les types"})}),e.jsxs(ve,{children:[e.jsx(M,{value:"appartement",children:"Appartement"}),e.jsx(M,{value:"maison",children:"Maison"}),e.jsx(M,{value:"studio",children:"Studio"}),e.jsx(M,{value:"villa",children:"Villa"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(L,{children:"Loyer minimum"}),e.jsx(X,{type:"number",placeholder:"Ex: 50000",value:o.min_rent,onChange:u=>d({...o,min_rent:u.target.value})})]}),e.jsxs("div",{children:[e.jsx(L,{children:"Loyer maximum"}),e.jsx(X,{type:"number",placeholder:"Ex: 200000",value:o.max_rent,onChange:u=>d({...o,max_rent:u.target.value})})]})]}),e.jsxs("div",{children:[e.jsx(L,{children:"Chambres minimum"}),e.jsx(X,{type:"number",placeholder:"Ex: 2",value:o.min_bedrooms,onChange:u=>d({...o,min_bedrooms:u.target.value})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{onClick:m,className:"flex-1",children:"Créer l'alerte"}),e.jsx(N,{onClick:()=>c(!1),variant:"outline",children:"Annuler"})]})]})}):e.jsxs(N,{onClick:()=>c(!0),className:"w-full",variant:"outline",children:[e.jsx(ra,{className:"h-4 w-4 mr-2"}),"Créer une nouvelle alerte"]})]})]})})},Xn=()=>{var $,W;const{user:s,profile:t,refreshProfile:r,hasRole:a}=le(),[n,l]=i.useState(!1),[c,o]=i.useState(null),[d,h]=i.useState(!1),[m,x]=i.useState(null),[j,p]=i.useState(0),[u,g]=i.useState(!1),[C,S]=i.useState(""),[_,b]=i.useState(""),[f,v]=i.useState(""),[A,V]=i.useState("");i.useEffect(()=>{t&&(S(t.full_name||""),b(t.phone||""),v(t.city||""),V(t.bio||""),(async()=>{var Ge;const{data:J}=await w.from("user_verifications").select("tenant_score").eq("user_id",t.id).maybeSingle();J!=null&&J.tenant_score&&o(J.tenant_score);const{data:ce}=await w.from("user_preferences").select("*").eq("user_id",t.id).maybeSingle();if(ce){x(ce);let Ae=w.from("properties").select("id",{count:"exact",head:!0});((Ge=ce.preferred_cities)==null?void 0:Ge.length)>0&&(Ae=Ae.in("city",ce.preferred_cities)),ce.min_budget&&(Ae=Ae.gte("monthly_rent",ce.min_budget)),ce.max_budget&&(Ae=Ae.lte("monthly_rent",ce.max_budget));const{count:os}=await Ae;p(os||0)}const{data:ye}=await w.from("notification_preferences").select("enabled").eq("user_id",t.id).eq("category","recommendations").maybeSingle();g((ye==null?void 0:ye.enabled)||!1)})())},[t]);const B=async F=>{if(s)try{const{error:J}=await w.from("notification_preferences").upsert({user_id:s.id,category:"recommendations",enabled:F,email_enabled:F,push_enabled:F});if(J)throw J;g(F),I({title:"Préférences mises à jour",description:F?"Vous serez notifié des nouvelles recommandations":"Les notifications de recommandations sont désactivées"})}catch(J){T.logError(J,{context:"Profile",action:"updateNotificationPreferences"}),I({title:"Erreur",description:"Impossible de mettre à jour les préférences",variant:"destructive"})}},Ce=async F=>{F.preventDefault(),l(!0);const{error:J}=await w.from("profiles").update({full_name:C,phone:_,city:f,bio:A}).eq("id",s.id);l(!1),J?I({title:"Erreur",description:J.message,variant:"destructive"}):(I({title:"Profil mis à jour",description:"Vos informations ont été enregistrées."}),r())};if(!t)return null;const D={locataire:"🏠 Locataire",proprietaire:"🏢 Propriétaire",agence:"🏪 Agence",admin_ansut:"👔 Admin ANSUT"};return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ie,{}),e.jsx("main",{className:"flex-1 container mx-auto px-4 py-8 pt-24",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsx(ss,{}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(as,{className:"h-20 w-20",children:[e.jsx(Xs,{src:t.avatar_url||""}),e.jsx(is,{className:"text-2xl",children:C.charAt(0).toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:C}),e.jsx("p",{className:"text-muted-foreground",children:D[t.user_type]})]})]}),e.jsxs(Be,{defaultValue:"profile",className:"w-full",children:[e.jsxs($e,{className:"grid w-full grid-cols-3",children:[e.jsx(re,{value:"profile",children:"Profil"}),e.jsx(re,{value:"preferences",children:"Préférences de recherche"}),e.jsx(re,{value:"alerts",children:"Alertes"})]}),e.jsxs(de,{value:"profile",className:"space-y-6 mt-6",children:[c&&c>0&&e.jsxs(y,{className:"border-primary/20 bg-gradient-to-br from-primary/5 to-transparent",children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(ps,{className:"h-5 w-5 text-primary"}),"Score de Fiabilité"]}),e.jsx(O,{children:"Votre évaluation en tant que locataire"})]}),e.jsx(k,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{children:e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Ce score est calculé automatiquement selon vos vérifications et votre profil"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(st,{score:c,size:"lg"}),e.jsx(jr,{currentScore:c,oneciVerified:t.oneci_verified,faceVerified:t.face_verified})]})]})})]}),e.jsx(Qn,{}),e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5"}),"Statut de vérification"]}),e.jsx(O,{children:"Vérifiez votre identité pour améliorer votre score"})]}),e.jsxs(k,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Vérification ONECI (Identité)"}),t.oneci_verified?e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(xs,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Vérifié"})]}):e.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Non vérifié"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Vérification CNAM (Emploi)"}),t.cnam_verified?e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(xs,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Vérifié"})]}):e.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[e.jsx(Fe,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Non vérifié"})]})]})]})]}),e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(E,{children:"Informations personnelles"}),e.jsx(O,{children:"Mettez à jour vos informations"})]}),e.jsx(k,{children:e.jsxs("form",{onSubmit:Ce,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"fullname",children:"Nom complet"}),e.jsx(X,{id:"fullname",value:C,onChange:F=>S(F.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"phone",children:"Téléphone"}),e.jsx(X,{id:"phone",type:"tel",placeholder:"+225 07 XX XX XX XX",value:_,onChange:F=>b(F.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"city",children:"Ville"}),e.jsx(X,{id:"city",placeholder:"Ex: Abidjan, Yamoussoukro",value:f,onChange:F=>v(F.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(L,{htmlFor:"bio",children:"Biographie"}),e.jsx(sr,{id:"bio",placeholder:"Parlez-nous de vous...",value:A,onChange:F=>V(F.target.value),rows:4})]}),e.jsx(N,{type:"submit",disabled:n,children:n?"Enregistrement...":"Enregistrer les modifications"})]})})]}),e.jsx(On,{}),a("admin")&&e.jsx("div",{className:"mt-6",children:e.jsx(Gn,{})})]}),e.jsx(de,{value:"preferences",className:"space-y-6 mt-6",children:e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(Ps,{className:"h-5 w-5"}),"Mes Préférences de recherche"]}),e.jsx(O,{children:"Configurez vos critères pour recevoir des recommandations personnalisées"})]}),e.jsx(k,{className:"space-y-6",children:m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[m.preferred_cities&&m.preferred_cities.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium mb-2",children:[e.jsx(Ze,{className:"h-4 w-4 text-primary"}),"Villes préférées"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.preferred_cities.map(F=>e.jsx(z,{variant:"secondary",children:F},F))})]}),m.preferred_property_types&&m.preferred_property_types.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium mb-2",children:[e.jsx(ee,{className:"h-4 w-4 text-primary"}),"Types de biens"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:m.preferred_property_types.map(F=>e.jsx(z,{variant:"secondary",children:F},F))})]}),(m.min_budget||m.max_budget)&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium mb-2",children:[e.jsx(cs,{className:"h-4 w-4 text-primary"}),"Budget"]}),e.jsxs(z,{variant:"secondary",children:[(($=m.min_budget)==null?void 0:$.toLocaleString())||"0"," - ",((W=m.max_budget)==null?void 0:W.toLocaleString())||"∞"," FCFA/mois"]})]}),(m.min_bedrooms>0||m.min_bathrooms>0)&&e.jsxs("div",{className:"flex gap-4",children:[m.min_bedrooms>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium mb-2",children:[e.jsx(Dt,{className:"h-4 w-4 text-primary"}),"Chambres min."]}),e.jsxs(z,{variant:"secondary",children:[m.min_bedrooms,"+"]})]}),m.min_bathrooms>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium mb-2",children:[e.jsx(aa,{className:"h-4 w-4 text-primary"}),"Salles de bain min."]}),e.jsxs(z,{variant:"secondary",children:[m.min_bathrooms,"+"]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[m.requires_parking&&e.jsx(z,{variant:"outline",children:"Parking requis"}),m.requires_garden&&e.jsx(z,{variant:"outline",children:"Jardin requis"}),m.requires_ac&&e.jsx(z,{variant:"outline",children:"Climatisation requise"}),m.requires_furnished&&e.jsx(z,{variant:"outline",children:"Meublé requis"})]})]}),e.jsx("div",{className:"p-4 bg-primary/5 rounded-lg border border-primary/10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Biens correspondants actuellement"}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:j})]}),e.jsx(ee,{className:"h-12 w-12 text-primary/20"})]})}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:"Notifications pour nouvelles recommandations"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Recevez une notification quotidienne quand de nouveaux biens matchent vos critères"})]}),e.jsx(Oe,{checked:u,onCheckedChange:B})]}),e.jsxs(N,{onClick:()=>h(!0),className:"w-full",children:[e.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Modifier mes préférences"]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ee,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4 opacity-50"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Vous n'avez pas encore configuré vos préférences de recherche"}),e.jsxs(N,{onClick:()=>h(!0),children:[e.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Configurer mes préférences"]})]})})]})}),e.jsx(de,{value:"alerts",className:"space-y-6 mt-6",children:e.jsx(Kn,{})})]})]})}),e.jsx(Si,{open:d,onOpenChange:h}),e.jsx(ne,{})]})},Wn=()=>{const{favorites:s,toggleFavorite:t,loading:r}=Ws(),[a,n]=i.useState([]),[l,c]=i.useState(!0);i.useEffect(()=>{s.length>0?o():(n([]),c(!1))},[s]);const o=async()=>{try{const{data:d,error:h}=await w.from("properties").select("*").in("id",s);if(h)throw h;n(d||[])}catch(d){T.logError(d,{context:"Favorites",action:"fetchFavoriteProperties"})}finally{c(!1)}};return l||r?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):e.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-br from-background via-background to-primary/5",children:[e.jsx(ie,{}),e.jsx("main",{className:"flex-1 container mx-auto px-4 py-6 pt-24",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx(ss,{}),e.jsxs("div",{className:"mb-10",children:[e.jsxs("h1",{className:"text-4xl font-bold mb-3 flex items-center gap-3",children:[e.jsx(bs,{className:"h-8 w-8 text-primary fill-primary"}),"Mes Favoris"]}),e.jsxs("p",{className:"text-lg text-muted-foreground",children:[a.length," bien",a.length>1?"s":""," sauvegardé",a.length>1?"s":""]})]}),a.length===0?e.jsxs(y,{className:"p-16 text-center border-2 shadow-xl bg-gradient-to-br from-background to-muted/20",children:[e.jsx("div",{className:"p-6 rounded-full bg-primary/10 w-fit mx-auto mb-6",children:e.jsx(bs,{className:"h-20 w-20 text-primary"})}),e.jsx("h3",{className:"text-2xl font-bold mb-3",children:"Aucun favori pour le moment"}),e.jsx("p",{className:"text-muted-foreground mb-6 text-lg max-w-md mx-auto",children:"Commencez à explorer nos biens et ajoutez vos coups de cœur à vos favoris"}),e.jsx(N,{asChild:!0,size:"lg",className:"rounded-xl h-14 px-8 text-base font-semibold shadow-lg",children:e.jsx(U,{to:"/recherche",children:"🏠 Parcourir les biens"})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(d=>e.jsx(Ys,{property:d,onFavoriteClick:()=>t(d.id),isFavorite:!0,showRemoveButton:!0},d.id))})]})}),e.jsx(ne,{})]})},Yn=()=>{const{user:s}=le(),[t,r]=i.useState(null),[a,n]=i.useState(!0);if(i.useEffect(()=>{(async()=>{if(!s){T.info("VerificationStatus - No user yet");return}T.info("VerificationStatus - Fetching verification",{userId:s.id});const{data:d,error:h}=await w.rpc("get_my_verification_status");h?T.error("VerificationStatus - Error fetching verification",{error:h,userId:s.id}):(T.info("VerificationStatus - Verification data fetched",{hasData:!!d,userId:s.id}),r(d&&d.length>0?d[0]:null)),n(!1)})()},[s]),a)return e.jsx("div",{className:"flex justify-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});const l=o=>{switch(o){case"verified":return e.jsx(xs,{className:"h-5 w-5 text-green-600"});case"pending":return e.jsx(qe,{className:"h-5 w-5 text-yellow-600"});case"rejected":return e.jsx(Fe,{className:"h-5 w-5 text-red-600"});default:return e.jsx(Ve,{className:"h-5 w-5 text-muted-foreground"})}},c=o=>{switch(o){case"verified":return e.jsx(z,{className:"bg-green-600",children:"Vérifié"});case"pending":return e.jsx(z,{className:"bg-yellow-600",children:"En attente"});case"pending_review":return e.jsx(z,{className:"bg-blue-600",children:"En cours de validation"});case"rejected":return e.jsx(z,{className:"bg-red-600",children:"Rejeté"});default:return e.jsx(z,{variant:"outline",children:"Non soumis"})}};return e.jsx(y,{children:e.jsx(k,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[l((t==null?void 0:t.oneci_status)||"pending"),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Vérification ONECI"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Carte Nationale d'Identité"})]})]}),c((t==null?void 0:t.oneci_status)||"pending")]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[l((t==null?void 0:t.face_verification_status)||"pending"),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Vérification Faciale"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Vérification biométrique"})]})]}),c((t==null?void 0:t.face_verification_status)||"pending")]}),(t==null?void 0:t.tenant_score)!==void 0&&t.tenant_score>0&&e.jsx("div",{className:"mt-6 pt-4 border-t",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Score de Fiabilité"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Évaluation automatique"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(st,{score:t.tenant_score,size:"lg"}),e.jsx(jr,{currentScore:t.tenant_score,oneciVerified:t.oneci_verified,faceVerified:t.face_verified})]})]})})]})})})},Jn=({value:s,className:t})=>e.jsx("div",{className:`relative h-2 w-full overflow-hidden rounded-full bg-secondary ${t}`,children:e.jsx("div",{className:"h-full bg-primary transition-all duration-300",style:{width:`${Math.min(100,Math.max(0,s))}%`}})}),Zn=({onSuccess:s,onSkip:t})=>{const[r,a]=i.useState(null),[n,l]=i.useState(null),[c,o]=i.useState(!1),[d,h]=i.useState(!1),[m,x]=i.useState(null),j=i.useRef(null),p=i.useRef(null),u=i.useRef(null),g=async()=>{try{if(T.info("Starting camera..."),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("L'API MediaDevices n'est pas supportée par ce navigateur");const v=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:1280},height:{ideal:720}}});T.info("Camera stream obtained successfully"),j.current&&(j.current.srcObject=v,u.current=v,o(!0),T.info("Camera activated successfully"))}catch(v){T.error("Error accessing camera",{error:v});let A="Impossible d'accéder à la caméra";v instanceof Error&&(v.name==="NotAllowedError"?A="Autorisation caméra refusée. Vérifiez les paramètres de votre navigateur.":v.name==="NotFoundError"?A="Aucune caméra trouvée sur cet appareil":v.name==="NotReadableError"&&(A="La caméra est déjà utilisée par une autre application")),xe.error(A)}},C=i.useCallback(()=>{u.current&&(u.current.getTracks().forEach(v=>v.stop()),u.current=null),o(!1)},[]),S=()=>{if(j.current&&p.current){const v=j.current,A=p.current;A.width=v.videoWidth,A.height=v.videoHeight;const V=A.getContext("2d");if(V){V.drawImage(v,0,0);const B=A.toDataURL("image/jpeg",.8);l(B),C(),xe.success("Selfie capturé !")}}},_=v=>{var V;const A=(V=v.target.files)==null?void 0:V[0];if(A){const B=new FileReader;B.onloadend=()=>{a(B.result),xe.success("Photo de CNI chargée !")},B.readAsDataURL(A)}},b=async()=>{if(!r||!n){xe.error("Veuillez fournir les deux images");return}h(!0),x(null);try{const{data:v,error:A}=await w.functions.invoke("smile-id-verification",{body:{cniImageBase64:r,selfieBase64:n}});if(A)throw A;x(v),v.verified?(xe.success("Vérification Smile ID réussie !",{description:`Score : ${v.similarityScore}% | Liveness : ${v.livenessCheck?"✓":"✗"} | Match : ${v.selfieToIdMatch?"✓":"✗"}`}),s==null||s()):xe.error("Vérification échouée",{description:v.message||v.resultText})}catch(v){T.error("Smile ID verification error",{error:v}),xe.error("Erreur lors de la vérification",{description:v instanceof Error?v.message:"Une erreur est survenue"})}finally{h(!1)}},f=()=>{a(null),l(null),x(null),C()};return e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(Rs,{className:"h-5 w-5"}),"Vérification Faciale (Optionnel)"]}),e.jsx(O,{children:"Vérification biométrique sécurisée propulsée par Smile ID"})]}),e.jsxs(k,{className:"space-y-6",children:[e.jsxs(be,{children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsxs(Ne,{children:[e.jsx("strong",{children:"Instructions importantes :"}),e.jsxs("ul",{className:"mt-2 space-y-1 text-sm list-disc list-inside",children:[e.jsx("li",{children:"Assurez-vous d'avoir un bon éclairage"}),e.jsx("li",{children:"Regardez directement la caméra"}),e.jsx("li",{children:"Retirez lunettes, masque ou chapeau"}),e.jsx("li",{children:"Gardez une expression neutre"})]})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"Photo de votre CNI"}),r?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:r,alt:"CNI",className:"w-full h-48 object-cover rounded-lg border-2 border-primary"}),e.jsx(N,{size:"sm",variant:"destructive",className:"absolute top-2 right-2",onClick:()=>a(null),children:"Retirer"})]}):e.jsxs("label",{className:"flex flex-col items-center justify-center h-48 border-2 border-dashed rounded-lg cursor-pointer hover:border-primary transition-colors",children:[e.jsx(ia,{className:"h-8 w-8 mb-2 text-muted-foreground"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Cliquez pour charger"}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:_})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"Votre selfie"}),n?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:n,alt:"Selfie",className:"w-full h-48 object-cover rounded-lg border-2 border-primary"}),e.jsx(N,{size:"sm",variant:"destructive",className:"absolute top-2 right-2",onClick:()=>l(null),children:"Retirer"})]}):c?e.jsxs("div",{className:"space-y-2",children:[e.jsx("video",{ref:j,autoPlay:!0,playsInline:!0,className:"w-full h-48 object-cover rounded-lg border-2 border-primary"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(N,{onClick:S,className:"flex-1",children:"Capturer"}),e.jsx(N,{onClick:C,variant:"outline",children:"Annuler"})]})]}):e.jsxs(N,{onClick:g,className:"w-full h-48 flex flex-col gap-2",variant:"outline",children:[e.jsx(Rs,{className:"h-8 w-8"}),"Ouvrir la caméra"]})]})]}),e.jsx("canvas",{ref:p,className:"hidden"}),m&&e.jsxs(be,{variant:m.verified?"default":"destructive",children:[m.verified?e.jsx(K,{className:"h-4 w-4"}):e.jsx(Fe,{className:"h-4 w-4"}),e.jsx(Ne,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium",children:m.message}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm",children:"Score de similarité :"}),e.jsx(Jn,{value:parseFloat(m.similarityScore),className:"flex-1"}),e.jsxs("span",{className:"text-sm font-bold",children:[m.similarityScore,"%"]})]}),!m.verified&&m.canRetry&&e.jsx("p",{className:"text-sm",children:"Vous pouvez réessayer avec de meilleures conditions."})]})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(N,{onClick:b,disabled:!r||!n||d,className:"flex-1",children:d?"Vérification en cours...":"Vérifier mon visage"}),t&&e.jsx(N,{onClick:t,variant:"outline",children:"Passer cette étape"}),(r||n||m)&&e.jsx(N,{onClick:f,variant:"outline",children:"Recommencer"})]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"🔒 Vos images ne sont pas stockées. Seul le score de vérification est conservé."})]})]})};class el extends i.Component{constructor(){super(...arguments);at(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,a){T.logError(r,{componentStack:a.componentStack,errorBoundary:!0}),ki(r,{contexts:{react:{componentStack:a.componentStack}}})}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs(y,{className:"max-w-md",children:[e.jsx(P,{children:e.jsxs(E,{className:"flex items-center gap-2 text-destructive",children:[e.jsx(Ve,{className:"h-5 w-5"}),"Une erreur s'est produite"]})}),e.jsxs(k,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:Qa.SERVER_ERROR}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Une erreur inattendue s'est produite. Vous pouvez essayer de recharger la page ou retourner à l'accueil."}),!1,e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(N,{onClick:()=>window.location.reload(),variant:"default",className:"gap-2",children:[e.jsx(Ut,{className:"h-4 w-4"}),"Recharger la page"]}),e.jsxs(N,{onClick:()=>window.location.href="/",variant:"outline",className:"gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Retour à l'accueil"]})]})]})]})}):this.props.children}}const sl=()=>{const{user:s,profile:t,loading:r}=le();return r?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):s?e.jsx(el,{children:e.jsxs("div",{className:"min-h-screen flex flex-col bg-background",translate:"no",children:[e.jsx(ie,{}),e.jsx("main",{className:"flex-grow container mx-auto px-4 py-8 pt-24",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx(ss,{}),e.jsxs("div",{className:"mb-8 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-3 mb-4",children:[e.jsx(Y,{className:"h-10 w-10 text-secondary"}),e.jsx("h1",{className:"text-3xl font-bold",children:"Vérification d'Identité"})]}),e.jsx("p",{className:"text-muted-foreground",children:"Complétez vos vérifications ONECI et Face ID pour augmenter votre crédibilité"})]}),e.jsx(Yn,{}),e.jsxs(Be,{defaultValue:"oneci",className:"mt-8",children:[e.jsxs($e,{className:"grid w-full grid-cols-2",children:[e.jsx(re,{value:"oneci",children:"ONECI (Ivoiriens)"}),e.jsx(re,{value:"face",children:"Vérification Faciale"})]}),e.jsx(de,{value:"oneci",children:e.jsx(ui,{})}),e.jsx(de,{value:"face",children:e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(E,{children:"Vérification Faciale"}),e.jsx(O,{children:"Renforcez votre profil avec une vérification biométrique Smile ID"})]}),e.jsx(k,{children:e.jsx(Zn,{})})]})})]})]})}),e.jsx(ne,{})]})}):e.jsx(Us,{to:"/auth",replace:!0})},tl=()=>{const[s,t]=i.useState([]),[r,a]=i.useState(!0),[n,l]=i.useState("pending"),{user:c}=le(),{toast:o}=Ks();i.useEffect(()=>{c&&d()},[c]);const d=async()=>{try{a(!0);const{data:u,error:g}=await w.from("guest_messages").select(`
          *,
          properties (
            title
          )
        `).eq("owner_id",c==null?void 0:c.id).order("created_at",{ascending:!1});if(g)throw g;t(u||[])}catch(u){T.logError(u,{context:"GuestMessagesInbox",action:"fetch"}),o({title:"Erreur",description:"Impossible de charger les messages",variant:"destructive"})}finally{a(!1)}},h=async(u,g)=>{try{const{error:C}=await w.from("guest_messages").update({status:g}).eq("id",u);if(C)throw C;t(S=>S.map(_=>_.id===u?{..._,status:g}:_)),o({title:"Statut mis à jour",description:`Message marqué comme "${m(g)}"`})}catch(C){T.logError(C,{context:"GuestMessagesInbox",action:"updateStatus"}),o({title:"Erreur",description:"Impossible de mettre à jour le statut",variant:"destructive"})}},m=u=>{switch(u){case"pending":return"En attente";case"replied":return"Répondu";case"spam":return"Spam";case"blocked":return"Bloqué";default:return u}},x=u=>{switch(u){case"pending":return"default";case"replied":return"secondary";case"spam":return"destructive";case"blocked":return"destructive";default:return"default"}},j=s.filter(u=>n==="all"?!0:u.status===n),p=u=>u==="all"?s.length:s.filter(g=>g.status===u).length;return r?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx(oe,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Messages des visiteurs"}),e.jsx("p",{className:"text-muted-foreground",children:"Gérez les messages reçus des visiteurs non inscrits"})]}),e.jsxs(Be,{value:n,onValueChange:l,children:[e.jsxs($e,{children:[e.jsxs(re,{value:"pending",children:["En attente (",p("pending"),")"]}),e.jsxs(re,{value:"replied",children:["Répondus (",p("replied"),")"]}),e.jsxs(re,{value:"spam",children:["Spam (",p("spam"),")"]}),e.jsxs(re,{value:"all",children:["Tous (",p("all"),")"]})]}),e.jsx(de,{value:n,className:"space-y-4 mt-6",children:j.length===0?e.jsx(y,{children:e.jsxs(k,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(hs,{className:"h-12 w-12 text-muted-foreground mb-4"}),e.jsxs("p",{className:"text-muted-foreground",children:["Aucun message ",n!=="all"&&m(n).toLowerCase()]})]})}):j.map(u=>{var g;return e.jsxs(y,{children:[e.jsx(P,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(E,{className:"text-lg flex items-center gap-2",children:[u.status==="pending"?e.jsx(hs,{className:"h-4 w-4 text-primary"}):e.jsx(lt,{className:"h-4 w-4 text-muted-foreground"}),u.guest_name]}),e.jsxs(O,{children:["Concernant : ",((g=u.properties)==null?void 0:g.title)||"Propriété supprimée"]})]}),e.jsx(z,{variant:x(u.status),children:m(u.status)})]})}),e.jsxs(k,{className:"space-y-4",children:[e.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:u.message_content})}),e.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Email :"}),e.jsxs("a",{href:`mailto:${u.guest_email}`,className:"text-primary hover:underline flex items-center gap-1",children:[u.guest_email,e.jsx(qs,{className:"h-3 w-3"})]})]}),u.guest_phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:"Téléphone :"}),e.jsx("a",{href:`tel:${u.guest_phone}`,className:"text-primary hover:underline",children:u.guest_phone})]}),e.jsxs("div",{className:"text-muted-foreground",children:["Reçu ",tr(new Date(u.created_at),{addSuffix:!0,locale:rr})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[u.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs(N,{variant:"default",size:"sm",onClick:()=>h(u.id,"replied"),children:[e.jsx(lt,{className:"h-4 w-4 mr-2"}),"Marquer comme répondu"]}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>h(u.id,"spam"),children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Spam"]})]}),u.status==="spam"&&e.jsxs(N,{variant:"destructive",size:"sm",onClick:()=>h(u.id,"blocked"),children:[e.jsx(na,{className:"h-4 w-4 mr-2"}),"Bloquer cet email"]}),u.status==="replied"&&e.jsx(N,{variant:"outline",size:"sm",onClick:()=>h(u.id,"pending"),children:"Marquer comme non répondu"})]})]})]},u.id)})})]})]})},rl=()=>{const s=ys(),t=Ie(),[r,a]=i.useState(10);return i.useEffect(()=>{T.warn("404 Error: User accessed non-existent route",{pathname:s.pathname,referrer:document.referrer})},[s.pathname]),i.useEffect(()=>{const n=setInterval(()=>{a(l=>l<=1?(t("/"),0):l-1)},1e3);return()=>clearInterval(n)},[t]),e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ie,{}),e.jsx("main",{className:"flex-1 flex items-center justify-center bg-gradient-to-br from-background to-muted pt-16",children:e.jsxs("div",{className:"container mx-auto px-4 py-10 text-center max-w-2xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-9xl font-bold text-primary mb-4",children:"404"}),e.jsx("h2",{className:"text-3xl font-semibold text-foreground mb-3",children:"Oups ! Page introuvable"}),e.jsxs("p",{className:"text-lg text-muted-foreground mb-2",children:["La page ",e.jsx("span",{className:"font-mono text-sm bg-muted px-2 py-1 rounded",children:s.pathname})," n'existe pas."]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Redirection automatique dans ",e.jsxs("span",{className:"font-bold text-primary",children:[r,"s"]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-12",children:[e.jsx(N,{asChild:!0,size:"lg",className:"gap-2",children:e.jsxs(U,{to:"/",children:[e.jsx(ee,{className:"h-5 w-5"}),"Retour à l'accueil"]})}),e.jsx(N,{asChild:!0,variant:"outline",size:"lg",className:"gap-2",children:e.jsxs(U,{to:"/recherche",children:[e.jsx(Me,{className:"h-5 w-5"}),"Rechercher un bien"]})}),e.jsxs(N,{variant:"ghost",size:"lg",className:"gap-2",onClick:()=>t(-1),children:[e.jsx(Gs,{className:"h-5 w-5"}),"Page précédente"]})]}),e.jsxs("div",{className:"bg-muted/50 border border-border rounded-lg p-6",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-3",children:"Pages populaires :"}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[e.jsx(U,{to:"/",className:"text-sm text-primary hover:underline",children:"Accueil"}),e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsx(U,{to:"/recherche",className:"text-sm text-primary hover:underline",children:"Recherche"}),e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsx(U,{to:"/certification",className:"text-sm text-primary hover:underline",children:"Certification"}),e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsx(U,{to:"/auth",className:"text-sm text-primary hover:underline",children:"Connexion"})]})]})]})}),e.jsx(ne,{})]})},al=({score:s,totalReviews:t,size:r="md",showDetails:a=!1})=>{const n=d=>d>=4.5?"text-green-600":d>=3.5?"text-blue-600":d>=2.5?"text-yellow-600":"text-red-600",l=d=>d>=4.5?"Excellent":d>=3.5?"Très bien":d>=2.5?"Bien":d>=1.5?"Moyen":"À améliorer",c={sm:"text-sm",md:"text-base",lg:"text-xl"},o={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"};return a?e.jsx(y,{children:e.jsx(k,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 rounded-full bg-primary/10",children:e.jsx(ps,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:`font-bold text-2xl ${n(s)}`,children:s.toFixed(1)}),e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(d=>e.jsx(ls,{className:`h-4 w-4 ${d<=Math.round(s)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},d))})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[l(s)," · ",t," avis"]})]})]})})}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ls,{className:`${o[r]} fill-yellow-400 text-yellow-400`}),e.jsx("span",{className:`font-semibold ${c[r]} ${n(s)}`,children:s.toFixed(1)}),e.jsxs("span",{className:`text-muted-foreground ${r==="sm"?"text-xs":"text-sm"}`,children:["(",t,")"]})]})},Ms=({userId:s,reviewType:t="all"})=>{const[r,a]=i.useState([]),[n,l]=i.useState(!0);i.useEffect(()=>{c()},[s,t]);const c=async()=>{try{let o=w.from("reviews").select(`
          id,
          rating,
          comment,
          review_type,
          created_at,
          reviewer:reviewer_id (
            id,
            full_name,
            avatar_url
          )
        `).eq("reviewee_id",s).order("created_at",{ascending:!1});t==="as_tenant"?o=o.eq("review_type","landlord_to_tenant"):t==="as_landlord"&&(o=o.eq("review_type","tenant_to_landlord"));const{data:d,error:h}=await o;if(h)throw h;const m=(d==null?void 0:d.map(x=>({...x,reviewer:Array.isArray(x.reviewer)?x.reviewer[0]:x.reviewer})))||[];a(m)}catch(o){T.logError(o,{context:"ReviewsList",action:"fetch",userId:s})}finally{l(!1)}};return n?e.jsx(y,{children:e.jsx(k,{className:"p-8",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})}):r.length===0?e.jsx(y,{children:e.jsxs(k,{className:"p-8 text-center",children:[e.jsx(ms,{className:"h-12 w-12 mx-auto mb-3 text-muted-foreground opacity-50"}),e.jsx("p",{className:"text-muted-foreground",children:"Aucun avis pour le moment"})]})}):e.jsx("div",{className:"space-y-4",children:r.map(o=>{var d,h,m,x;return e.jsxs(y,{children:[e.jsx(P,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(as,{children:[e.jsx(Xs,{src:((d=o.reviewer)==null?void 0:d.avatar_url)||""}),e.jsx(is,{children:((m=(h=o.reviewer)==null?void 0:h.full_name)==null?void 0:m.charAt(0).toUpperCase())||"?"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:((x=o.reviewer)==null?void 0:x.full_name)||"Utilisateur"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:tr(new Date(o.created_at),{addSuffix:!0,locale:rr})})]})]}),e.jsx(z,{variant:"outline",children:o.review_type==="tenant_to_landlord"?"En tant que propriétaire":"En tant que locataire"})]})}),e.jsxs(k,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(j=>e.jsx(ls,{className:`h-4 w-4 ${j<=o.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},j)),e.jsxs("span",{className:"ml-2 text-sm font-medium",children:[o.rating,"/5"]})]}),o.comment&&e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:o.comment})]})]},o.id)})})},il=()=>{const{userId:s}=la(),[t,r]=i.useState(null),[a,n]=i.useState(null),[l,c]=i.useState(!0);i.useEffect(()=>{s&&o()},[s]);const o=async()=>{if(s)try{const{data:h,error:m}=await w.from("profiles").select("id, full_name, avatar_url, user_type").eq("id",s).single();if(m)throw m;r(h);const{data:x}=await w.from("reputation_scores").select("*").eq("user_id",s).maybeSingle();n(x)}catch(h){T.logError(h,{context:"UserReviews",action:"fetchUserData"})}finally{c(!1)}};if(l)return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ie,{}),e.jsx("main",{className:"flex-1 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}),e.jsx(ne,{})]});if(!t)return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ie,{}),e.jsx("main",{className:"flex-1 container mx-auto px-4 py-12",children:e.jsx(y,{children:e.jsx(k,{className:"p-8 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Utilisateur introuvable"})})})}),e.jsx(ne,{})]});const d={locataire:"Locataire",proprietaire:"Propriétaire",agence:"Agence",admin_ansut:"Admin ANSUT"};return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ie,{}),e.jsx("main",{className:"flex-1 container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsx(y,{children:e.jsx(k,{className:"p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs(as,{className:"h-20 w-20",children:[e.jsx(Xs,{src:t.avatar_url||""}),e.jsx(is,{className:"text-2xl",children:t.full_name.charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-2xl font-bold mb-1",children:t.full_name}),e.jsx("p",{className:"text-muted-foreground mb-3",children:d[t.user_type]}),a&&a.total_reviews>0&&e.jsx(al,{score:Number(a.overall_score),totalReviews:a.total_reviews,showDetails:!0})]})]})})}),e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(ps,{className:"h-5 w-5"}),"Avis et réputation"]}),e.jsx(O,{children:"Consultez les avis laissés par d'autres utilisateurs"})]}),e.jsx(k,{children:e.jsxs(Be,{defaultValue:"all",className:"w-full",children:[e.jsxs($e,{className:"grid w-full grid-cols-3",children:[e.jsxs(re,{value:"all",children:["Tous (",(a==null?void 0:a.total_reviews)||0,")"]}),e.jsxs(re,{value:"tenant",children:[e.jsx(rs,{className:"h-4 w-4 mr-2"}),"Locataire (",(a==null?void 0:a.as_tenant_reviews)||0,")"]}),e.jsxs(re,{value:"landlord",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Propriétaire (",(a==null?void 0:a.as_landlord_reviews)||0,")"]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx(de,{value:"all",children:e.jsx(Ms,{userId:s,reviewType:"all"})}),e.jsx(de,{value:"tenant",children:e.jsx(Ms,{userId:s,reviewType:"as_tenant"})}),e.jsx(de,{value:"landlord",children:e.jsx(Ms,{userId:s,reviewType:"as_landlord"})})]})]})})]})]})}),e.jsx(ne,{})]})},nl=()=>{const{user:s,profile:t,loading:r}=le(),a=Ie();return i.useEffect(()=>{r||(s?(t==null?void 0:t.user_type)==="locataire"?a("/dashboard"):a("/ajouter-bien"):a("/auth?type=proprietaire&returnUrl=/ajouter-bien"))},[s,t,r,a]),e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(oe,{className:"h-8 w-8 animate-spin text-primary"})})},ll="Agence Nationale du Service Universel des Télécommunications/TIC",cl="ANSUT",ol="Ministère de la Transition Numérique et de la Digitalisation",yt="Mon Toit",dl={locataire:{border:"border-l-blue-600",iconBg:"bg-blue-600"},proprietaire:{border:"border-l-primary",iconBg:"bg-primary"},agence:{border:"border-l-secondary",iconBg:"bg-secondary"},all:{border:"border-l-secondary",iconBg:"bg-secondary"}},ml=[{value:"15,000+",label:"Dossiers créés",icon:Ee},{value:"0 FCFA",label:"Gratuit pour locataires",icon:ps},{value:"48h",label:"Vérification moyenne",icon:Ot}],ul=[{icon:es,title:"Dossier de Location Certifié",description:"Créez votre dossier en ligne avec vérification biométrique et obtenez une certification d'État reconnue par tous les propriétaires",microKpi:"Certification en 48h",target:"locataire",targetLabel:"Pour les locataires",ctaText:"Créer mon dossier",ctaLink:"/certification"},{icon:Ee,title:"Dossiers Pré-Vérifiés par l'État",description:"Recevez uniquement des candidatures avec dossiers complets vérifiés par le service public et score de fiabilité",microKpi:"Score de confiance 0-100",target:"proprietaire",targetLabel:"Pour les propriétaires",ctaText:"Publier une annonce",ctaLink:"/publier"},{icon:Bs,title:"Signature Électronique Sécurisée",description:"Bail numérique conforme à la loi ivoirienne avec signature électronique certifiée et paiements Mobile Money intégrés",microKpi:"Signature en 5 min",target:"all",targetLabel:"Pour tous",ctaText:"Voir l'exemple",ctaLink:"/legal"},{icon:Ye,title:"Tableau de Bord Professionnel",description:"Gérez votre portefeuille immobilier, suivez les loyers en temps réel et générez des rapports automatisés",microKpi:"Rapports instantanés",target:"agence",targetLabel:"Pour les agences",ctaText:"Découvrir",ctaLink:"/admin"}],xl=[{text:"Dossiers papier incomplets",icon:_e},{text:"Pas de vérification d'identité",icon:_e},{text:"Espèces et chèques non sécurisés",icon:_e},{text:"Litiges sans médiation",icon:_e},{text:"Risque de fraude documentaire",icon:_e}],hl=[{text:"Dossier numérique certifié par l'État",icon:K},{text:"Vérification biométrique et KYC",icon:K},{text:"Paiements Mobile Money tracés",icon:K},{text:"Médiation par service public",icon:K},{text:"Documents authentifiés par l'ANSUT",icon:K}],vr=i.memo(({kpi:s,index:t})=>{const r=s.icon;return e.jsxs("div",{className:"bg-white rounded-lg border-l-4 border-l-primary shadow-md p-6 flex items-center gap-4 hover:shadow-lg transition-all duration-300",role:"article","aria-label":`${s.label}: ${s.value}`,children:[e.jsx("div",{className:"bg-primary/10 p-3 rounded-full","aria-hidden":"true",children:e.jsx(r,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold text-foreground",children:s.value}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.label})]})]})});vr.displayName="KPICard";const br=i.memo(({feature:s,index:t})=>{const r=s.icon,a=dl[s.target],l=["apartment-visit","real-estate-agent","key-handover","co-ownership-meeting"][t];return e.jsxs("article",{style:{animationDelay:`${t*100}ms`},className:`bg-white rounded-lg border-l-4 ${a.border} shadow-md hover:shadow-2xl hover:scale-[1.02] hover:border-l-primary transition-all duration-300 p-8 flex flex-col animate-fade-in relative overflow-hidden group`,children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-32 overflow-hidden rounded-t-lg opacity-0 group-hover:opacity-100 transition-opacity duration-500",children:e.jsx(gs,{src:fs(l),alt:s.title,className:"w-full h-full object-cover scale-110 group-hover:scale-100 transition-transform duration-500",animate:!1})}),e.jsxs("div",{className:"relative z-10 group-hover:pt-8 transition-all duration-300",children:[e.jsx(z,{variant:"secondary",className:"mb-4 self-start text-xs",children:s.targetLabel}),e.jsx("div",{className:`${a.iconBg} p-3 rounded-full w-fit mb-4 group-hover:scale-110 transition-transform duration-300`,"aria-hidden":"true",children:e.jsx(r,{className:"h-8 w-8 text-white"})}),e.jsx("h3",{className:"text-xl font-bold mb-3 text-foreground",children:s.title}),e.jsx("div",{className:"mb-4",children:e.jsxs(z,{variant:"outline",className:"text-xs text-primary border-primary/30 bg-primary/5",children:["⚡ ",s.microKpi]})}),e.jsx("p",{className:"text-muted-foreground mb-6 flex-1 leading-relaxed",children:s.description}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(N,{asChild:!0,variant:"outline",size:"sm",className:"w-full",children:e.jsx(U,{to:s.ctaLink,children:s.ctaText})}),e.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[e.jsx(es,{className:"h-4 w-4 text-primary","aria-hidden":"true"}),e.jsx("span",{className:"text-xs text-primary font-semibold",children:"Service public"})]})]})]})]})});br.displayName="FeatureCard";const Vs=i.memo(({items:s,positive:t=!1})=>e.jsx("ul",{className:"space-y-4",role:"list",children:s.map((r,a)=>{const n=r.icon,l=t?"text-green-600":"text-destructive",c=t?"text-foreground font-medium":"text-muted-foreground";return e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(n,{className:`h-5 w-5 ${l} mt-0.5 flex-shrink-0`,"aria-hidden":"true"}),e.jsx("span",{className:c,children:r.text})]},a)})}));Vs.displayName="ComparisonList";const pl=()=>e.jsx("section",{className:"py-12 md:py-18 bg-gradient-to-b from-muted/30 to-background relative overflow-hidden","aria-labelledby":"features-heading",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-7xl relative z-10",children:[e.jsxs("header",{className:"text-center mb-16",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center gap-3 mb-6",children:[e.jsx("img",{src:Ka,alt:"Mon Toit - Dossier de location numérique certifié",className:"h-14 md:h-16"}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[e.jsx(z,{variant:"default",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-1.5 text-sm font-semibold",children:"🇨🇮 Service Public"}),e.jsx(z,{variant:"outline",className:"border-primary text-primary px-4 py-1.5 text-sm font-semibold",children:"Gratuit pour locataires"})]})]}),e.jsx("h2",{id:"features-heading",className:"text-4xl md:text-5xl font-bold mb-4 text-foreground tracking-tight",children:"Le dossier de location numérique certifié"}),e.jsx("p",{className:"text-muted-foreground text-xl max-w-2xl mx-auto mb-3 leading-relaxed",children:"Créez votre dossier en ligne, obtenez une certification d'État et trouvez votre logement en toute confiance"}),e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("p",{className:"text-sm text-primary font-semibold",children:"Un service de l'ANSUT"}),e.jsx("p",{className:"text-xs text-muted-foreground max-w-md",children:"Inspiré de DossierFacile (France) • Adapté au contexte ivoirien"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto mb-16",role:"region","aria-label":"Indicateurs du service",children:ml.map((s,t)=>e.jsx(vr,{kpi:s,index:t},t))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl mx-auto mb-16",children:ul.map((s,t)=>e.jsx(br,{feature:s,index:t},t))}),e.jsxs("div",{className:"max-w-5xl mx-auto mb-16",children:[e.jsxs("h3",{className:"text-3xl font-bold text-center mb-10 text-foreground",children:["Pourquoi choisir ",yt," ?"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-gray-100 rounded-lg p-8 shadow-sm",children:[e.jsxs("h4",{className:"text-xl font-bold mb-6 text-foreground flex items-center gap-2",children:[e.jsx(_e,{className:"h-6 w-6 text-destructive","aria-hidden":"true"}),"Location traditionnelle"]}),e.jsx(Vs,{items:xl})]}),e.jsx("div",{className:"bg-white rounded-lg p-8 shadow-lg border-2 border-primary/20 relative overflow-hidden",children:e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h4",{className:"text-xl font-bold text-foreground flex items-center gap-2",children:[e.jsx(K,{className:"h-6 w-6 text-green-600","aria-hidden":"true"}),"Avec ",yt]}),e.jsxs(z,{className:"bg-blue-600 text-white border-0",children:[e.jsx(Y,{className:"h-3 w-3 mr-1","aria-hidden":"true"}),"Service Public"]})]}),e.jsx(Vs,{items:hl,positive:!0})]})})]})]}),e.jsx("div",{className:"max-w-4xl mx-auto mb-16 bg-blue-50 border border-blue-200 rounded-xl p-8",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(Y,{className:"h-8 w-8 text-blue-600 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold mb-3 text-foreground",children:"Un vrai service public"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(K,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Gratuit pour tous les locataires"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(K,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Aucune revente de données"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(K,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Hébergement en Côte d'Ivoire"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(K,{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"Conformité RGPD et loi ivoirienne"})]})]})]})]})}),e.jsxs("div",{className:"max-w-5xl mx-auto mb-16",children:[e.jsx("h3",{className:"text-3xl font-bold text-center mb-10 text-foreground",children:"Tarification transparente"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"relative bg-gradient-to-br from-blue-50 to-white rounded-lg p-8 shadow-md border-2 border-blue-200 md:scale-105",children:[e.jsx("div",{className:"absolute -top-3 -right-3",children:e.jsx(z,{className:"bg-secondary text-white border-0 px-3 py-1 text-xs font-bold",children:"⭐ RECOMMANDÉ"})}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-600 p-3 rounded-full",children:e.jsx(Ee,{className:"h-6 w-6 text-white"})}),e.jsx("h4",{className:"text-2xl font-bold text-foreground",children:"Locataires"})]}),e.jsx(z,{className:"bg-green-600 text-white border-0 text-lg px-4 py-1",children:"0 FCFA"})]}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Toutes les fonctionnalités pour trouver votre logement"}),e.jsxs("ul",{className:"space-y-3 mb-6",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-foreground",children:"Création de dossier gratuite"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-foreground",children:"Vérification ANSUT gratuite"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-foreground",children:"Candidatures illimitées"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-foreground",children:"Support client gratuit"})]})]}),e.jsx(N,{asChild:!0,className:"w-full bg-secondary hover:bg-secondary/90 text-white font-bold mb-4",children:e.jsxs(U,{to:"/verification",children:[e.jsx(ca,{className:"h-4 w-4 mr-2"}),"Créer mon dossier gratuit"]})}),e.jsx("div",{className:"pt-4 border-t border-blue-200",children:e.jsx("p",{className:"text-xs text-muted-foreground",children:"💡 Financé par l'ANSUT dans le cadre du service universel"})})]}),e.jsxs("div",{className:"bg-white rounded-lg p-8 shadow-lg border-2 border-primary/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-primary p-3 rounded-full",children:e.jsx(Ye,{className:"h-6 w-6 text-white"})}),e.jsx("h4",{className:"text-2xl font-bold text-foreground",children:"Propriétaires"})]}),e.jsx(z,{variant:"outline",className:"border-primary text-primary text-lg px-4 py-1 font-bold",children:"5%"})]}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Commission uniquement sur signature de bail réussie"}),e.jsxs("ul",{className:"space-y-3 mb-6",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-foreground",children:"Publication illimitée de biens"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-foreground",children:"Dossiers pré-vérifiés par l'État"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-foreground",children:"Signature électronique + Mobile Money"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-primary mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-foreground",children:"Médiation en cas de litige"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-muted",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"💰 Commission prélevée uniquement à la signature du bail"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"📊 Agences : tarifs dégressifs sur devis"})]})]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx(N,{asChild:!0,variant:"outline",size:"lg",children:e.jsx(U,{to:"/tarifs",children:"Voir tous les détails tarifaires"})})})]}),e.jsxs("div",{className:"text-center mt-16 bg-gradient-to-br from-primary/5 to-secondary/5 rounded-2xl p-10 border border-primary/10",children:[e.jsx("h3",{className:"text-2xl md:text-3xl font-bold mb-4 text-foreground",children:"Créez votre dossier de location en ligne"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-2xl mx-auto",children:"Création de dossier gratuite pour les locataires. Propriétaires : commission uniquement sur signature de bail réussie."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-6 max-w-md mx-auto",children:[e.jsx(N,{asChild:!0,size:"lg",className:"flex-1",children:e.jsx(U,{to:"/verification",children:"Créer mon dossier"})}),e.jsx(N,{asChild:!0,variant:"outline",size:"lg",className:"flex-1",children:e.jsx(U,{to:"/certification",children:"Comment ça marche ?"})})]}),e.jsxs("div",{className:"space-y-2 pt-4 border-t border-muted",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Un service de l'",e.jsx("span",{className:"font-semibold",children:cl})," • Conforme à la loi ivoirienne 2013-450"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[ll," • Sous tutelle du ",ol]})]})]})]})}),fl=[{name:"Kouadio Marc",role:"Locataire certifié ANSUT",location:"Cocody, Abidjan",content:"J'ai trouvé mon appartement en 48h grâce à ma certification ANSUT. Les propriétaires me répondaient immédiatement car mon dossier était déjà complet et vérifié. Un gain de temps incroyable !",rating:5,avatar:"KM",avatarGradient:"bg-gradient-to-br from-blue-600 to-blue-700",isCertified:!0},{name:"Adjoua Sarah",role:"Propriétaire",location:"Marcory, Abidjan",content:"Fini les dossiers incomplets et les vérifications interminables. Avec Mon Toit, je ne reçois que des candidatures sérieuses et certifiées. Le paiement Mobile Money est un vrai plus pour mes locataires.",rating:5,avatar:"AS",avatarGradient:"bg-gradient-to-br from-primary to-orange-600",isCertified:!1},{name:"Immobilier Plus SARL",role:"Agence immobilière",location:"Plateau, Abidjan",content:"Le tableau de bord agence nous permet de gérer 50+ propriétés efficacement. Les contrats digitaux et le suivi des paiements nous font gagner des heures chaque semaine. Un outil professionnel indispensable.",rating:5,avatar:"IP",avatarGradient:"bg-gradient-to-br from-primary to-primary",isCertified:!1}],gl=()=>{const s=i.useRef(ni({delay:5e3,stopOnInteraction:!0}));return e.jsx("section",{className:"py-16 md:py-20 bg-gradient-to-b from-gray-50 to-white relative overflow-hidden",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-7xl relative z-10",children:[e.jsx("div",{className:"mb-12",children:e.jsxs("div",{className:"relative h-64 rounded-2xl overflow-hidden shadow-xl",children:[e.jsx(gs,{src:fs("key-handover"),alt:"Remise de clés réussie",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-black/70 to-transparent flex items-center",children:e.jsxs("div",{className:"text-white p-8 max-w-xl",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-2",children:"Ils ont trouvé leur toit"}),e.jsx("p",{className:"text-lg opacity-90",children:"Des milliers de locataires satisfaits grâce à Mon Toit"})]})})]})}),e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-4 text-foreground",children:"Témoignages"}),e.jsx("p",{className:"text-muted-foreground text-lg max-w-2xl mx-auto",children:"Découvrez les témoignages de notre communauté d'utilisateurs satisfaits"})]}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-12",children:e.jsxs(xi,{opts:{align:"center",loop:!0},plugins:[s.current],className:"w-full",children:[e.jsx(hi,{children:fl.map((t,r)=>e.jsx(pi,{children:e.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50/50 rounded-lg p-8 md:p-12 shadow-lg border border-primary/10 relative transition-all duration-250 ease-in-out hover:shadow-xl hover:scale-[1.02] cursor-pointer",children:[e.jsx(oa,{className:"absolute top-6 right-6 h-12 w-12 text-primary/10"}),t.isCertified&&e.jsxs("div",{className:"absolute top-6 left-6 inline-flex items-center gap-1.5 bg-primary/10 text-primary border border-primary/20 px-3 py-1.5 rounded-full text-xs font-semibold",children:[e.jsx(es,{className:"h-3.5 w-3.5"}),"Certifié ANSUT"]}),e.jsx("div",{className:`flex gap-1 ${t.isCertified?"mt-8":""} mb-6`,children:Array.from({length:t.rating}).map((a,n)=>e.jsx(ls,{className:"h-5 w-5 fill-primary text-primary"},n))}),e.jsxs("p",{className:"text-lg md:text-xl text-foreground leading-relaxed mb-8 relative z-10",children:['"',t.content,'"']}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-14 h-14 rounded-full ${t.avatarGradient} flex items-center justify-center text-white font-bold text-lg shadow-md`,children:t.avatar}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-foreground",children:t.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t.role}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(Ze,{className:"h-3 w-3"}),t.location]})]})]})]})},r))}),e.jsx(fi,{className:"hidden md:flex"}),e.jsx(gi,{className:"hidden md:flex"})]})}),e.jsx("div",{className:"max-w-4xl mx-auto mt-16 text-center",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3",children:[e.jsx(N,{asChild:!0,size:"lg",variant:"default",children:e.jsx(U,{to:"/auth",children:"Rejoindre la communauté"})}),e.jsx(N,{asChild:!0,size:"lg",variant:"outline",children:e.jsx(U,{to:"/certification",children:"En savoir plus"})})]})})]})})},jl=()=>e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ie,{}),e.jsx("main",{className:"flex-1 pt-24",children:e.jsxs("div",{className:"container mx-auto px-4 py-10",children:[e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"relative mb-12",children:[e.jsx(hr,{}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h1",{className:"text-h1 text-center mb-4",children:[e.jsx("span",{className:"text-gradient-primary",children:"À propos"})," de Mon Toit"]}),e.jsx("p",{className:"text-xl text-muted-foreground text-center",children:"La plateforme de confiance pour l'immobilier en Côte d'Ivoire"})]})]}),e.jsxs("div",{className:"prose prose-lg max-w-none mb-12",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Mon Toit"})," est une plateforme innovante propulsée par ",e.jsx("strong",{children:"ANSUT"}),"(Agence Nationale du Service Universel des Télécommunications/TIC), dédiée à révolutionner le marché immobilier ivoirien."]}),e.jsx("p",{children:"Notre mission est de créer un environnement sécurisé, transparent et efficace pour tous les acteurs de l'immobilier : locataires, propriétaires et agences."})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6 mb-12",children:[e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(Y,{className:"h-10 w-10 text-primary mb-2"}),e.jsx(E,{children:"Sécurité garantie"})]}),e.jsx(k,{children:"Vérification d'identité (ONECI, CNAM), certification ANSUT des baux, et paiements sécurisés via Mobile Money."})]}),e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(Ee,{className:"h-10 w-10 text-primary mb-2"}),e.jsx(E,{children:"Confiance mutuelle"})]}),e.jsx(k,{children:"Système de notation et d'avis vérifiés pour locataires et propriétaires."})]}),e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(ps,{className:"h-10 w-10 text-primary mb-2"}),e.jsx(E,{children:"Conformité légale"})]}),e.jsx(k,{children:"Conforme à la loi ivoirienne 2013-450 sur la protection des données et aux réglementations immobilières."})]}),e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(Ye,{className:"h-10 w-10 text-primary mb-2"}),e.jsx(E,{children:"Innovation continue"})]}),e.jsx(k,{children:"Visites virtuelles 360°, recommandations IA, et outils d'analyse pour propriétaires."})]})]}),e.jsx(y,{className:"bg-primary text-primary-foreground",children:e.jsxs(k,{className:"pt-6",children:[e.jsx("h3",{className:"text-2xl font-bold mb-4",children:"Nos valeurs"}),e.jsxs("ul",{className:"space-y-2",children:[e.jsxs("li",{children:["✓ ",e.jsx("strong",{children:"Transparence"})," : Informations claires et vérifiables"]}),e.jsxs("li",{children:["✓ ",e.jsx("strong",{children:"Sécurité"})," : Protection des données et des transactions"]}),e.jsxs("li",{children:["✓ ",e.jsx("strong",{children:"Accessibilité"})," : Plateforme simple et intuitive"]}),e.jsxs("li",{children:["✓ ",e.jsx("strong",{children:"Innovation"})," : Technologies de pointe au service de tous"]})]})]})})]}),e.jsxs("div",{className:"my-20",children:[e.jsxs("h2",{className:"text-h2 text-center mb-12",children:["Nos ",e.jsx("span",{className:"text-gradient-secondary",children:"fonctionnalités"})]}),e.jsx(pl,{})]}),e.jsxs("div",{className:"my-20",children:[e.jsxs("h2",{className:"text-h2 text-center mb-12",children:["Ce que disent nos ",e.jsx("span",{className:"text-gradient-secondary",children:"utilisateurs"})]}),e.jsx(gl,{})]})]})}),e.jsx(ne,{})]}),tt=({title:s,lastUpdated:t,children:r})=>e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ie,{}),e.jsx("main",{className:"flex-1 pt-16",children:e.jsx("div",{className:"container mx-auto px-4 py-10",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:s}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-8",children:["Dernière mise à jour : ",t]}),e.jsx("div",{className:"prose prose-lg max-w-none",children:r})]})})}),e.jsx(ne,{})]}),vl=()=>e.jsxs(tt,{title:"Conditions d'utilisation",lastUpdated:"5 octobre 2025",children:[e.jsx("h2",{children:"1. Objet"}),e.jsx("p",{children:"Les présentes Conditions Générales d'Utilisation (CGU) régissent l'accès et l'utilisation de la plateforme Mon Toit propulsée par ANSUT."}),e.jsx("h2",{children:"2. Inscription"}),e.jsx("p",{children:"L'utilisation complète de la plateforme nécessite la création d'un compte. Vous devez fournir des informations exactes et à jour."}),e.jsx("h2",{children:"3. Vérification d'identité"}),e.jsx("p",{children:"La plateforme utilise les services ONECI et CNAM pour vérifier l'identité des utilisateurs, conformément à la réglementation ivoirienne."}),e.jsx("h2",{children:"4. Obligations des utilisateurs"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Propriétaires : publier des annonces véridiques et conformes"}),e.jsx("li",{children:"Locataires : respecter les biens loués et honorer les paiements"}),e.jsx("li",{children:"Tous : respecter la législation en vigueur"})]}),e.jsx("h2",{children:"5. Responsabilité"}),e.jsx("p",{children:"Mon Toit agit en qualité d'intermédiaire. La responsabilité des transactions incombe aux parties (locataire/propriétaire)."}),e.jsx("h2",{children:"6. Modification des CGU"}),e.jsx("p",{children:"Mon Toit se réserve le droit de modifier ces CGU à tout moment. Les utilisateurs seront notifiés par email."})]}),bl=()=>e.jsxs(tt,{title:"Politique de confidentialité",lastUpdated:"5 octobre 2025",children:[e.jsx("h2",{children:"1. Collecte des données"}),e.jsx("p",{children:"Mon Toit collecte les données personnelles suivantes :"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Données d'identification (nom, prénom, email, téléphone)"}),e.jsx("li",{children:"Données de vérification (ONECI, CNAM, photo faciale)"}),e.jsx("li",{children:"Données de navigation (logs, cookies)"})]}),e.jsx("h2",{children:"2. Utilisation des données"}),e.jsx("p",{children:"Vos données sont utilisées pour :"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Créer et gérer votre compte"}),e.jsx("li",{children:"Vérifier votre identité (sécurité)"}),e.jsx("li",{children:"Faciliter les transactions immobilières"}),e.jsx("li",{children:"Améliorer nos services"})]}),e.jsx("h2",{children:"3. Partage des données"}),e.jsx("p",{children:"Vos données ne sont jamais vendues. Elles peuvent être partagées avec :"}),e.jsxs("ul",{children:[e.jsx("li",{children:"ANSUT (pour certification des baux)"}),e.jsx("li",{children:"Partenaires de paiement (Mobile Money)"}),e.jsx("li",{children:"Autorités légales (sur demande judiciaire)"})]}),e.jsx("h2",{children:"4. Sécurité"}),e.jsx("p",{children:"Nous utilisons le chiffrement SSL, l'authentification sécurisée, et des sauvegardes régulières pour protéger vos données."}),e.jsx("h2",{children:"5. Vos droits"}),e.jsx("p",{children:"Conformément à la loi 2013-450, vous pouvez :"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Accéder à vos données"}),e.jsx("li",{children:"Rectifier vos informations"}),e.jsx("li",{children:"Supprimer votre compte"}),e.jsx("li",{children:"Vous opposer au traitement"})]}),e.jsx("h2",{children:"6. Contact"}),e.jsxs("p",{children:["Pour toute question : ",e.jsx("a",{href:"mailto:privacy@montoit.ci",children:"privacy@montoit.ci"})]})]}),Nl=()=>e.jsxs(tt,{title:"Mentions légales",lastUpdated:"5 octobre 2025",children:[e.jsx("h2",{children:"Éditeur du site"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Mon Toit"}),e.jsx("br",{}),"Plateforme propulsée par ANSUT",e.jsx("br",{}),"(Agence Nationale de Sécurisation des Transactions)",e.jsx("br",{}),"Abidjan, Côte d'Ivoire"]}),e.jsx("h2",{children:"Directeur de publication"}),e.jsx("p",{children:"[Nom du Directeur Général d'ANSUT]"}),e.jsx("h2",{children:"Hébergement"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Lovable Cloud"}),e.jsx("br",{}),"Infrastructure cloud sécurisée"]}),e.jsx("h2",{children:"Propriété intellectuelle"}),e.jsx("p",{children:"L'ensemble du contenu de ce site (textes, images, logos, code source) est la propriété exclusive de Mon Toit / ANSUT."}),e.jsx("h2",{children:"Crédits"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Logo Mon Toit : ANSUT"}),e.jsx("li",{children:"Framework : React + TypeScript"}),e.jsx("li",{children:"UI : shadcn/ui + Tailwind CSS"}),e.jsx("li",{children:"Backend : Lovable Cloud"})]}),e.jsx("h2",{children:"Contact"}),e.jsxs("p",{children:["Email : ",e.jsx("a",{href:"mailto:contact@montoit.ci",children:"contact@montoit.ci"}),e.jsx("br",{}),"Téléphone : +225 27 XX XX XX XX"]})]}),yl=({score:s,breakdown:t,recommendation:r})=>{const a=l=>{const c={approved:{variant:"default",label:"✓ Recommandé"},conditional:{variant:"secondary",label:"~ Conditionnel"},rejected:{variant:"destructive",label:"✗ Non recommandé"}},{variant:o,label:d}=c[l];return e.jsx(z,{variant:o,children:d})},n=t?[{icon:Y,label:"Vérification identité ONECI",score:t.identity_verification,max:40,color:"text-blue-600"},{icon:rs,label:"Vérification faciale",score:t.face_verification,max:30,color:"text-green-600"},{icon:Re,label:"Documents fournis",score:t.documents,max:20,color:"text-warning"},{icon:Bt,label:"Historique de paiements",score:t.payment_history,max:10,color:"text-orange-600"}]:[];return e.jsxs(y,{className:"border-primary/20 bg-gradient-to-br from-primary/5 to-transparent",children:[e.jsxs(P,{children:[e.jsx(E,{children:"Évaluation automatique"}),e.jsx(O,{children:"Score de fiabilité calculé automatiquement"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-background rounded-lg border",children:[e.jsx("span",{className:"font-medium",children:"Score du candidat"}),e.jsx(st,{score:s,size:"lg"})]}),r&&e.jsxs("div",{className:"flex items-center justify-between p-4 bg-background rounded-lg border",children:[e.jsx("span",{className:"font-medium",children:"Recommandation"}),a(r)]}),t&&e.jsxs("div",{className:"space-y-2 mt-4 p-4 bg-background rounded-lg border",children:[e.jsx("p",{className:"text-sm font-semibold mb-3",children:"Détails de l'évaluation:"}),n.map((l,c)=>{const o=l.icon,d=l.score/l.max*100;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(o,{className:`h-4 w-4 ${l.color}`}),e.jsx("span",{className:"text-muted-foreground",children:l.label})]}),e.jsxs("span",{className:"font-medium",children:[l.score,"/",l.max," pts"]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-500",style:{width:`${d}%`}})})]},c)})]})]})]})},wl=({onUpdate:s})=>{const[t,r]=i.useState([]),[a,n]=i.useState(!0),[l,c]=i.useState({}),[o,d]=i.useState("all"),[h,m]=i.useState("priority");i.useEffect(()=>{j()},[o,h]);const x=u=>{if(!u.processing_deadline)return{color:"default",label:"⏳ En attente",badge:null,shouldPulse:!1};const g=new Date,S=(new Date(u.processing_deadline).getTime()-g.getTime())/(1e3*60*60);return u.is_overdue?{color:"destructive",label:`🔴 EN RETARD (${Math.abs(Math.round(S))}h)`,badge:"URGENT",shouldPulse:!0}:S<24?{color:"warning",label:"🟡 < 24h restantes",badge:"ATTENTION",shouldPulse:!1}:S<48?{color:"secondary",label:"🟡 < 48h restantes",badge:null,shouldPulse:!1}:{color:"default",label:"🟢 Dans les délais",badge:null,shouldPulse:!1}},j=async()=>{n(!0);try{let u=w.from("rental_applications").select(`
          *,
          profiles!rental_applications_applicant_id_fkey (full_name, avatar_url),
          properties (title, address, city)
        `).eq("status","pending");if(o==="urgent")u=u.eq("is_overdue",!0);else if(o==="soon"){const S=new Date(Date.now()+1728e5).toISOString();u=u.eq("is_overdue",!1).lte("processing_deadline",S)}else if(o==="normal"){const S=new Date(Date.now()+1728e5).toISOString();u=u.gt("processing_deadline",S)}h==="priority"?u=u.order("is_overdue",{ascending:!1}).order("processing_deadline",{ascending:!0}):h==="date"?u=u.order("created_at",{ascending:!0}):h==="score"&&(u=u.order("application_score",{ascending:!1}));const{data:g,error:C}=await u;if(C)throw C;r(g||[])}catch{I({title:"Erreur",description:"Impossible de charger les dossiers",variant:"destructive"})}finally{n(!1)}},p=async(u,g,C)=>{const{error:S}=await w.from("rental_applications").update({status:g,reviewed_at:new Date().toISOString()}).eq("id",u);if(S){I({title:"Erreur",description:"Impossible de mettre à jour le dossier",variant:"destructive"});return}I({title:"Succès",description:`Dossier ${g==="approved"?"validé":"rejeté"} avec succès`}),j(),s==null||s()};return a?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center flex-wrap",children:[e.jsxs(fe,{value:o,onValueChange:u=>d(u),children:[e.jsx(ge,{className:"w-[200px]",children:e.jsx(je,{})}),e.jsxs(ve,{children:[e.jsx(M,{value:"all",children:"📋 Tous les dossiers"}),e.jsx(M,{value:"urgent",children:"🔴 Urgents (en retard)"}),e.jsx(M,{value:"soon",children:"🟡 Bientôt urgents (< 48h)"}),e.jsx(M,{value:"normal",children:"🟢 Dans les délais"})]})]}),e.jsxs(fe,{value:h,onValueChange:u=>m(u),children:[e.jsx(ge,{className:"w-[180px]",children:e.jsx(je,{})}),e.jsxs(ve,{children:[e.jsx(M,{value:"priority",children:"🔥 Par priorité"}),e.jsx(M,{value:"date",children:"📅 Par date"}),e.jsx(M,{value:"score",children:"⭐ Par score"})]})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[t.length," dossier",t.length>1?"s":""]})]}),t.length===0?e.jsx(y,{children:e.jsx(k,{className:"p-12 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Aucun dossier correspondant aux critères"})})}):e.jsx("div",{className:"space-y-4",children:t.map(u=>{const g=x(u);return e.jsxs(y,{className:`${g.color==="destructive"?"border-destructive border-2":""} ${g.shouldPulse?"animate-pulse":""}`,children:[e.jsxs(P,{children:[e.jsxs("div",{className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[e.jsx(E,{className:"text-xl",children:u.profiles.full_name}),g.badge&&e.jsx(z,{variant:"destructive",className:"font-bold",children:g.badge})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[u.properties.title," • ",u.properties.city]})]}),e.jsxs("div",{className:"flex flex-col gap-2 items-end",children:[e.jsx(z,{variant:g.color,children:g.label}),u.processing_deadline&&e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx(qe,{className:"h-3 w-3"}),e.jsxs("span",{children:["Limite : ",new Date(u.processing_deadline).toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})]})]})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["Soumis le ",new Date(u.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs(k,{className:"space-y-6",children:[u.application_score>0&&e.jsx(yl,{score:u.application_score,breakdown:{identity_verification:20,face_verification:15,payment_history:20,documents:25,profile_completeness:20},recommendation:u.application_score>=70?"approved":u.application_score>=50?"conditional":"rejected"}),u.cover_letter&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Lettre de motivation"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:u.cover_letter})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Notes de validation"}),e.jsx(sr,{placeholder:"Ajoutez des notes concernant ce dossier...",value:l[u.id]||"",onChange:C=>c({...l,[u.id]:C.target.value})})]}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsxs(N,{onClick:()=>p(u.id,"approved"),className:"flex-1 min-w-[150px]",children:[e.jsx(K,{className:"mr-2 h-4 w-4"}),"Valider"]}),e.jsxs(N,{variant:"outline",onClick:()=>p(u.id,"pending",l[u.id]),className:"flex-1 min-w-[150px]",children:[e.jsx(Ve,{className:"mr-2 h-4 w-4"}),"Demander compléments"]}),e.jsxs(N,{variant:"destructive",onClick:()=>p(u.id,"rejected",l[u.id]),className:"flex-1 min-w-[150px]",children:[e.jsx(Fe,{className:"mr-2 h-4 w-4"}),"Rejeter"]})]})]})]},u.id)})})]})},Cl=()=>{const[s,t]=i.useState([]),[r,a]=i.useState(!0);i.useEffect(()=>{n()},[]);const n=async()=>{a(!0);try{const{data:c,error:o}=await w.rpc("get_verifications_for_review");o?(T.error("Error fetching verifications for review",{error:o}),I({title:"Erreur",description:"Impossible de charger les vérifications en attente",variant:"destructive"})):t(c||[])}catch(c){T.error("Exception fetching verifications",{error:c})}finally{a(!1)}},l=c=>{switch(c){case"verified":return e.jsxs(z,{variant:"default",className:"bg-green-600",children:[e.jsx(K,{className:"w-3 h-3 mr-1"}),"Vérifié"]});case"pending_review":return e.jsxs(z,{variant:"secondary",children:[e.jsx(qe,{className:"w-3 h-3 mr-1"}),"En révision"]});case"rejected":return e.jsxs(z,{variant:"destructive",children:[e.jsx(Fe,{className:"w-3 h-3 mr-1"}),"Rejeté"]});default:return e.jsx(z,{variant:"outline",children:c})}};return r?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(oe,{className:"h-8 w-8 animate-spin"})}):s.length===0?e.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"Aucune vérification en attente de révision"}):e.jsx("div",{className:"space-y-4",children:s.map(c=>e.jsxs(y,{children:[e.jsx(P,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(E,{className:"text-lg",children:c.full_name}),e.jsxs(O,{children:[c.user_type," • ",c.city||"Ville non renseignée"]})]}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>{I({title:"Fonction à venir",description:"La vue détaillée sera disponible prochainement"})},children:"Voir détails"})]})}),e.jsxs(k,{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Vérification ONECI"}),l(c.oneci_status),c.oneci_verified_at&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Vérifié le ",new Date(c.oneci_verified_at).toLocaleDateString("fr-FR")]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1",children:"Vérification CNAM"}),l(c.cnam_status),c.cnam_verified_at&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Vérifié le ",new Date(c.cnam_verified_at).toLocaleDateString("fr-FR")]})]})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Dossier créé le ",new Date(c.created_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-blue-900 dark:text-blue-100",children:[e.jsx("strong",{children:"🔒 Sécurité :"})," Les numéros CNI et de sécurité sociale ne sont jamais affichés pour protéger la vie privée des utilisateurs."]})})]})]},c.user_id))})},Sl=()=>{const{user:s,hasRole:t,loading:r}=le(),[a,n]=i.useState({validated:0,pending:0,rejected:0,urgent:0,avgProcessingTime:0});i.useEffect(()=>{s&&t("tiers_de_confiance")&&l()},[s,t]);const l=async()=>{const{count:c}=await w.from("rental_applications").select("*",{count:"exact",head:!0}).eq("status","approved"),{count:o}=await w.from("rental_applications").select("*",{count:"exact",head:!0}).eq("status","pending"),{count:d}=await w.from("rental_applications").select("*",{count:"exact",head:!0}).eq("status","rejected"),{count:h}=await w.from("rental_applications").select("*",{count:"exact",head:!0}).eq("status","pending").eq("is_overdue",!0),{data:m}=await w.from("rental_applications").select("created_at, reviewed_at").not("reviewed_at","is",null).limit(100);let x=0;if(m&&m.length>0){const j=m.reduce((p,u)=>{const g=new Date(u.reviewed_at).getTime()-new Date(u.created_at).getTime();return p+g},0);x=Math.round(j/(m.length*1e3*60*60))}n({validated:c||0,pending:o||0,rejected:d||0,urgent:h||0,avgProcessingTime:x})};return r?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):t("tiers_de_confiance")?e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ie,{}),e.jsxs("main",{className:"flex-1 container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-4xl font-bold mb-8",children:"Espace Tiers de Confiance"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsxs(y,{className:"border-destructive",children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(E,{className:"text-sm font-medium",children:"🔴 Urgents"}),e.jsx(Ve,{className:"h-4 w-4 text-destructive"})]}),e.jsxs(k,{children:[e.jsx("div",{className:"text-2xl font-bold text-destructive",children:a.urgent}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"En retard"})]})]}),e.jsxs(y,{children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(E,{className:"text-sm font-medium",children:"En Attente"}),e.jsx(qe,{className:"h-4 w-4 text-orange-600"})]}),e.jsx(k,{children:e.jsx("div",{className:"text-2xl font-bold",children:a.pending})})]}),e.jsxs(y,{children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(E,{className:"text-sm font-medium",children:"Validés"}),e.jsx(K,{className:"h-4 w-4 text-green-600"})]}),e.jsx(k,{children:e.jsx("div",{className:"text-2xl font-bold",children:a.validated})})]}),e.jsxs(y,{children:[e.jsxs(P,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(E,{className:"text-sm font-medium",children:"Temps Moyen"}),e.jsx(qe,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(k,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[a.avgProcessingTime,"h"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"De traitement"})]})]})]}),e.jsxs(Be,{defaultValue:"verifications",className:"space-y-4",children:[e.jsxs($e,{children:[e.jsx(re,{value:"verifications",children:"Vérifications d'identité"}),e.jsx(re,{value:"dossiers",children:"Dossiers de location"}),e.jsx(re,{value:"history",children:"Historique"})]}),e.jsx(de,{value:"verifications",children:e.jsxs(y,{children:[e.jsx(P,{children:e.jsx(E,{children:"Vérifications ONECI et CNAM en attente"})}),e.jsx(k,{children:e.jsx(Cl,{})})]})}),e.jsx(de,{value:"dossiers",children:e.jsxs(y,{children:[e.jsx(P,{children:e.jsx(E,{children:"Validation des dossiers de location"})}),e.jsx(k,{children:e.jsx(wl,{onUpdate:l})})]})}),e.jsx(de,{value:"history",children:e.jsxs(y,{children:[e.jsx(P,{children:e.jsx(E,{children:"Historique des validations"})}),e.jsx(k,{children:e.jsx("p",{className:"text-muted-foreground",children:"Fonctionnalité à venir"})})]})})]})]}),e.jsx(ne,{})]}):e.jsx(Us,{to:"/",replace:!0})},Ue=ua,G=i.forwardRef(({className:s,...t},r)=>e.jsx(da,{ref:r,className:te("border-b",s),...t}));G.displayName="AccordionItem";const H=i.forwardRef(({className:s,children:t,...r},a)=>e.jsx(ma,{className:"flex",children:e.jsxs($t,{ref:a,className:te("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",s),...r,children:[t,e.jsx(Os,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));H.displayName=$t.displayName;const Q=i.forwardRef(({className:s,children:t,...r},a)=>e.jsx(Gt,{ref:a,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:e.jsx("div",{className:te("pb-4 pt-0",s),children:t})}));Q.displayName=Gt.displayName;const _l=()=>e.jsxs(e.Fragment,{children:[e.jsx(ie,{}),e.jsx("div",{className:"container mx-auto px-4 py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-secondary/10 rounded-full mb-4",children:e.jsx(Y,{className:"h-8 w-8 text-secondary"})}),e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"FAQ - Certification ANSUT"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Tout ce que vous devez savoir sur la certification des baux immobiliers"})]}),e.jsx(y,{className:"mb-8",children:e.jsx(k,{className:"p-6",children:e.jsxs(Ue,{type:"single",collapsible:!0,className:"w-full",children:[e.jsxs(G,{value:"what-is",children:[e.jsx(H,{className:"text-left",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-secondary"}),"Qu'est-ce que la certification ANSUT ?"]})}),e.jsx(Q,{className:"text-muted-foreground",children:"La certification ANSUT est un label de qualité délivré par l'Agence Nationale de Sécurité et d'Urbanisme du Territoire. Elle garantit que votre bail immobilier respecte toutes les normes légales ivoiriennes et que les parties ont été correctement vérifiées. Un bail certifié ANSUT offre une protection juridique renforcée et facilite les démarches administratives."})]}),e.jsxs(G,{value:"why-certify",children:[e.jsx(H,{className:"text-left",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-green-600"}),"Pourquoi faire certifier mon bail ?"]})}),e.jsx(Q,{className:"text-muted-foreground",children:e.jsxs("ul",{className:"list-disc pl-5 space-y-2",children:[e.jsx("li",{children:"Protection juridique maximale en cas de litige"}),e.jsx("li",{children:"Reconnaissance officielle par les autorités"}),e.jsx("li",{children:"Facilite l'accès aux assurances habitation"}),e.jsx("li",{children:"Augmente la confiance entre propriétaire et locataire"}),e.jsx("li",{children:"Simplifie les démarches administratives"}),e.jsx("li",{children:"Badge de qualité visible sur la plateforme"})]})})]}),e.jsxs(G,{value:"duration",children:[e.jsx(H,{className:"text-left",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"h-5 w-5 text-primary"}),"Combien de temps prend la certification ?"]})}),e.jsx(Q,{className:"text-muted-foreground",children:"Le processus de certification prend généralement entre 2 et 5 jours ouvrables. Ce délai peut varier selon la complexité du dossier et la charge de travail des agents ANSUT. Vous recevrez une notification par email dès que votre demande sera examinée et traitée."})]}),e.jsxs(G,{value:"requirements",children:[e.jsx(H,{className:"text-left",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-5 w-5 text-blue-600"}),"Quelles sont les conditions requises ?"]})}),e.jsxs(Q,{className:"text-muted-foreground",children:["Pour qu'un bail soit éligible à la certification ANSUT, les conditions suivantes doivent être remplies :",e.jsxs("ul",{className:"list-disc pl-5 mt-2 space-y-1",children:[e.jsx("li",{children:"Le bail doit être signé par le propriétaire ET le locataire"}),e.jsx("li",{children:"Les deux parties doivent avoir leur identité vérifiée (ONECI)"}),e.jsx("li",{children:"Un document PDF du contrat doit être généré"}),e.jsx("li",{children:"Les dates de début et fin doivent être cohérentes"}),e.jsx("li",{children:"Les montants (loyer, caution) doivent être valides"})]})]})]}),e.jsxs(G,{value:"rejection",children:[e.jsx(H,{className:"text-left",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-5 w-5 text-destructive"}),"Que faire si ma demande est rejetée ?"]})}),e.jsxs(Q,{className:"text-muted-foreground",children:["Si votre demande de certification est rejetée, vous recevrez un email détaillant les raisons du rejet. Les motifs courants incluent :",e.jsxs("ul",{className:"list-disc pl-5 mt-2 space-y-1",children:[e.jsx("li",{children:"Documents incomplets ou non conformes"}),e.jsx("li",{children:"Informations contradictoires dans le bail"}),e.jsx("li",{children:"Vérifications d'identité incomplètes"}),e.jsx("li",{children:"Non-respect des normes légales"})]}),e.jsx("p",{className:"mt-2",children:"Vous pouvez corriger les problèmes mentionnés et soumettre une nouvelle demande sans frais supplémentaires."})]})]}),e.jsxs(G,{value:"cost",children:[e.jsx(H,{className:"text-left",children:"Combien coûte la certification ?"}),e.jsx(Q,{className:"text-muted-foreground",children:"La certification ANSUT est actuellement gratuite pour tous les utilisateurs de la plateforme Mon Toit. C'est un service inclus pour garantir la sécurité et la légalité de toutes les transactions immobilières sur notre plateforme."})]}),e.jsxs(G,{value:"validity",children:[e.jsx(H,{className:"text-left",children:"Quelle est la durée de validité de la certification ?"}),e.jsx(Q,{className:"text-muted-foreground",children:"La certification ANSUT est valide pour toute la durée du bail. Elle reste active tant que le contrat de location est en cours. Si le bail est renouvelé ou modifié de manière substantielle, une nouvelle certification sera nécessaire."})]}),e.jsxs(G,{value:"modifications",children:[e.jsx(H,{className:"text-left",children:"Puis-je modifier mon bail après certification ?"}),e.jsx(Q,{className:"text-muted-foreground",children:"Les modifications mineures (coordonnées, date de paiement) peuvent être apportées sans affecter la certification. Cependant, toute modification substantielle (montant du loyer, durée du bail, parties impliquées) nécessitera une nouvelle demande de certification. Contactez notre support pour plus de détails sur votre situation spécifique."})]}),e.jsxs(G,{value:"verification",children:[e.jsx(H,{className:"text-left",children:"Comment se passe la vérification d'identité ?"}),e.jsxs(Q,{className:"text-muted-foreground",children:["La vérification d'identité se fait via le système ONECI (Office National d'Identification Civile et d'État). Vous devrez fournir :",e.jsxs("ul",{className:"list-disc pl-5 mt-2 space-y-1",children:[e.jsx("li",{children:"Numéro de CNI (Carte Nationale d'Identité)"}),e.jsx("li",{children:"Photo de votre CNI"}),e.jsx("li",{children:"Selfie pour vérification faciale (optionnel mais recommandé)"})]}),e.jsx("p",{className:"mt-2",children:"La vérification est effectuée automatiquement et prend généralement quelques minutes. En cas de problème, un agent ANSUT examinera manuellement votre dossier."})]})]}),e.jsxs(G,{value:"benefits",children:[e.jsx(H,{className:"text-left",children:"Quels sont les avantages concrets ?"}),e.jsx(Q,{className:"text-muted-foreground",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("strong",{className:"text-foreground",children:"Pour les propriétaires :"}),e.jsxs("ul",{className:"list-disc pl-5 mt-1",children:[e.jsx("li",{children:"Sécurité juridique maximale"}),e.jsx("li",{children:"Locataires vérifiés et fiables"}),e.jsx("li",{children:"Badge de qualité attirant plus de candidats"}),e.jsx("li",{children:"Facilite les démarches en cas de litige"})]})]}),e.jsxs("div",{children:[e.jsx("strong",{className:"text-foreground",children:"Pour les locataires :"}),e.jsxs("ul",{className:"list-disc pl-5 mt-1",children:[e.jsx("li",{children:"Protection contre les arnaques"}),e.jsx("li",{children:"Bail conforme aux normes légales"}),e.jsx("li",{children:"Propriétaire vérifié"}),e.jsx("li",{children:"Facilite l'obtention d'assurances"})]})]})]})})]}),e.jsxs(G,{value:"support",children:[e.jsx(H,{className:"text-left",children:"Comment obtenir de l'aide supplémentaire ?"}),e.jsxs(Q,{className:"text-muted-foreground",children:["Si vous avez d'autres questions ou besoin d'assistance :",e.jsxs("ul",{className:"list-disc pl-5 mt-2 space-y-1",children:[e.jsx("li",{children:"Consultez notre guide complet dans la section Documentation"}),e.jsx("li",{children:"Contactez notre support via la messagerie interne"}),e.jsx("li",{children:"Envoyez un email à support@montoit.ci"}),e.jsx("li",{children:"Appelez notre hotline : +225 XX XX XX XX XX"})]}),e.jsx("p",{className:"mt-2",children:"Notre équipe est disponible du lundi au vendredi de 8h à 18h."})]})]})]})})}),e.jsxs("div",{className:"bg-muted p-6 rounded-lg text-center",children:[e.jsx("p",{className:"text-muted-foreground",children:"Vous ne trouvez pas la réponse à votre question ?"}),e.jsx("p",{className:"text-sm mt-2",children:"Contactez notre équipe d'assistance qui se fera un plaisir de vous aider."})]})]})}),e.jsx(ne,{})]}),kl=[{name:"Locataire",price:"Gratuit",description:"Pour trouver votre logement idéal",features:["Recherche illimitée de biens","Candidatures en 1 clic","Certification ANSUT incluse","Messagerie avec propriétaires","Notifications en temps réel","Tableau de bord personnel"],notIncluded:[],cta:"Créer mon profil",ctaLink:"/auth?type=tenant",highlighted:!1},{name:"Propriétaire",price:"5%",priceDetail:"de commission sur loyer",description:"Pour louer vos biens en toute sécurité",features:["Publication illimitée de biens","Réception candidatures certifiées","Contrats digitaux sécurisés","Paiements Mobile Money","Tableau de bord analytique","Support prioritaire","Signature électronique"],notIncluded:[],cta:"Publier un bien",ctaLink:"/publier",highlighted:!0},{name:"Agence",price:"Sur devis",description:"Pour gérer plusieurs propriétés",features:["Toutes les fonctionnalités Propriétaire","Gestion multi-propriétés","Rapports avancés en temps réel","API d'intégration","Branding personnalisé","Support dédié 24/7","Formation des équipes"],notIncluded:[],cta:"Nous contacter",ctaLink:"/auth?type=agency",highlighted:!1}],Al=()=>e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ie,{}),e.jsxs("main",{className:"flex-1 pt-24",children:[e.jsxs("section",{className:"py-12 md:py-18 bg-white relative",children:[e.jsx(_s,{}),e.jsxs("div",{className:"container mx-auto px-4 max-w-7xl text-center relative z-10",children:[e.jsxs("h1",{className:"text-h1 mb-6",children:["Des tarifs ",e.jsx("span",{className:"text-gradient-primary",children:"simples et transparents"})]}),e.jsx("p",{className:"text-lg md:text-xl text-muted-foreground max-w-3xl mx-auto",children:"Choisissez la formule adaptée à votre besoin. Aucun frais caché, annulation à tout moment."})]})]}),e.jsx("section",{className:"py-8 md:py-12 bg-gray-50",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-7xl",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:kl.map((s,t)=>{const r=t===0?"border-l-blue-600":t===1?"border-l-primary":"border-l-secondary";return e.jsxs("div",{className:`bg-white rounded-lg border-l-4 ${r} ${s.highlighted?"shadow-lg scale-105 md:scale-110":t===0?"shadow-lg md:scale-105":"shadow-md"} p-8 relative transition-all duration-200 hover:shadow-xl`,children:[t===0&&e.jsx("div",{className:"absolute -top-4 left-1/2 -translate-x-1/2 bg-secondary text-white px-4 py-1 rounded-full text-sm font-semibold",children:"TOUJOURS GRATUIT"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-2xl font-bold text-foreground mb-2",children:s.name}),e.jsx("p",{className:"text-muted-foreground text-sm",children:s.description})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"text-4xl font-bold text-foreground",children:s.price}),s.priceDetail&&e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:s.priceDetail})]}),e.jsxs("ul",{className:"space-y-4 mb-8",children:[s.features.map((a,n)=>e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(Qs,{className:"h-5 w-5 text-primary flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-foreground",children:a})]},n)),s.notIncluded.map((a,n)=>e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsx(_e,{className:"h-5 w-5 text-muted-foreground flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-muted-foreground line-through",children:a})]},`not-${n}`))]}),e.jsx(N,{asChild:!0,className:"w-full",size:"lg",variant:s.highlighted?"default":"outline",children:e.jsx(U,{to:s.ctaLink,children:s.cta})})]},t)})}),e.jsxs("div",{className:"mt-20 max-w-3xl mx-auto",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-8 text-center text-foreground",children:"Questions fréquentes"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md",children:[e.jsx("h3",{className:"font-bold text-lg mb-2 text-foreground",children:"Comment fonctionne la commission de 5% ?"}),e.jsx("p",{className:"text-muted-foreground",children:"La commission est prélevée uniquement lorsqu'un contrat de location est signé via la plateforme. Elle couvre tous nos services : vérification des locataires, contrat digital, paiements sécurisés et support."})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md",children:[e.jsx("h3",{className:"font-bold text-lg mb-2 text-foreground",children:"Pourquoi c'est gratuit pour les locataires ?"}),e.jsx("p",{className:"text-muted-foreground",children:"La certification ANSUT (vérification d'identité biométrique + constitution du dossier digital) est 100% gratuite pour tous les locataires car financée par l'ANSUT dans le cadre du service universel. Mon Toit se rémunère uniquement via les commissions sur les baux signés par les propriétaires."})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md",children:[e.jsx("h3",{className:"font-bold text-lg mb-2 text-foreground",children:"Comment Mon Toit finance son fonctionnement ?"}),e.jsx("p",{className:"text-muted-foreground",children:"Mon Toit opère selon un modèle freemium transparent : l'ANSUT finance l'infrastructure (CAPEX) et Mon Toit assure les opérations (OPEX) via des commissions sur les transactions, de la publicité ciblée et des services premium pour les agences. Les locataires ne paient jamais."})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md",children:[e.jsx("h3",{className:"font-bold text-lg mb-2 text-foreground",children:"Quels sont les tarifs pour les agences ?"}),e.jsx("p",{className:"text-muted-foreground",children:"Nos tarifs agences sont personnalisés selon le nombre de propriétés gérées et les fonctionnalités souhaitées (API, branding, formations). Contactez-nous pour un devis sur mesure."})]})]})]}),e.jsxs("div",{className:"mt-20 text-center",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-4 text-foreground",children:"Prêt à commencer ?"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-8 max-w-2xl mx-auto",children:"Rejoignez des milliers d'utilisateurs qui font confiance à Mon Toit pour leurs démarches immobilières"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx(N,{asChild:!0,size:"lg",className:"px-8",children:e.jsx(U,{to:"/auth?type=tenant",children:"Je suis locataire"})}),e.jsx(N,{asChild:!0,size:"lg",variant:"outline",className:"px-8",children:e.jsx(U,{to:"/publier",children:"Je suis propriétaire"})})]})]})]})})]}),e.jsx(ne,{})]});function Tl(){const[s,t]=i.useState(!1),[r,a]=i.useState({total:0,current:0,results:[]}),n=Ie(),l=async()=>{t(!0),a({total:0,current:0,results:[]});try{const{data:c,error:o}=await w.from("properties").select("id, title, property_type, city, neighborhood").is("main_image",null).limit(10);if(o)throw o;if(!c||c.length===0){I({title:"Aucune propriété à traiter",description:"Toutes les propriétés ont déjà des images."}),t(!1);return}a(m=>({...m,total:c.length}));const d=[];for(const m of c){try{const{data:x,error:j}=await w.functions.invoke("generate-property-images",{body:{propertyId:m.id,propertyType:m.property_type,city:m.city}});if(j)throw j;if(!x.success)throw new Error(x.error||"Failed to generate image");d.push({id:m.id,title:m.title,success:!0})}catch(x){d.push({id:m.id,title:m.title,success:!1,error:x.message})}a(x=>({...x,current:x.current+1,results:[...d]}))}const h=d.filter(m=>m.success).length;I({title:"Génération terminée !",description:`${h} images générées avec succès sur ${c.length}.`})}catch(c){I({title:"Erreur",description:c.message,variant:"destructive"})}finally{t(!1)}};return e.jsx("div",{className:"container mx-auto py-8 px-4",children:e.jsxs(y,{className:"max-w-2xl mx-auto",children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(xa,{className:"h-6 w-6"}),"Générer des images pour les propriétés"]}),e.jsx(O,{children:"Cette page permet de générer automatiquement des images pour toutes les propriétés qui n'en ont pas encore."})]}),e.jsxs(k,{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(N,{onClick:l,disabled:s,className:"flex-1",children:[s&&e.jsx(oe,{className:"mr-2 h-4 w-4 animate-spin"}),s?"Génération en cours...":"Générer les images"]}),e.jsx(N,{variant:"outline",onClick:()=>n("/"),children:"Retour"})]}),r.total>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Progression"}),e.jsxs("span",{className:"font-semibold",children:[r.current," / ",r.total]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:e.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${r.current/r.total*100}%`}})}),r.results.length>0&&e.jsxs("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:[e.jsx("h3",{className:"font-semibold text-sm",children:"Résultats"}),r.results.map((c,o)=>e.jsxs("div",{className:"flex items-start gap-2 p-2 rounded-lg bg-muted/50 text-sm",children:[c.success?e.jsx(K,{className:"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0"}):e.jsx(Fe,{className:"h-4 w-4 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:c.title}),c.error&&e.jsx("p",{className:"text-xs text-muted-foreground",children:c.error})]})]},o))]})]})]})]})})}const Pl=()=>{const{user:s}=le(),[t,r]=i.useState(null),[a,n]=i.useState(!1),[l,c]=i.useState(!0);i.useEffect(()=>{s&&o()},[s]);const o=async()=>{if(!s)return;c(!0);const{data:h,error:m}=await w.from("digital_certificates").select("*").eq("user_id",s.id).maybeSingle();!m&&h&&r(h),c(!1)},d=async()=>{n(!0);try{const{data:h,error:m}=await w.functions.invoke("cryptoneo-generate-certificate");m?I({title:"Erreur",description:m.message||"Échec de la génération du certificat",variant:"destructive"}):(I({title:"Certificat généré",description:"Votre certificat numérique a été généré avec succès"}),o())}catch(h){I({title:"Erreur",description:h.message||"Une erreur est survenue",variant:"destructive"})}finally{n(!1)}};return e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-secondary"}),"Certificat Numérique CryptoNeo"]}),e.jsx(O,{children:"Requis pour la signature électronique certifiée par ANSUT"})]}),e.jsx(k,{children:l?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(oe,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):t?t.certificate_status==="active"?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 dark:bg-green-950 rounded-lg",children:[e.jsx(K,{className:"h-5 w-5 text-green-600 dark:text-green-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900 dark:text-green-100",children:"Certificat actif"}),e.jsxs("p",{className:"text-sm text-green-700 dark:text-green-300",children:["Expire le ",new Date(t.expires_at).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ID: ",t.certificate_id]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(be,{variant:"destructive",children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx(Ne,{children:t.certificate_status==="expired"?"Votre certificat a expiré. Générez-en un nouveau pour signer électroniquement.":"Votre certificat a été révoqué. Veuillez contacter le support."})]}),t.certificate_status==="expired"&&e.jsx(N,{onClick:d,disabled:a,variant:"destructive",className:"w-full",children:a?e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"h-4 w-4 mr-2 animate-spin"}),"Régénération..."]}):"Régénérer le certificat"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(be,{children:[e.jsx(ha,{className:"h-4 w-4"}),e.jsx(Ne,{children:"Votre certificat sera généré automatiquement à partir de vos données ONECI vérifiées."})]}),e.jsx(N,{onClick:d,disabled:a,className:"w-full",children:a?e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"h-4 w-4 mr-2 animate-spin"}),"Génération en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Générer mon certificat"]})})]})})]})},El=({operationId:s,onComplete:t})=>{const[r,a]=i.useState("initiated"),[n,l]=i.useState(0),[c,o]=i.useState(null);i.useEffect(()=>{const m=async()=>{const{data:j}=await w.from("electronic_signature_logs").select("status, error_message").eq("operation_id",s).single();j&&(a(j.status),j.error_message&&o(j.error_message),j.status==="completed"?(l(100),ji(),t()):j.status==="failed"?l(0):l(p=>Math.min(p+10,90)))};m();const x=setInterval(m,5e3);return()=>clearInterval(x)},[s,t]);const d=()=>{switch(r){case"completed":return"Signature complétée !";case"failed":return"Échec de la signature";case"in_progress":return"Traitement en cours...";default:return"Initialisation..."}},h=()=>{switch(r){case"completed":return"Le document signé est disponible";case"failed":return c||"Veuillez réessayer ou utiliser la signature simple";case"in_progress":return"Cela peut prendre quelques minutes";default:return"Préparation de la signature électronique"}};return e.jsx(y,{children:e.jsx(k,{className:"pt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[r==="completed"?e.jsx(xs,{className:"h-6 w-6 text-green-600 dark:text-green-400 flex-shrink-0"}):r==="failed"?e.jsx(Fe,{className:"h-6 w-6 text-destructive flex-shrink-0"}):e.jsx(oe,{className:"h-6 w-6 animate-spin text-primary flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:d()}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h()})]})]}),r!=="failed"&&r!=="completed"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ke,{value:n,className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:[n,"% complété"]})]}),r==="failed"&&c&&e.jsx("div",{className:"p-3 bg-destructive/10 rounded-md",children:e.jsx("p",{className:"text-sm text-destructive",children:c})})]})})})},Ml=async(s,t)=>{try{const{data:r}=await w.from("profiles").select("oneci_verified").eq("id",s).single();if(!(r!=null&&r.oneci_verified))return{canSign:!1,reason:"Identité ONECI non vérifiée. Veuillez compléter la vérification."};const{data:a}=await w.from("digital_certificates").select("*").eq("user_id",s).eq("certificate_status","active").maybeSingle();if(!a)return{canSign:!1,reason:"Certificat numérique requis",autoFix:"generate_certificate"};if(a.expires_at&&new Date(a.expires_at)<new Date)return{canSign:!1,reason:"Votre certificat a expiré. Veuillez en générer un nouveau.",autoFix:"generate_certificate"};const{data:n}=await w.from("leases").select("*").eq("id",t).single();return n?!n.landlord_signed_at||!n.tenant_signed_at?{canSign:!1,reason:"Les deux parties doivent d'abord signer avec signature simple"}:n.document_url?n.is_electronically_signed?{canSign:!1,reason:"Ce bail est déjà signé électroniquement"}:{canSign:!0}:{canSign:!1,reason:"Le PDF du bail doit être généré",autoFix:"generate_pdf"}:{canSign:!1,reason:"Bail non trouvé"}}catch(r){return T.logError(r,{context:"signature-validation",action:"canSignElectronically",userId:s,leaseId:t}),{canSign:!1,reason:"Erreur lors de la vérification des prérequis"}}},wt=s=>{var r;switch((s==null?void 0:s.code)||((r=s==null?void 0:s.error)==null?void 0:r.code)||"UNKNOWN"){case"CERTIFICATE_EXPIRED":return{userMessage:"Votre certificat numérique a expiré. Un nouveau certificat sera généré automatiquement.",action:"regenerate_certificate",fallback:"use_simple_signature"};case"ONECI_DATA_MISSING":case"ONECI_NOT_VERIFIED":return{userMessage:"Vérification ONECI incomplète. Veuillez compléter votre vérification d'identité.",action:"redirect_verification",redirectUrl:"/verification"};case"PHOTO_MISSING":return{userMessage:"Photo ONECI manquante. Veuillez compléter votre vérification d'identité avec photo.",action:"redirect_verification",redirectUrl:"/verification"};case"API_TIMEOUT":case"TIMEOUT":return{userMessage:"Le traitement prend plus de temps que prévu. Vous serez notifié une fois terminé.",action:"async_verification",notification:!0};case"API_UNAVAILABLE":case"SERVICE_UNAVAILABLE":case 503:return{userMessage:"Service de signature électronique temporairement indisponible. Veuillez réessayer dans quelques minutes.",action:"fallback_simple_signature",retryIn:300};case"INVALID_CREDENTIALS":case 401:case 403:return{userMessage:"Erreur de configuration du service de signature. L'équipe technique a été notifiée.",action:"log_and_notify_admin",fallback:"use_simple_signature"};case"CERTIFICATE_INVALID":return{userMessage:"Certificat invalide. Un nouveau certificat sera généré.",action:"regenerate_certificate"};case"PDF_GENERATION_FAILED":return{userMessage:"Le document PDF doit être généré avant la signature électronique.",action:"fallback_simple_signature"};case"SIGNATURES_INCOMPLETE":return{userMessage:"Les deux parties doivent d'abord signer avec signature simple.",action:"fallback_simple_signature"};case"NETWORK_ERROR":return{userMessage:"Erreur de connexion. Veuillez vérifier votre connexion Internet.",action:"retry",retryIn:5};default:return T.error("Unhandled CryptoNeo error",{error:s,errorCode:(s==null?void 0:s.code)||"UNKNOWN",context:"cryptoneo-error-handler"}),{userMessage:"Une erreur inattendue s'est produite. Vous pouvez continuer avec la signature simple.",action:"log_and_notify_admin",fallback:"use_simple_signature"}}},Il=({lease:s,userType:t,onSignatureComplete:r})=>{const{user:a}=le(),[n,l]=i.useState("simple"),[c,o]=i.useState(!1),[d,h]=i.useState(null),[m,x]=i.useState(!1),[j,p]=i.useState(""),u=t==="proprietaire",g=u?s.landlord_signed_at:s.tenant_signed_at,C=u?s.landlord_cryptoneo_signature_at:s.tenant_cryptoneo_signature_at;i.useEffect(()=>{a&&n==="electronic"&&S()},[a,n,s.id]);const S=async()=>{if(!a)return;const f=await Ml(a.id,s.id);x(f.canSign),f.reason&&p(f.reason)},_=async()=>{o(!0);try{const{error:f}=await w.from("leases").update({[u?"landlord_signed_at":"tenant_signed_at"]:new Date().toISOString()}).eq("id",s.id);if(f)throw f;I({title:"Signature enregistrée",description:"Votre signature simple a été enregistrée"}),r()}catch(f){I({title:"Erreur",description:f.message,variant:"destructive"})}finally{o(!1)}},b=async()=>{if(!m){I({title:"Prérequis non remplis",description:j,variant:"destructive"});return}o(!0);try{const{data:f,error:v}=await w.functions.invoke("cryptoneo-sign-document",{body:{leaseId:s.id,userType:u?"landlord":"tenant"}});if(v){const A=wt(v);I({title:"Erreur",description:A.userMessage,variant:"destructive"}),A.action==="fallback_simple_signature"&&l("simple")}else h(f.operationId),I({title:"Signature en cours",description:"Votre signature électronique est en cours de traitement..."})}catch(f){const v=wt(f);I({title:"Erreur",description:v.userMessage,variant:"destructive"})}finally{o(!1)}};return s.is_electronically_signed?e.jsx(y,{children:e.jsx(k,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 dark:bg-green-950 rounded-lg",children:[e.jsx(Y,{className:"h-5 w-5 text-green-600 dark:text-green-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900 dark:text-green-100",children:"Bail signé électroniquement"}),e.jsx("p",{className:"text-sm text-green-700 dark:text-green-300",children:"Les deux parties ont signé électroniquement via CryptoNeo"})]})]})})}):e.jsxs(y,{children:[e.jsx(P,{children:e.jsx(E,{children:"Signer le bail"})}),e.jsx(k,{children:e.jsxs(Be,{value:n,onValueChange:f=>l(f),children:[e.jsxs($e,{className:"grid w-full grid-cols-2",children:[e.jsxs(re,{value:"simple",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Signature Simple"]}),e.jsxs(re,{value:"electronic",children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Signature Électronique"]})]}),e.jsx(de,{value:"simple",className:"space-y-4 mt-4",children:g?e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Vous avez signé le ",new Date(g).toLocaleDateString("fr-FR")]}):e.jsx(N,{onClick:_,disabled:c,className:"w-full",children:c?e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"h-4 w-4 mr-2 animate-spin"}),"Signature en cours..."]}):"Signer simplement"})}),e.jsxs(de,{value:"electronic",className:"space-y-4 mt-4",children:[e.jsx(Pl,{}),C?e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400",children:["✓ Vous avez signé électroniquement le ",new Date(C).toLocaleDateString("fr-FR")]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{onClick:b,disabled:c||!m,className:"w-full",children:c?e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"h-4 w-4 mr-2 animate-spin"}),"Signature en cours..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-4 w-4 mr-2"}),"Signer avec CryptoNeo"]})}),!m&&j&&e.jsx("p",{className:"text-sm text-muted-foreground",children:j})]}),d&&e.jsx(El,{operationId:d,onComplete:r})]})]})})]})};function Ll(){const{user:s,profile:t}=le(),[r,a]=i.useState(null),[n,l]=i.useState(!0),[c,o]=i.useState(!1),[d,h]=i.useState(null);i.useEffect(()=>{m()},[s]);const m=async()=>{if(!s)return;l(!0);const{data:p}=await w.from("leases").select("*").or(`landlord_id.eq.${s.id},tenant_id.eq.${s.id}`).order("created_at",{ascending:!1}).limit(1);p&&p.length>0&&a(p[0]);const{data:u}=await w.from("digital_certificates").select("*").eq("user_id",s.id).maybeSingle();h(u),l(!1)},x=async()=>{if(r){o(!0);try{const{data:p,error:u}=await w.functions.invoke("generate-lease-pdf",{body:{leaseId:r.id}});if(u)throw u;I({title:"PDF généré",description:"Le PDF du bail a été généré avec succès"}),m()}catch(p){I({title:"Erreur",description:p.message||"Échec de la génération du PDF",variant:"destructive"})}finally{o(!1)}}};if(n)return e.jsx("div",{className:"container mx-auto py-8",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(oe,{className:"h-8 w-8 animate-spin text-primary"})})});if(!r)return e.jsx("div",{className:"container mx-auto py-8",children:e.jsxs(be,{children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx(Ne,{children:`Aucun bail trouvé pour votre compte. Créez d'abord un bail via la page "Baux" ou assurez-vous d'être propriétaire ou locataire d'un bail existant.`})]})});const j=r.landlord_id===(s==null?void 0:s.id)?"proprietaire":"locataire";return e.jsxs("div",{className:"container mx-auto py-8 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[e.jsx(pa,{className:"h-8 w-8 text-primary"}),"Test CryptoNeo"]}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Page de test pour valider le flux de signature électronique"})]})}),e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(E,{children:"Bail de test"}),e.jsxs(O,{children:["ID: ",r.id]})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Votre rôle"}),e.jsx("p",{className:"font-medium",children:j==="proprietaire"?"Propriétaire":"Locataire"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Loyer mensuel"}),e.jsxs("p",{className:"font-medium",children:[r.monthly_rent.toLocaleString()," FCFA"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Statut"}),e.jsx("p",{className:"font-medium",children:r.status})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"PDF généré"}),e.jsx("p",{className:"font-medium",children:r.document_url?"✓ Oui":"✗ Non"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[r.landlord_signed_at?e.jsx(K,{className:"h-4 w-4 text-green-600"}):e.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-muted"}),e.jsx("span",{className:"text-sm",children:"Signature simple propriétaire"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r.tenant_signed_at?e.jsx(K,{className:"h-4 w-4 text-green-600"}):e.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-muted"}),e.jsx("span",{className:"text-sm",children:"Signature simple locataire"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r.landlord_cryptoneo_signature_at?e.jsx(K,{className:"h-4 w-4 text-green-600"}):e.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-muted"}),e.jsx("span",{className:"text-sm",children:"Signature électronique propriétaire"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[r.tenant_cryptoneo_signature_at?e.jsx(K,{className:"h-4 w-4 text-green-600"}):e.jsx("div",{className:"h-4 w-4 rounded-full border-2 border-muted"}),e.jsx("span",{className:"text-sm",children:"Signature électronique locataire"})]})]}),!r.document_url&&e.jsx(N,{onClick:x,disabled:c,className:"w-full",children:c?e.jsxs(e.Fragment,{children:[e.jsx(oe,{className:"h-4 w-4 mr-2 animate-spin"}),"Génération du PDF..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Générer le PDF du bail"]})})]})]}),e.jsxs(y,{children:[e.jsx(P,{children:e.jsx(E,{children:"Votre certificat numérique"})}),e.jsx(k,{children:d?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"h-5 w-5 text-green-600"}),e.jsxs("span",{className:"font-medium",children:["Certificat ",d.certificate_status]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["ID: ",d.certificate_id]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Expire: ",new Date(d.expires_at).toLocaleDateString("fr-FR")]})]}):e.jsxs(be,{children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx(Ne,{children:"Aucun certificat numérique. Utilisez la section ci-dessous pour en générer un."})]})})]}),e.jsx(Il,{lease:r,userType:j,onSignatureComplete:m}),e.jsxs(y,{children:[e.jsx(P,{children:e.jsx(E,{children:"Instructions de test"})}),e.jsxs(k,{className:"space-y-2 text-sm",children:[e.jsx("p",{className:"font-medium",children:"Étapes pour tester CryptoNeo :"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-muted-foreground",children:[e.jsx("li",{children:"Assurez-vous que votre identité ONECI est vérifiée"}),e.jsx("li",{children:"Générez le PDF du bail si ce n'est pas déjà fait"}),e.jsx("li",{children:'Signez avec "Signature Simple" (les deux parties)'}),e.jsx("li",{children:`Passez à l'onglet "Signature Électronique"`}),e.jsx("li",{children:"Générez votre certificat numérique CryptoNeo"}),e.jsx("li",{children:"Signez électroniquement avec CryptoNeo"}),e.jsx("li",{children:"Vérifiez les logs dans la base de données"})]})]})]})]})}const zl=()=>{const[s,t]=i.useState(""),r=a=>{if(!s.trim())return a;const n=s.toLowerCase();return a.filter(l=>l.question.toLowerCase().includes(n)||l.answer.toLowerCase().includes(n))};return e.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-b from-background to-muted/20",children:[e.jsx(ie,{}),e.jsxs("main",{className:"flex-1 pt-24",children:[e.jsxs("section",{className:"bg-gradient-to-r from-primary/10 via-accent/10 to-primary/10 py-10 mb-12 relative",children:[e.jsx(hr,{}),e.jsxs("div",{className:"container mx-auto px-4 text-center relative z-10",children:[e.jsx(z,{variant:"secondary",className:"mb-4",children:"Centre d'aide"}),e.jsxs("h1",{className:"text-h1 mb-4",children:["Comment pouvons-nous ",e.jsx("span",{className:"text-gradient-secondary",children:"vous aider"})," ?"]}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto mb-8",children:"Guides détaillés, FAQ et support pour profiter pleinement de Mon Toit"})]})]}),e.jsxs("div",{className:"container mx-auto px-4 pb-16",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-12",children:[e.jsx(U,{to:"/recherche",children:e.jsx(y,{className:"hover:shadow-lg transition-shadow cursor-pointer h-full border-primary/20 hover:border-primary/40",children:e.jsxs(P,{className:"text-center",children:[e.jsx(Me,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx(E,{className:"text-sm",children:"Rechercher un bien"})]})})}),e.jsx(U,{to:"/publier",children:e.jsx(y,{className:"hover:shadow-lg transition-shadow cursor-pointer h-full border-primary/20 hover:border-primary/40",children:e.jsxs(P,{className:"text-center",children:[e.jsx(ee,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx(E,{className:"text-sm",children:"Publier une annonce"})]})})}),e.jsx(U,{to:"/verification",children:e.jsx(y,{className:"hover:shadow-lg transition-shadow cursor-pointer h-full border-primary/20 hover:border-primary/40",children:e.jsxs(P,{className:"text-center",children:[e.jsx(Y,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx(E,{className:"text-sm",children:"Se faire certifier"})]})})}),e.jsx(U,{to:"/messages",children:e.jsx(y,{className:"hover:shadow-lg transition-shadow cursor-pointer h-full border-primary/20 hover:border-primary/40",children:e.jsxs(P,{className:"text-center",children:[e.jsx(ms,{className:"h-8 w-8 mx-auto mb-2 text-primary"}),e.jsx(E,{className:"text-sm",children:"Contacter le support"})]})})})]}),e.jsxs(Be,{defaultValue:"locataire",className:"w-full mb-16",children:[e.jsxs($e,{className:"grid w-full grid-cols-3 mb-8",children:[e.jsxs(re,{value:"locataire",className:"gap-2",children:[e.jsx(Ee,{className:"h-4 w-4"}),"Locataire"]}),e.jsxs(re,{value:"proprietaire",className:"gap-2",children:[e.jsx(ee,{className:"h-4 w-4"}),"Propriétaire"]}),e.jsxs(re,{value:"agence",className:"gap-2",children:[e.jsx(ke,{className:"h-4 w-4"}),"Agence"]})]}),e.jsx(de,{value:"locataire",className:"space-y-6",children:e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(fa,{className:"h-5 w-5 text-primary"}),"Démarrer en tant que locataire"]}),e.jsx(O,{children:"Gratuit à 100% - Trouvez votre logement idéal"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Étape 1 : Créer votre compte"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:'Inscrivez-vous gratuitement avec votre email. Sélectionnez "Locataire" comme type de compte.'})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Étape 2 : Rechercher un logement"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Utilisez la barre de recherche ou naviguez sur la carte interactive. Filtrez par prix, quartier, type de bien."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Étape 3 : Contacter le propriétaire"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:'Cliquez sur "Contacter" pour envoyer un message. Le propriétaire recevra une notification.'})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Étape 4 : Vérification ANSUT (Recommandé)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Complétez votre vérification d'identité (ONECI/CNI) et obtenez votre badge certifié ANSUT pour augmenter vos chances."})]})]})]})}),e.jsx(de,{value:"proprietaire",className:"space-y-6",children:e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-5 w-5 text-primary"}),"Publier votre bien"]}),e.jsx(O,{children:"Louez en toute sécurité avec ANSUT"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Étape 1 : Créer votre compte propriétaire"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:'Inscrivez-vous et sélectionnez "Propriétaire" ou "Agence immobilière".'})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Étape 2 : Publier votre annonce"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Remplissez les informations du bien : adresse, prix, photos, caractéristiques. Ajoutez des photos de qualité et des vidéos si possible."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Étape 3 : Validation de l'annonce"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Votre annonce sera vérifiée par ANSUT sous 24-48h. Vous recevrez une notification."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Étape 4 : Gérer les candidatures"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Consultez les profils des candidats certifiés ANSUT et leurs dossiers. Communiquez via la messagerie sécurisée."})]})]})]})}),e.jsx(de,{value:"agence",className:"space-y-6",children:e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-primary"}),"Gérer vos mandats"]}),e.jsx(O,{children:"Solution professionnelle pour agences immobilières"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Compte agence certifié"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Créez un compte agence et complétez la vérification professionnelle ANSUT."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Gestion multi-propriétaires"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Gérez les biens de plusieurs propriétaires depuis un seul tableau de bord."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold",children:"Outils professionnels"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Accédez aux statistiques avancées, reporting, et gestion des commissions."})]})]})]})})]}),e.jsxs("div",{className:"mb-16",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-2",children:"Questions fréquentes"}),e.jsx("p",{className:"text-muted-foreground",children:"Tout ce que vous devez savoir sur Mon Toit"})]}),e.jsxs("div",{className:"max-w-2xl mx-auto mb-8",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Me,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx(X,{type:"text",placeholder:"Rechercher dans la FAQ (ex: certification, paiement, compte...)",value:s,onChange:a=>t(a.target.value),className:"pl-10 h-12 text-base"})]}),s&&e.jsx("div",{className:"flex items-center gap-2 mt-2",children:e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>t(""),className:"h-7 text-xs",children:"Effacer la recherche"})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(()=>{const n=r([{id:"q1",question:"Comment créer un compte ?",answer:`Cliquez sur "Se connecter / S'inscrire" en haut à droite, choisissez votre type de profil (Locataire, Propriétaire ou Agence), puis remplissez le formulaire. L'inscription est gratuite et ne prend que 2 minutes.`},{id:"q2",question:"Puis-je avoir plusieurs rôles ?",answer:'Oui ! Vous pouvez basculer entre plusieurs rôles depuis votre profil. Par exemple, être à la fois locataire et propriétaire. Allez dans "Mon profil" puis "Gestion des rôles".'},{id:"q3",question:"Comment réinitialiser mon mot de passe ?",answer:'Sur la page de connexion, cliquez sur "Mot de passe oublié ?" et suivez les instructions envoyées par email. Assurez-vous de vérifier vos spams.'}]);return n.length>0?e.jsxs(y,{children:[e.jsx(P,{children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ee,{className:"h-5 w-5 text-primary"}),e.jsx(E,{children:"Compte & Inscription"})]})}),e.jsx(k,{children:e.jsx(Ue,{type:"single",collapsible:!0,children:n.map(l=>e.jsxs(G,{value:l.id,children:[e.jsx(H,{children:l.question}),e.jsx(Q,{children:l.answer})]},l.id))})})]}):null})(),(()=>{const n=r([{id:"c1",question:"Qu'est-ce que la certification ANSUT ?",answer:"C'est une vérification officielle de votre identité par l'ANSUT (Agence Nationale des Systèmes d'Urgence et de Télécommunications). Elle garantit votre sécurité et augmente votre crédibilité sur la plateforme."},{id:"c2",question:"La certification est-elle obligatoire ?",answer:"Non, mais elle est fortement recommandée ! Les profils certifiés ont accès à plus de fonctionnalités et inspirent davantage confiance. Pour les propriétaires, c'est indispensable pour publier des annonces."},{id:"c3",question:"Combien coûte la certification ?",answer:"La certification ANSUT est totalement GRATUITE pour tous les utilisateurs. C'est un service public financé par l'État ivoirien."},{id:"c4",question:"Combien de temps prend la vérification ?",answer:"En moyenne 24-48 heures ouvrées. Vous recevrez un email dès que votre dossier sera traité. Assurez-vous que vos documents sont clairs et lisibles pour accélérer le processus."}]);return n.length>0?e.jsxs(y,{children:[e.jsx(P,{children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Y,{className:"h-5 w-5 text-primary"}),e.jsx(E,{children:"Certification ANSUT"})]})}),e.jsx(k,{children:e.jsx(Ue,{type:"single",collapsible:!0,children:n.map(l=>e.jsxs(G,{value:l.id,children:[e.jsx(H,{children:l.question}),e.jsx(Q,{children:l.answer})]},l.id))})})]}):null})(),e.jsxs(y,{children:[e.jsx(P,{children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Me,{className:"h-5 w-5 text-primary"}),e.jsx(E,{children:"Recherche & Location"})]})}),e.jsx(k,{children:e.jsxs(Ue,{type:"single",collapsible:!0,children:[e.jsxs(G,{value:"r1",children:[e.jsx(H,{children:"Comment rechercher un bien ?"}),e.jsx(Q,{children:'Utilisez la barre de recherche en haut de la page ou allez sur "/recherche". Vous pouvez filtrer par ville, quartier, type de bien, budget, nombre de pièces, etc. Utilisez la carte interactive pour explorer visuellement.'})]}),e.jsxs(G,{value:"r2",children:[e.jsx(H,{children:"Comment postuler à une annonce ?"}),e.jsx(Q,{children:`Sur la page du bien, cliquez sur "Postuler". Remplissez le formulaire avec vos informations et téléchargez vos justificatifs (pièce d'identité, bulletin de salaire, etc.). Le propriétaire sera notifié.`})]}),e.jsxs(G,{value:"r3",children:[e.jsx(H,{children:"Puis-je visiter un bien avant de postuler ?"}),e.jsx(Q,{children:"Oui ! Contactez directement le propriétaire via la messagerie intégrée pour planifier une visite. Vous pouvez aussi poser toutes vos questions avant de postuler."})]})]})})]}),e.jsxs(y,{children:[e.jsx(P,{children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Bt,{className:"h-5 w-5 text-primary"}),e.jsx(E,{children:"Paiements & Tarifs"})]})}),e.jsx(k,{children:e.jsxs(Ue,{type:"single",collapsible:!0,children:[e.jsxs(G,{value:"p1",children:[e.jsx(H,{children:"La plateforme est-elle payante ?"}),e.jsxs(Q,{children:[e.jsx("strong",{children:"Pour les locataires :"})," 100% GRATUIT, aucun frais.",e.jsx("br",{}),e.jsx("strong",{children:"Pour les propriétaires/agences :"})," Commission de 10% uniquement en cas de location réussie. Aucun frais pour publier ou gérer vos annonces."]})]}),e.jsxs(G,{value:"p2",children:[e.jsx(H,{children:"Quels moyens de paiement acceptez-vous ?"}),e.jsx(Q,{children:"Nous acceptons Orange Money, MTN Mobile Money, Wave et Moov Money. Les paiements sont 100% sécurisés et chiffrés."})]}),e.jsxs(G,{value:"p3",children:[e.jsx(H,{children:"Quand la commission est-elle prélevée ?"}),e.jsx(Q,{children:"La commission de 10% n'est facturée qu'après signature officielle du bail et confirmation de la location. Si le locataire se rétracte, aucun frais n'est appliqué."})]})]})})]}),e.jsxs(y,{children:[e.jsx(P,{children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Y,{className:"h-5 w-5 text-primary"}),e.jsx(E,{children:"Sécurité & Confidentialité"})]})}),e.jsx(k,{children:e.jsxs(Ue,{type:"single",collapsible:!0,children:[e.jsxs(G,{value:"s1",children:[e.jsx(H,{children:"Mes données sont-elles protégées ?"}),e.jsxs(Q,{children:["Absolument. Nous respectons la loi ivoirienne 2013-450 sur la protection des données. Vos informations personnelles sont chiffrées et jamais partagées sans votre consentement. Voir notre ",e.jsx(U,{to:"/confidentialite",className:"text-primary underline",children:"Politique de confidentialité"}),"."]})]}),e.jsxs(G,{value:"s2",children:[e.jsx(H,{children:"Comment signaler une annonce frauduleuse ?"}),e.jsx(Q,{children:`Sur chaque annonce, cliquez sur "Signaler" et indiquez la raison. Notre équipe de modération vérifiera dans les 24h. En cas d'urgence, contactez-nous à contact@montoit.ci.`})]}),e.jsxs(G,{value:"s3",children:[e.jsx(H,{children:"Puis-je supprimer mon compte ?"}),e.jsx(Q,{children:'Oui, allez dans "Mon profil" > "Paramètres" > "Supprimer mon compte". Attention : cette action est irréversible et supprimera toutes vos données.'})]})]})})]}),e.jsxs(y,{children:[e.jsx(P,{children:e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ve,{className:"h-5 w-5 text-primary"}),e.jsx(E,{children:"Problèmes techniques"})]})}),e.jsx(k,{children:e.jsxs(Ue,{type:"single",collapsible:!0,children:[e.jsxs(G,{value:"t1",children:[e.jsx(H,{children:"Je ne reçois pas d'emails de notification"}),e.jsx(Q,{children:`Vérifiez d'abord vos spams/courriers indésirables. Ajoutez contact@montoit.ci à vos contacts. Si le problème persiste, vérifiez vos préférences de notification dans "Mon profil" > "Notifications".`})]}),e.jsxs(G,{value:"t2",children:[e.jsx(H,{children:"L'upload de photos ne fonctionne pas"}),e.jsx(Q,{children:"Assurez-vous que vos photos sont au format JPG ou PNG et font moins de 5 Mo chacune. Essayez de compresser vos images ou d'utiliser un autre navigateur (Chrome ou Firefox recommandés)."})]}),e.jsxs(G,{value:"t3",children:[e.jsx(H,{children:"La carte ne s'affiche pas correctement"}),e.jsx(Q,{children:"Autorisez l'accès à votre position dans votre navigateur. Effacez le cache de votre navigateur et rechargez la page. Si le problème persiste, contactez le support."})]})]})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-12",children:[e.jsxs(y,{className:"text-center hover:shadow-lg transition-shadow",children:[e.jsxs(P,{children:[e.jsx(Re,{className:"h-12 w-12 mx-auto mb-3 text-primary"}),e.jsx(E,{children:"Documentation complète"}),e.jsx(O,{children:"Guides détaillés pour chaque fonctionnalité"})]}),e.jsx(k,{children:e.jsx(N,{variant:"outline",asChild:!0,className:"w-full",children:e.jsxs(U,{to:"/comment-ca-marche",children:["Voir la documentation",e.jsx(qs,{className:"ml-2 h-4 w-4"})]})})})]}),e.jsxs(y,{className:"text-center hover:shadow-lg transition-shadow",children:[e.jsxs(P,{children:[e.jsx(Y,{className:"h-12 w-12 mx-auto mb-3 text-primary"}),e.jsx(E,{children:"FAQ Certification"}),e.jsx(O,{children:"Tout savoir sur la certification ANSUT"})]}),e.jsx(k,{children:e.jsx(N,{variant:"outline",asChild:!0,className:"w-full",children:e.jsxs(U,{to:"/certification-faq",children:["Consulter la FAQ",e.jsx(qs,{className:"ml-2 h-4 w-4"})]})})})]}),e.jsxs(y,{className:"text-center hover:shadow-lg transition-shadow",children:[e.jsxs(P,{children:[e.jsx(qe,{className:"h-12 w-12 mx-auto mb-3 text-primary"}),e.jsx(E,{children:"Statut du service"}),e.jsx(O,{children:"Incidents et maintenance planifiée"})]}),e.jsx(k,{children:e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[e.jsx(K,{className:"h-5 w-5 text-success"}),e.jsx("span",{className:"text-sm font-medium text-success",children:"Tous les services opérationnels"})]})})]})]}),e.jsxs(y,{className:"bg-gradient-to-r from-primary/10 via-accent/10 to-primary/10 border-primary/30",children:[e.jsxs(P,{className:"text-center",children:[e.jsx(E,{className:"text-3xl mb-3",children:"Vous ne trouvez pas de réponse ?"}),e.jsx(O,{className:"text-base",children:"Notre équipe support est disponible pour vous aider"})]}),e.jsxs(k,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-2xl mx-auto mb-6",children:[e.jsxs("div",{className:"flex items-start gap-4 p-4 bg-background rounded-lg",children:[e.jsx(hs,{className:"h-6 w-6 text-primary flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold mb-1",children:"Email Support"}),e.jsx("a",{href:"mailto:contact@montoit.ci",className:"text-primary hover:underline",children:"contact@montoit.ci"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Réponse sous 24h"})]})]}),e.jsxs("div",{className:"flex items-start gap-4 p-4 bg-background rounded-lg",children:[e.jsx(ga,{className:"h-6 w-6 text-primary flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold mb-1",children:"Téléphone"}),e.jsx("p",{className:"text-foreground",children:"+225 27 XX XX XX XX"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Lun-Ven : 8h - 18h"})]})]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(N,{size:"lg",asChild:!0,children:e.jsxs(U,{to:"/messages",children:[e.jsx(ms,{className:"mr-2 h-5 w-5"}),"Ouvrir une conversation"]})}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-3",children:["Temps de réponse moyen : ",e.jsx("strong",{children:"2 heures"})]})]})]})]})]})]}),e.jsx(ne,{})]})},Rl=i.lazy(()=>ae(()=>import("./ExploreMap-DwJ-JqCl.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]))),ql=i.lazy(()=>ae(()=>import("./FeaturedProperties-fpsYfsW4.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,13,10,11,12,14,15,16,17]))),Fl=()=>e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ie,{}),e.jsx("main",{className:"flex-1 pt-24",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx(ss,{}),e.jsxs("div",{className:"text-center mb-12 animate-fade-in relative",children:[e.jsx(_s,{}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h1",{className:"text-h1 mb-4",children:["Explorez les biens ",e.jsx("span",{className:"text-gradient-primary",children:"disponibles"})]}),e.jsx("p",{className:"text-body-lg text-muted-foreground max-w-2xl mx-auto",children:"Découvrez tous nos biens immobiliers certifiés à travers la Côte d'Ivoire"})]})]}),e.jsx("section",{className:"mb-8",children:e.jsxs("div",{className:"relative h-40 md:h-48 rounded-lg overflow-hidden shadow-lg",children:[e.jsx(gs,{src:fs("abidjan-neighborhood"),alt:"Quartier d'Abidjan",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent flex items-end",children:e.jsxs("div",{className:"text-white p-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Explorez les quartiers d'Abidjan"}),e.jsx("p",{className:"text-sm opacity-90",children:"Cocody, Plateau, Marcory et plus encore"})]})})]})}),e.jsx(i.Suspense,{fallback:e.jsx(ze,{className:"h-96 w-full rounded-lg mb-16"}),children:e.jsx("div",{className:"mb-16 animate-fade-in",children:e.jsx(Rl,{})})}),e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(s=>e.jsxs("div",{className:"space-y-4",children:[e.jsx(ze,{className:"h-64 w-full rounded-lg"}),e.jsx(ze,{className:"h-4 w-3/4"}),e.jsx(ze,{className:"h-4 w-1/2"})]},s))}),children:e.jsx("div",{className:"animate-fade-in",children:e.jsx(ql,{})})})]})})}),e.jsx(ne,{})]}),Vl=[{icon:rs,title:"Locataire",color:"from-blue-500 to-blue-600",illustrationKey:"apartment-visit",steps:[{number:"1",icon:rs,title:"Créez votre profil",description:"Inscrivez-vous et complétez vos informations personnelles"},{number:"2",icon:es,title:"Faites-vous certifier ANSUT",description:"Vérification biométrique et constitution de votre dossier digital"},{number:"3",icon:zs,title:"Postulez en 1 clic",description:"Candidatez aux biens avec votre profil certifié"}],cta:{text:"Créer mon profil locataire",link:"/auth?type=tenant"}},{icon:ee,title:"Propriétaire",color:"from-primary to-primary-600",illustrationKey:"modern-living-room",steps:[{number:"1",icon:ee,title:"Publiez votre bien",description:"Ajoutez photos, description et caractéristiques"},{number:"2",icon:rs,title:"Recevez des candidatures certifiées",description:"Ne traitez que des dossiers vérifiés avec scoring"},{number:"3",icon:ja,title:"Signez & encaissez en ligne",description:"Bail digital + paiements Mobile Money sécurisés"}],cta:{text:"Publier un bien",link:"/publier"}},{icon:ke,title:"Agence",color:"from-secondary to-secondary-600",illustrationKey:"co-ownership-meeting",steps:[{number:"1",icon:ke,title:"Créez votre profil d'agence",description:"Inscription professionnelle avec documents officiels"},{number:"2",icon:ee,title:"Gérez plusieurs propriétés",description:"Tableau de bord centralisé pour tous vos biens"},{number:"3",icon:zs,title:"Signez des contrats digitaux",description:"Automatisez la gestion locative de A à Z"}],cta:{text:"Créer mon compte agence",link:"/auth?type=agency"}}],Dl=()=>e.jsxs("section",{id:"comment-ca-marche",className:"py-12 md:py-14 bg-gradient-to-br from-primary/5 via-background to-secondary/5 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-primary/5 rounded-full blur-3xl -z-0"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-secondary/5 rounded-full blur-3xl -z-0"}),e.jsxs("div",{className:"container mx-auto px-3 md:px-4 max-w-7xl relative z-10",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-3 text-foreground",children:"Comment ça marche ?"}),e.jsx("p",{className:"text-muted-foreground text-lg max-w-2xl mx-auto",children:"Choisissez votre parcours et découvrez comment Mon Toit simplifie vos démarches immobilières"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:Vl.map((s,t)=>{const r=s.icon,a=t===0?"bg-blue-600":t===1?"bg-primary":"bg-secondary";return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 shadow-md hover:shadow-xl transition-all duration-300 p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`${a} p-2.5 rounded-full`,children:e.jsx(r,{className:"h-6 w-6 text-white"})}),e.jsx("h3",{className:"text-xl font-bold",children:s.title})]}),e.jsx("div",{className:"space-y-4 mb-6",children:s.steps.map((n,l)=>{const c=n.icon;return e.jsxs("div",{className:"flex gap-3 items-start",children:[e.jsx("div",{className:`w-8 h-8 ${a} rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0`,children:n.number}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx(c,{className:"h-4 w-4 text-primary"}),e.jsx("h4",{className:"font-semibold text-sm",children:n.title})]}),e.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed",children:n.description})]})]},l)})}),e.jsx(N,{asChild:!0,size:"sm",className:"w-full",children:e.jsx(U,{to:s.cta.link,children:s.cta.text})})]},t)})})]})]}),Ul=()=>e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ie,{}),e.jsxs("main",{className:"flex-1 pt-20",children:[e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(ss,{})}),e.jsx(Dl,{})]}),e.jsx(ne,{})]}),Ol=[{icon:Ee,value:"15,000+",label:"dossiers créés",bgColor:"bg-primary"},{icon:Ot,value:"48h",label:"vérification moyenne",bgColor:"bg-secondary"},{icon:ke,value:"3,500+",label:"logements vérifiés",bgColor:"bg-warning"},{icon:Ye,value:"98%",label:"satisfaction",bgColor:"bg-primary"}],Bl=[{icon:es,title:"Dossier Certifié",description:"Vérification ANSUT en 48h avec certification d'État reconnue par tous les propriétaires",bgColor:"bg-blue-600"},{icon:Ee,title:"Candidats Vérifiés",description:"Dossiers complets pré-vérifiés par l'État avec score de fiabilité de 0 à 100",bgColor:"bg-primary"},{icon:Bs,title:"Signature Numérique",description:"Bail électronique conforme à la loi ivoirienne avec paiements Mobile Money intégrés",bgColor:"bg-secondary"}],$l=[{name:"Aminata K.",profession:"Comptable",photo:"https://ui-avatars.com/api/?name=Aminata+Kone&size=100&background=E67E22&color=fff",quote:"J'ai trouvé mon appartement à Cocody en seulement 2 jours. Tout était vérifié !",rating:5},{name:"Konan M.",profession:"Ingénieur",photo:"https://ui-avatars.com/api/?name=Konan+Mensah&size=100&background=2C5F7F&color=fff",quote:"La certification ANSUT m'a vraiment rassuré. Fini les arnaques !",rating:5}],Gl=()=>e.jsx("section",{className:"py-16 bg-gray-50","aria-labelledby":"unified-trust-section",children:e.jsxs("div",{className:"container mx-auto px-4 max-w-7xl",children:[e.jsx("h2",{id:"unified-trust-section",className:"sr-only",children:"Confiance, fonctionnalités et témoignages"}),e.jsxs("div",{className:"mb-16",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h3",{className:"text-3xl font-bold text-foreground mb-2",children:"Votre confiance, notre priorité"}),e.jsx("div",{className:"h-1 w-20 bg-gradient-to-r from-primary to-secondary rounded-full mx-auto"})]}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:Ol.map((s,t)=>{const r=s.icon;return e.jsxs("div",{className:"flex flex-col items-center gap-3 p-4 bg-white rounded-2xl border border-primary/10 shadow-sm hover:shadow-lg transition-all duration-300 animate-fade-in",style:{animationDelay:`${t*100}ms`},children:[e.jsx("div",{className:`p-3 rounded-full ${s.bgColor} shadow-lg`,children:e.jsx(r,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl md:text-3xl font-black text-foreground mb-1",children:s.value}),e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:s.label})]})]},t)})})]}),e.jsxs("div",{className:"mb-16",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h3",{className:"text-3xl font-bold text-foreground mb-2",children:"Pourquoi choisir Mon Toit"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"Un service public au service de votre tranquillité"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:Bl.map((s,t)=>{const r=s.icon;return e.jsx(y,{className:"p-6 bg-white shadow-md hover:shadow-xl hover:scale-[1.02] transition-all duration-300 flex flex-col h-full",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:`${s.bgColor} p-4 rounded-full mb-4`,children:e.jsx(r,{className:"h-8 w-8 text-white"})}),e.jsx(z,{variant:"secondary",className:"mb-3 text-xs",children:"Service Public"}),e.jsx("h4",{className:"text-xl font-bold text-foreground mb-3",children:s.title}),e.jsx("p",{className:"text-muted-foreground leading-relaxed flex-1",children:s.description})]})},t)})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h3",{className:"text-3xl font-bold text-foreground mb-2",children:"Ils nous font confiance"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"Rejoignez des milliers d'Ivoiriens satisfaits"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:$l.map((s,t)=>e.jsxs(y,{className:"p-6 bg-white shadow-md hover:shadow-xl transition-all duration-300",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("img",{src:s.photo,alt:`Photo de ${s.name}`,className:"w-16 h-16 rounded-full flex-shrink-0",loading:"lazy"}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-foreground",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.profession})]}),e.jsx("div",{className:"flex gap-0.5",children:Array.from({length:s.rating}).map((r,a)=>e.jsx(ls,{className:"h-4 w-4 text-yellow-400 fill-yellow-400"},a))})]})})]}),e.jsxs("p",{className:"text-muted-foreground italic",children:['"',s.quote,'"']})]},t))})]})]})}),Hl=()=>e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ie,{}),e.jsxs("main",{className:"flex-1 pt-20",children:[e.jsxs("div",{className:"container mx-auto px-4 py-12",children:[e.jsx("h1",{className:"text-4xl font-bold mb-4",children:"À propos de Mon Toit"}),e.jsx("p",{className:"text-lg text-muted-foreground mb-8",children:"La plateforme immobilière certifiée par l'État ivoirien pour des locations sécurisées"})]}),e.jsx(Gl,{})]}),e.jsx(ne,{})]}),Ql=[{id:"school-1",name:"Lycée Classique d'Abidjan",type:"school",latitude:5.3244,longitude:-4.0125,neighborhood:"Plateau",description:"Lycée public prestigieux"},{id:"school-2",name:"Université Félix Houphouët-Boigny",type:"school",latitude:5.3599,longitude:-3.9889,neighborhood:"Cocody",description:"Principale université publique"},{id:"school-3",name:"École Internationale Jean-Mermoz",type:"school",latitude:5.3736,longitude:-3.9609,neighborhood:"Riviera",description:"École française internationale"},{id:"school-4",name:"Groupe Scolaire Sainte-Marie",type:"school",latitude:5.345,longitude:-4.005,neighborhood:"Cocody",description:"École catholique réputée"},{id:"transport-1",name:"Gare de Treichville",type:"transport",latitude:5.2869,longitude:-3.9967,neighborhood:"Treichville",description:"Principale gare routière"},{id:"transport-2",name:"Gare d'Adjamé",type:"transport",latitude:5.3536,longitude:-4.0236,neighborhood:"Adjamé",description:"Gare routière nord"},{id:"transport-3",name:"Gare de Yopougon",type:"transport",latitude:5.3369,longitude:-4.0894,neighborhood:"Yopougon",description:"Gare routière ouest"},{id:"transport-4",name:"Aéroport Félix Houphouët-Boigny",type:"transport",latitude:5.2539,longitude:-3.9263,neighborhood:"Port-Bouët",description:"Aéroport international"},{id:"hospital-1",name:"CHU de Cocody",type:"hospital",latitude:5.3599,longitude:-3.9789,neighborhood:"Cocody",description:"Centre hospitalier universitaire"},{id:"hospital-2",name:"CHU de Treichville",type:"hospital",latitude:5.29,longitude:-4.005,neighborhood:"Treichville",description:"Grand hôpital public"},{id:"hospital-3",name:"Polyclinique Internationale Sainte Anne-Marie",type:"hospital",latitude:5.365,longitude:-3.995,neighborhood:"Cocody",description:"Clinique privée moderne"},{id:"hospital-4",name:"Hôpital Général d'Abobo",type:"hospital",latitude:5.4167,longitude:-4.0167,neighborhood:"Abobo",description:"Hôpital général"},{id:"market-1",name:"Marché d'Adjamé",type:"market",latitude:5.3536,longitude:-4.0236,neighborhood:"Adjamé",description:"Plus grand marché d'Abidjan"},{id:"market-2",name:"Marché de Treichville",type:"market",latitude:5.2869,longitude:-3.9967,neighborhood:"Treichville",description:"Marché traditionnel"},{id:"market-3",name:"Marché de Cocody",type:"market",latitude:5.3599,longitude:-3.9889,neighborhood:"Cocody",description:"Marché moderne"},{id:"market-4",name:"Marché de Yopougon",type:"market",latitude:5.3369,longitude:-4.0894,neighborhood:"Yopougon",description:"Grand marché populaire"},{id:"mall-1",name:"Cap Sud",type:"mall",latitude:5.2869,longitude:-3.9867,neighborhood:"Marcory",description:"Centre commercial moderne"},{id:"mall-2",name:"Playce Marcory",type:"mall",latitude:5.29,longitude:-3.99,neighborhood:"Marcory",description:"Mall avec cinéma"},{id:"mall-3",name:"Cosmos Yopougon",type:"mall",latitude:5.34,longitude:-4.085,neighborhood:"Yopougon",description:"Centre commercial populaire"},{id:"mall-4",name:"Carrefour Marcory",type:"mall",latitude:5.285,longitude:-3.985,neighborhood:"Marcory",description:"Hypermarché Carrefour"},{id:"restaurant-1",name:"La Taverne Romaine",type:"restaurant",latitude:5.3244,longitude:-4.0125,neighborhood:"Plateau",description:"Restaurant italien haut de gamme"},{id:"restaurant-2",name:"Chez Amina",type:"restaurant",latitude:5.3599,longitude:-3.9889,neighborhood:"Cocody",description:"Cuisine ivoirienne authentique"},{id:"restaurant-3",name:"Le Bâteau Ivre",type:"restaurant",latitude:5.2869,longitude:-3.9967,neighborhood:"Treichville",description:"Restaurant français"},{id:"restaurant-4",name:"Maquis du Coin",type:"restaurant",latitude:5.3736,longitude:-3.9609,neighborhood:"Riviera",description:"Maquis traditionnel"}],Ds={school:{label:"Écoles",icon:"🏫",color:"#3b82f6"},transport:{label:"Transports",icon:"🚌",color:"#10b981"},hospital:{label:"Hôpitaux",icon:"🏥",color:"#ef4444"},market:{label:"Marchés",icon:"🛒",color:"#f59e0b"},mall:{label:"Centres commerciaux",icon:"🏬",color:"#8b5cf6"},restaurant:{label:"Restaurants",icon:"🍽️",color:"#ec4899"}},Kl=[{id:"cocody",name:"Cocody",bounds:{north:5.38,south:5.34,east:-3.96,west:-4.02},center:{latitude:5.3599,longitude:-3.9889},priceRange:{min:25e4,max:8e5,average:45e4},scores:{transport:8,commerce:9,education:10,security:9,healthcare:9},description:"Quartier résidentiel huppé d'Abidjan, abritant l'université et de nombreuses ambassades.",characteristics:["Quartier résidentiel calme","Nombreuses écoles internationales","Ambassades et institutions","Espaces verts","Sécurité renforcée"],population:4e5},{id:"plateau",name:"Plateau",bounds:{north:5.335,south:5.31,east:-4,west:-4.03},center:{latitude:5.3244,longitude:-4.0125},priceRange:{min:3e5,max:1e6,average:55e4},scores:{transport:10,commerce:10,education:8,security:9,healthcare:8},description:"Centre d'affaires et administratif d'Abidjan, cœur économique de la Côte d'Ivoire.",characteristics:["Centre d'affaires","Immeubles modernes","Banques et institutions","Restaurants haut de gamme","Vie nocturne animée"],population:15e3},{id:"marcory",name:"Marcory",bounds:{north:5.3,south:5.27,east:-3.97,west:-4.01},center:{latitude:5.2869,longitude:-3.9967},priceRange:{min:15e4,max:4e5,average:28e4},scores:{transport:7,commerce:8,education:7,security:7,healthcare:7},description:"Quartier mixte résidentiel et commercial, en pleine expansion avec de nombreux centres commerciaux.",characteristics:["Centres commerciaux modernes","Zone résidentielle en développement","Bon rapport qualité-prix","Accès facile au Plateau","Quartier familial"],population:3e5},{id:"riviera",name:"Riviera",bounds:{north:5.39,south:5.36,east:-3.94,west:-3.98},center:{latitude:5.3736,longitude:-3.9609},priceRange:{min:3e5,max:9e5,average:55e4},scores:{transport:7,commerce:8,education:9,security:9,healthcare:8},description:"Quartier résidentiel moderne et sécurisé, prisé par les expatriés et cadres supérieurs.",characteristics:["Résidences modernes","Golf et loisirs","Écoles internationales","Sécurité 24/7","Quartier calme"],population:2e5},{id:"treichville",name:"Treichville",bounds:{north:5.295,south:5.275,east:-3.985,west:-4.015},center:{latitude:5.2869,longitude:-3.9967},priceRange:{min:12e4,max:35e4,average:22e4},scores:{transport:9,commerce:9,education:6,security:6,healthcare:7},description:"Quartier populaire et animé, centre culturel avec le marché et la gare routière.",characteristics:["Quartier animé","Marché traditionnel","Vie nocturne","Transport facile","Prix abordables"],population:15e4},{id:"yopougon",name:"Yopougon",bounds:{north:5.36,south:5.31,east:-4.06,west:-4.12},center:{latitude:5.3369,longitude:-4.0894},priceRange:{min:8e4,max:25e4,average:15e4},scores:{transport:6,commerce:7,education:6,security:5,healthcare:6},description:"Plus grande commune d'Abidjan, quartier populaire avec de nombreux commerces.",characteristics:["Quartier populaire","Prix très abordables","Nombreux commerces","Marché important","Forte densité"],population:12e5},{id:"adjame",name:"Adjamé",bounds:{north:5.37,south:5.34,east:-4.01,west:-4.04},center:{latitude:5.3536,longitude:-4.0236},priceRange:{min:1e5,max:3e5,average:18e4},scores:{transport:10,commerce:10,education:6,security:6,healthcare:6},description:"Centre commercial majeur avec le plus grand marché d'Abidjan et la gare routière.",characteristics:["Plus grand marché","Hub de transport","Commerce intense","Quartier très animé","Prix compétitifs"],population:5e5},{id:"abobo",name:"Abobo",bounds:{north:5.44,south:5.39,east:-4,west:-4.04},center:{latitude:5.4167,longitude:-4.0167},priceRange:{min:7e4,max:2e5,average:12e4},scores:{transport:6,commerce:7,education:5,security:5,healthcare:6},description:"Commune populaire du nord d'Abidjan, en pleine expansion urbaine.",characteristics:["Quartier en expansion","Prix très accessibles","Jeune population","Commerces locaux","Forte croissance"],population:12e5},{id:"port-bouet",name:"Port-Bouët",bounds:{north:5.27,south:5.23,east:-3.91,west:-3.95},center:{latitude:5.2539,longitude:-3.9263},priceRange:{min:1e5,max:35e4,average:2e5},scores:{transport:9,commerce:7,education:6,security:7,healthcare:6},description:"Quartier abritant l'aéroport international, proche de la mer.",characteristics:["Proche aéroport","Accès à la plage","Zone industrielle","Transport international","Quartier mixte"],population:25e4},{id:"deux-plateaux",name:"Deux Plateaux",bounds:{north:5.37,south:5.35,east:-3.99,west:-4.01},center:{latitude:5.36,longitude:-4},priceRange:{min:2e5,max:6e5,average:38e4},scores:{transport:7,commerce:8,education:8,security:8,healthcare:8},description:"Quartier résidentiel moderne de Cocody, prisé par la classe moyenne supérieure.",characteristics:["Résidences modernes","Quartier sécurisé","Nombreux restaurants","Vie nocturne","Classe moyenne"],population:15e4}],Xl=s=>s<15e4?"#10b981":s<3e5?"#f59e0b":s<5e5?"#ef4444":"#8b5cf6",Wl=()=>localStorage.getItem("mapbox_token")||"",Yl={streets:"mapbox://styles/mapbox/streets-v12",satellite:"mapbox://styles/mapbox/satellite-v9",hybrid:"mapbox://styles/mapbox/satellite-streets-v12"},Jl=({properties:s,onPropertyClick:t,showHeatmap:r=!1,showClusters:a=!0,activePOILayers:n=[],showNeighborhoods:l=!1,onNeighborhoodClick:c})=>{const o=i.useRef(null),d=i.useRef(null),h=i.useRef([]),m=i.useRef([]),[x,j]=i.useState(!1),[p,u]=i.useState("streets"),[g]=i.useState(Wl()),C=i.useRef(null);i.useEffect(()=>{if(!(!o.current||d.current)){try{if(!g){T.warn("Mapbox token not configured");return}he.accessToken=g,d.current=new he.Map({container:o.current,style:Yl[p],center:[-4.0305,5.3599],zoom:11}),d.current.addControl(new he.NavigationControl,"top-right"),d.current.addControl(new he.FullscreenControl,"top-right"),d.current.on("load",()=>{j(!0),T.info("Map loaded successfully")}),d.current.on("moveend",()=>{a&&S()})}catch(b){T.logError(b,{context:"Map initialization"})}return()=>{var b;(b=d.current)==null||b.remove(),d.current=null}}},[p,g]),i.useEffect(()=>{if(!a||s.length===0)return;const b=s.map(f=>({type:"Feature",properties:{cluster:!1,propertyId:f.id,price:f.monthly_rent,title:f.title,city:f.city,image:f.main_image},geometry:{type:"Point",coordinates:[f.longitude,f.latitude]}}));C.current=new li({radius:60,maxZoom:16,minPoints:3}),C.current.load(b),S()},[s,a,x]);const S=()=>{if(!d.current||!C.current||!x)return;const b=d.current.getBounds(),f=Math.floor(d.current.getZoom()),v=C.current.getClusters([b.getWest(),b.getSouth(),b.getEast(),b.getNorth()],f);h.current.forEach(A=>A.remove()),h.current=[],v.forEach(A=>{const[V,B]=A.geometry.coordinates;if(A.properties.cluster){const D=A.properties.point_count,$=A.properties.cluster_id,W=C.current.getLeaves($,1/0),F=W.reduce((ye,Ge)=>ye+Ge.properties.price,0)/W.length,J=document.createElement("div");J.className="cluster-marker",J.innerHTML=`
          <div class="relative group cursor-pointer">
            <div class="absolute -inset-2 bg-gradient-to-r from-primary to-secondary rounded-full blur-md opacity-30 group-hover:opacity-50 transition-opacity"></div>
            <div class="relative w-16 h-16 rounded-full bg-gradient-to-br from-primary to-secondary border-3 border-white shadow-xl flex flex-col items-center justify-center text-white group-hover:scale-110 transition-transform">
              <span class="text-lg font-bold">${D}</span>
              <span class="text-xs opacity-90">${(F/1e3).toFixed(0)}k</span>
            </div>
          </div>
        `,J.addEventListener("click",()=>{const ye=C.current.getClusterExpansionZoom($);d.current.easeTo({center:[V,B],zoom:ye})});const ce=new he.Marker({element:J}).setLngLat([V,B]).addTo(d.current);h.current.push(ce)}else{const D=A.properties,$=document.createElement("div");$.className="property-marker",$.innerHTML=`
          <div class="relative group cursor-pointer">
            <div class="absolute -inset-1 bg-gradient-to-r from-primary to-secondary rounded-full blur opacity-25 group-hover:opacity-50 transition-opacity"></div>
            <div class="relative w-12 h-12 rounded-full bg-primary border-2 border-white shadow-lg flex items-center justify-center text-white font-bold text-xs group-hover:scale-110 transition-transform">
              ${(D.price/1e3).toFixed(0)}k
            </div>
          </div>
        `;const W=`
          <div class="min-w-[220px]">
            ${D.image?`
              <img 
                src="${D.image}" 
                alt="${D.title}"
                class="w-full h-32 object-cover rounded-t-lg mb-2"
              />
            `:""}
            <div class="p-3">
              <h3 class="font-semibold text-sm mb-2 text-foreground">${D.title}</h3>
              <div class="flex items-center gap-1 text-xs text-muted-foreground mb-2">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                </svg>
                <span>${D.city}</span>
              </div>
              <p class="text-base font-bold text-primary">${D.price.toLocaleString()} FCFA<span class="text-xs font-normal">/mois</span></p>
              <button class="mt-3 w-full px-3 py-1.5 bg-primary text-white rounded-md text-xs font-medium hover:bg-primary/90 transition-colors">
                Voir les détails
              </button>
            </div>
          </div>
        `,F=new he.Popup({offset:25,closeButton:!1,className:"property-popup"}).setHTML(W);$.addEventListener("click",()=>{t&&t(D.propertyId)});const J=new he.Marker({element:$}).setLngLat([V,B]).setPopup(F).addTo(d.current);h.current.push(J)}})};i.useEffect(()=>{if(!d.current||!x||!r)return;const b="properties-heatmap",f="price-heatmap";d.current.getLayer(f)&&d.current.removeLayer(f),d.current.getSource(b)&&d.current.removeSource(b),d.current.addSource(b,{type:"geojson",data:{type:"FeatureCollection",features:s.map(v=>({type:"Feature",properties:{price:v.monthly_rent},geometry:{type:"Point",coordinates:[v.longitude,v.latitude]}}))}}),d.current.addLayer({id:f,type:"heatmap",source:b,paint:{"heatmap-weight":["interpolate",["linear"],["get","price"],0,0,2e6,1],"heatmap-intensity":["interpolate",["linear"],["zoom"],0,1,15,3],"heatmap-color":["interpolate",["linear"],["heatmap-density"],0,"rgba(33,102,172,0)",.2,"rgb(103,169,207)",.4,"rgb(209,229,240)",.6,"rgb(253,219,199)",.8,"rgb(239,138,98)",1,"rgb(178,24,43)"],"heatmap-radius":["interpolate",["linear"],["zoom"],0,2,15,20],"heatmap-opacity":.6}})},[s,r,x]),i.useEffect(()=>{if(!d.current||!x)return;m.current.forEach(f=>f.remove()),m.current=[],Ql.filter(f=>n.includes(f.type)).forEach(f=>{const v=Ds[f.type],A=document.createElement("div");A.innerHTML=`
        <div class="poi-marker cursor-pointer">
          <div class="w-8 h-8 rounded-full flex items-center justify-center shadow-lg border-2 border-white hover:scale-110 transition-transform" style="background-color: ${v.color}">
            <span class="text-lg">${v.icon}</span>
          </div>
        </div>
      `;const V=new he.Popup({offset:25,closeButton:!1}).setHTML(`
          <div class="p-2">
            <p class="font-semibold text-sm">${f.name}</p>
            <p class="text-xs text-muted-foreground">${v.label}</p>
            ${f.description?`<p class="text-xs mt-1">${f.description}</p>`:""}
          </div>
        `),B=new he.Marker({element:A}).setLngLat([f.longitude,f.latitude]).setPopup(V).addTo(d.current);m.current.push(B)})},[n,x]),i.useEffect(()=>{!d.current||!x||!l||Kl.forEach((b,f)=>{const v=`neighborhood-${b.id}`,A=`neighborhood-layer-${b.id}`,V=`neighborhood-label-${b.id}`;d.current.getLayer(V)&&d.current.removeLayer(V),d.current.getLayer(A)&&d.current.removeLayer(A),d.current.getSource(v)&&d.current.removeSource(v);const B={type:"Feature",geometry:{type:"Polygon",coordinates:[[[b.bounds.west,b.bounds.north],[b.bounds.east,b.bounds.north],[b.bounds.east,b.bounds.south],[b.bounds.west,b.bounds.south],[b.bounds.west,b.bounds.north]]]},properties:{name:b.name,avgPrice:b.priceRange.average}};d.current.addSource(v,{type:"geojson",data:B});const Ce=Xl(b.priceRange.average);d.current.addLayer({id:A,type:"fill",source:v,paint:{"fill-color":Ce,"fill-opacity":.15}}),d.current.addLayer({id:`${A}-outline`,type:"line",source:v,paint:{"line-color":Ce,"line-width":2,"line-opacity":.5}}),d.current.addLayer({id:V,type:"symbol",source:v,layout:{"text-field":b.name,"text-size":14,"text-font":["Open Sans Bold","Arial Unicode MS Bold"]},paint:{"text-color":Ce,"text-halo-color":"#ffffff","text-halo-width":2}}),d.current.on("click",A,()=>{c&&c(b)}),d.current.on("mouseenter",A,()=>{d.current.getCanvas().style.cursor="pointer"}),d.current.on("mouseleave",A,()=>{d.current.getCanvas().style.cursor=""})})},[l,x,c]);const _=()=>{navigator.geolocation&&d.current&&navigator.geolocation.getCurrentPosition(b=>{d.current.flyTo({center:[b.coords.longitude,b.coords.latitude],zoom:14})},b=>T.logError(b,{context:"Geolocation"}))};return g?e.jsxs("div",{className:"relative h-full w-full",children:[e.jsx("div",{ref:o,className:"h-full w-full rounded-lg"}),e.jsxs("div",{className:"absolute top-4 left-4 flex flex-col gap-2 z-10",children:[e.jsx(R.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(N,{size:"icon",variant:"secondary",className:"shadow-lg bg-background/90 backdrop-blur-sm",onClick:_,children:e.jsx(Ft,{className:"h-4 w-4"})})}),e.jsx(R.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(N,{size:"icon",variant:"secondary",className:"shadow-lg bg-background/90 backdrop-blur-sm",onClick:()=>{var b;return(b=d.current)==null?void 0:b.zoomIn()},children:e.jsx(va,{className:"h-4 w-4"})})}),e.jsx(R.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(N,{size:"icon",variant:"secondary",className:"shadow-lg bg-background/90 backdrop-blur-sm",onClick:()=>{var b;return(b=d.current)==null?void 0:b.zoomOut()},children:e.jsx(ba,{className:"h-4 w-4"})})})]}),e.jsx("div",{className:"absolute top-4 right-4 flex gap-2 z-10",children:["streets","satellite","hybrid"].map(b=>e.jsx(R.div,{whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsxs(N,{size:"sm",variant:p===b?"default":"secondary",className:"shadow-lg bg-background/90 backdrop-blur-sm",onClick:()=>u(b),children:[b==="streets"&&e.jsx(ws,{className:"h-4 w-4 mr-1"}),b==="satellite"&&e.jsx(Vt,{className:"h-4 w-4 mr-1"}),b==="hybrid"&&e.jsx(us,{className:"h-4 w-4 mr-1"}),b.charAt(0).toUpperCase()+b.slice(1)]})},b))})]}):e.jsx("div",{className:"h-full flex items-center justify-center bg-muted/20",children:e.jsx("p",{className:"text-muted-foreground",children:"Mapbox token non configuré"})})},Zl=[{value:"piscine",label:"Piscine",icon:"🏊"},{value:"parking",label:"Parking",icon:"🚗"},{value:"securite",label:"Sécurité",icon:"🛡️"},{value:"jardin",label:"Jardin",icon:"🌳"},{value:"climatisation",label:"Climatisation",icon:"❄️"},{value:"meuble",label:"Meublé",icon:"🛋️"}],ec=({filters:s,onFiltersChange:t,stats:r})=>{const[a,n]=i.useState(!0),l=x=>{t({...s,minPrice:x[0],maxPrice:x[1]})},c=x=>{t({...s,minBedrooms:x[0],maxBedrooms:x[1]})},o=x=>{t({...s,propertyType:x})},d=x=>{const j=s.amenities.includes(x)?s.amenities.filter(p=>p!==x):[...s.amenities,x];t({...s,amenities:j})},h=()=>{t({minPrice:0,maxPrice:2e6,propertyType:"all",minBedrooms:1,maxBedrooms:5,amenities:[]})},m=x=>`${(x/1e3).toFixed(0)}k`;return e.jsxs(y,{className:"w-full max-w-sm bg-gradient-to-b from-background to-muted/20 border-border/50 shadow-lg",children:[e.jsx(P,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(E,{className:"flex items-center gap-2 text-lg",children:[e.jsx(Na,{className:"h-5 w-5 text-primary"}),"Filtres de recherche"]}),e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>n(!a),className:"h-8 w-8 p-0",children:e.jsx(R.div,{animate:{rotate:a?180:0},transition:{duration:.2},children:"▼"})})]})}),e.jsx(Cs,{children:a&&e.jsx(R.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:e.jsxs(k,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(R.div,{className:"p-3 rounded-lg bg-gradient-to-br from-primary/10 to-primary/5 border border-primary/20",whileHover:{scale:1.02},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ke,{className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Biens"})]}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:r.totalProperties})]}),e.jsxs(R.div,{className:"p-3 rounded-lg bg-gradient-to-br from-secondary/10 to-secondary/5 border border-secondary/20",whileHover:{scale:1.02},children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ye,{className:"h-4 w-4 text-secondary"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"Moy."})]}),e.jsx("p",{className:"text-lg font-bold text-secondary",children:m(r.avgPrice)})]})]}),e.jsx(Xe,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(L,{className:"flex items-center gap-2 text-sm font-semibold",children:[e.jsx(cs,{className:"h-4 w-4 text-primary"}),"Prix mensuel"]}),e.jsxs(z,{variant:"secondary",className:"text-xs",children:[m(s.minPrice)," - ",m(s.maxPrice)," FCFA"]})]}),e.jsx(Je,{min:0,max:2e6,step:5e4,value:[s.minPrice,s.maxPrice],onValueChange:l,className:"w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(L,{className:"flex items-center gap-2 text-sm font-semibold",children:[e.jsx(ee,{className:"h-4 w-4 text-primary"}),"Type de bien"]}),e.jsxs(fe,{value:s.propertyType,onValueChange:o,children:[e.jsx(ge,{children:e.jsx(je,{placeholder:"Tous les types"})}),e.jsxs(ve,{children:[e.jsx(M,{value:"all",children:"Tous les types"}),e.jsx(M,{value:"appartement",children:"Appartement"}),e.jsx(M,{value:"villa",children:"Villa"}),e.jsx(M,{value:"studio",children:"Studio"}),e.jsx(M,{value:"duplex",children:"Duplex"}),e.jsx(M,{value:"maison",children:"Maison"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(L,{className:"flex items-center gap-2 text-sm font-semibold",children:[e.jsx(Dt,{className:"h-4 w-4 text-primary"}),"Chambres"]}),e.jsxs(z,{variant:"secondary",className:"text-xs",children:[s.minBedrooms," - ",s.maxBedrooms]})]}),e.jsx(Je,{min:1,max:5,step:1,value:[s.minBedrooms,s.maxBedrooms],onValueChange:c,className:"w-full"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(L,{className:"flex items-center gap-2 text-sm font-semibold",children:[e.jsx(Ze,{className:"h-4 w-4 text-primary"}),"Équipements"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Zl.map(x=>e.jsx(R.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:e.jsxs("label",{className:`flex items-center gap-2 p-2 rounded-lg border cursor-pointer transition-all ${s.amenities.includes(x.value)?"bg-primary/10 border-primary":"bg-background border-border hover:border-primary/50"}`,children:[e.jsx(Le,{checked:s.amenities.includes(x.value),onCheckedChange:()=>d(x.value)}),e.jsx("span",{className:"text-lg",children:x.icon}),e.jsx("span",{className:"text-xs font-medium",children:x.label})]})},x.value))})]}),e.jsxs(N,{variant:"outline",className:"w-full",onClick:h,children:[e.jsx(Ut,{className:"h-4 w-4 mr-2"}),"Réinitialiser"]})]})})})]})},sc=({activeLayers:s,onLayerToggle:t})=>{const[r,a]=i.useState(!0);return e.jsxs(y,{className:"w-full bg-gradient-to-b from-background to-muted/20 border-border/50 shadow-lg",children:[e.jsx(P,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(E,{className:"flex items-center gap-2 text-lg",children:[e.jsx(us,{className:"h-5 w-5 text-primary"}),"Points d'intérêt"]}),e.jsx("button",{onClick:()=>a(!r),className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:r?"▼":"▶"})]})}),r&&e.jsxs(k,{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Affichez les lieux importants autour des biens"}),e.jsx(Xe,{}),e.jsx("div",{className:"space-y-2",children:Object.keys(Ds).map(n=>{const l=Ds[n],c=s.includes(n);return e.jsx(R.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:e.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${c?"bg-gradient-to-r from-primary/10 to-primary/5 border-primary":"bg-background border-border hover:border-primary/50"}`,children:[e.jsx(Le,{checked:c,onCheckedChange:()=>t(n)}),e.jsx("span",{className:"text-2xl",children:l.icon}),e.jsx("div",{className:"flex-1",children:e.jsx("p",{className:"text-sm font-medium",children:l.label})}),c&&e.jsx(z,{variant:"secondary",className:"text-xs",style:{backgroundColor:`${l.color}20`,color:l.color},children:"Actif"})]})},n)})}),e.jsx(Xe,{}),e.jsx("div",{className:"text-xs text-muted-foreground",children:e.jsxs("p",{children:[e.jsx("strong",{children:s.length})," couche",s.length>1?"s":""," active",s.length>1?"s":""]})})]})]})},tc=({neighborhood:s,onClose:t})=>{const r=c=>`${(c/1e3).toFixed(0)}k FCFA`,a=c=>c>=8?"text-green-500":c>=6?"text-orange-500":"text-red-500",n=c=>c>=8?"Excellent":c>=6?"Bon":c>=4?"Moyen":"Faible",l=Math.round((s.scores.transport+s.scores.commerce+s.scores.education+s.scores.security+s.scores.healthcare)/5);return e.jsx(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed bottom-4 left-4 right-4 lg:left-auto lg:right-4 lg:w-96 z-50",children:e.jsxs(y,{className:"shadow-2xl border-2 border-primary/20 bg-background/95 backdrop-blur-sm",children:[e.jsx(P,{className:"pb-3 bg-gradient-to-r from-primary/10 to-secondary/10",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(E,{className:"flex items-center gap-2 text-xl",children:[e.jsx(Ze,{className:"h-5 w-5 text-primary"}),s.name]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.description})]}),e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:t,children:e.jsx(_e,{className:"h-4 w-4"})})]})}),e.jsxs(k,{className:"space-y-4 pt-4 max-h-[60vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-gradient-to-r from-primary/10 to-secondary/10",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Note globale"}),e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[l,"/10"]})]}),e.jsx(z,{variant:"secondary",className:"text-lg px-4 py-2",children:n(l)})]}),e.jsx(Xe,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold",children:[e.jsx(cs,{className:"h-4 w-4 text-primary"}),"Fourchette de prix"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"p-2 rounded-lg bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Min"}),e.jsx("p",{className:"text-sm font-bold",children:r(s.priceRange.min)})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-primary/10",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Moyen"}),e.jsx("p",{className:"text-sm font-bold text-primary",children:r(s.priceRange.average)})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-muted/50",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Max"}),e.jsx("p",{className:"text-sm font-bold",children:r(s.priceRange.max)})]})]})]}),e.jsx(Xe,{}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Qualité de vie"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ya,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"Transports"})]}),e.jsxs("span",{className:`font-semibold ${a(s.scores.transport)}`,children:[s.scores.transport,"/10"]})]}),e.jsx(Ke,{value:s.scores.transport*10,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wa,{className:"h-4 w-4 text-orange-500"}),e.jsx("span",{children:"Commerces"})]}),e.jsxs("span",{className:`font-semibold ${a(s.scores.commerce)}`,children:[s.scores.commerce,"/10"]})]}),e.jsx(Ke,{value:s.scores.commerce*10,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ca,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{children:"Éducation"})]}),e.jsxs("span",{className:`font-semibold ${a(s.scores.education)}`,children:[s.scores.education,"/10"]})]}),e.jsx(Ke,{value:s.scores.education*10,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4 text-purple-500"}),e.jsx("span",{children:"Sécurité"})]}),e.jsxs("span",{className:`font-semibold ${a(s.scores.security)}`,children:[s.scores.security,"/10"]})]}),e.jsx(Ke,{value:s.scores.security*10,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{children:"Santé"})]}),e.jsxs("span",{className:`font-semibold ${a(s.scores.healthcare)}`,children:[s.scores.healthcare,"/10"]})]}),e.jsx(Ke,{value:s.scores.healthcare*10,className:"h-2"})]})]}),e.jsx(Xe,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-semibold",children:"Caractéristiques"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.characteristics.map((c,o)=>e.jsx(z,{variant:"secondary",className:"text-xs",children:c},o))})]}),s.population&&e.jsxs(e.Fragment,{children:[e.jsx(Xe,{}),e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Ee,{className:"h-4 w-4 text-primary"}),e.jsx("span",{children:"Population"})]}),e.jsx("span",{className:"font-semibold",children:s.population.toLocaleString()})]})]})]})]})})},rc=(s={})=>{const{filters:t,refetchInterval:r=3e4}=s;return $s({queryKey:["map-properties",t],queryFn:async()=>{try{let a=w.from("properties").select(`
            id,
            title,
            city,
            neighborhood,
            monthly_rent,
            latitude,
            longitude,
            main_image,
            property_type,
            bedrooms,
            bathrooms,
            surface_area,
            status,
            amenities
          `).eq("status","disponible").not("latitude","is",null).not("longitude","is",null);t!=null&&t.minPrice&&(a=a.gte("monthly_rent",t.minPrice)),t!=null&&t.maxPrice&&(a=a.lte("monthly_rent",t.maxPrice)),t!=null&&t.propertyType&&(a=a.eq("property_type",t.propertyType)),t!=null&&t.minBedrooms&&(a=a.gte("bedrooms",t.minBedrooms)),t!=null&&t.maxBedrooms&&(a=a.lte("bedrooms",t.maxBedrooms));const{data:n,error:l}=await a;if(l)throw T.logError(l,{context:"useMapProperties"}),l;let c=n||[];return t!=null&&t.amenities&&t.amenities.length>0&&(c=c.filter(o=>o.amenities?t.amenities.some(d=>o.amenities.includes(d)):!1)),T.info(`Loaded ${c.length} properties for map`,{filters:t,count:c.length}),c}catch(a){return T.logError(a,{context:"useMapProperties"}),[]}},refetchInterval:r,staleTime:2e4})},ac=s=>({totalProperties:s.length,avgPrice:s.length>0?Math.round(s.reduce((r,a)=>r+a.monthly_rent,0)/s.length):0,minPrice:s.length>0?Math.min(...s.map(r=>r.monthly_rent)):0,maxPrice:s.length>0?Math.max(...s.map(r=>r.monthly_rent)):0,neighborhoods:[...new Set(s.map(r=>r.neighborhood).filter(Boolean))].length,cities:[...new Set(s.map(r=>r.city))].length,propertyTypes:[...new Set(s.map(r=>r.property_type))].length}),ic=()=>{const s=Ie(),[t,r]=i.useState(!1),[a,n]=i.useState(!0),[l,c]=i.useState([]),[o,d]=i.useState(null),[h,m]=i.useState({minPrice:0,maxPrice:2e6,propertyType:"all",minBedrooms:1,maxBedrooms:5,amenities:[]}),x={minPrice:h.minPrice,maxPrice:h.maxPrice,propertyType:h.propertyType==="all"?void 0:h.propertyType,minBedrooms:h.minBedrooms,maxBedrooms:h.maxBedrooms,amenities:h.amenities.length>0?h.amenities:void 0},{data:j=[],isLoading:p,error:u}=rc({filters:x,refetchInterval:3e4}),g=ac(j),C=b=>{s(`/properties/${b}`)},S=b=>{c(f=>f.includes(b)?f.filter(v=>v!==b):[...f,b])},_=b=>{d(b)};return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(ie,{}),e.jsxs("main",{className:"flex-1 pt-24",children:[e.jsxs("section",{className:"relative py-8 bg-gradient-to-r from-primary/10 via-secondary/5 to-primary/10",children:[e.jsx(_s,{}),e.jsx("div",{className:"container mx-auto px-4 relative z-10",children:e.jsx("div",{className:"text-center max-w-3xl mx-auto",children:e.jsxs(R.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs(z,{variant:"secondary",className:"mb-4",children:[e.jsx(ws,{className:"h-3 w-3 mr-1"}),"Carte Intelligente V2"]}),e.jsxs("h1",{className:"text-h1 mb-4",children:["Explorez ",e.jsx("span",{className:"text-gradient-primary",children:"Abidjan"})," intelligemment"]}),e.jsx("p",{className:"text-body-lg text-muted-foreground",children:"Découvrez les biens avec clustering, heatmap, POI, zones de quartiers et analyse complète"})]})})})]}),e.jsx("section",{className:"py-8",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[e.jsx(R.div,{className:"lg:w-80 flex-shrink-0 space-y-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},children:p?e.jsxs(y,{className:"p-6",children:[e.jsx(ze,{className:"h-8 w-full mb-4"}),e.jsx(ze,{className:"h-32 w-full mb-4"}),e.jsx(ze,{className:"h-8 w-full mb-4"}),e.jsx(ze,{className:"h-32 w-full"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ec,{filters:h,onFiltersChange:m,stats:g}),e.jsxs(y,{className:"p-4 bg-gradient-to-br from-secondary/10 to-secondary/5 border-secondary/20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ct,{className:"h-4 w-4 text-secondary"}),e.jsx("span",{className:"text-sm font-semibold",children:"Heatmap des prix"})]}),e.jsx(N,{size:"sm",variant:t?"default":"outline",onClick:()=>r(!t),children:t?e.jsx(ns,{className:"h-4 w-4"}):e.jsx(Ns,{className:"h-4 w-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Visualisez les zones de prix sur la carte"})]}),e.jsxs(y,{className:"p-4 bg-gradient-to-br from-primary/10 to-primary/5 border-primary/20",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ot,{className:"h-4 w-4 text-primary"}),e.jsx(L,{htmlFor:"neighborhoods-toggle",className:"text-sm font-semibold cursor-pointer",children:"Zones de quartiers"})]}),e.jsx(Oe,{id:"neighborhoods-toggle",checked:a,onCheckedChange:n})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Afficher les délimitations et prix par quartier"})]}),e.jsx(sc,{activeLayers:l,onLayerToggle:S}),e.jsxs(y,{className:"p-4",children:[e.jsxs("h3",{className:"text-sm font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Ye,{className:"h-4 w-4 text-primary"}),"Statistiques rapides"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Quartiers"}),e.jsx("span",{className:"font-semibold",children:g.neighborhoods})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Prix min"}),e.jsxs("span",{className:"font-semibold",children:[(g.minPrice/1e3).toFixed(0),"k FCFA"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Prix max"}),e.jsxs("span",{className:"font-semibold",children:[(g.maxPrice/1e3).toFixed(0),"k FCFA"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"POI actifs"}),e.jsx("span",{className:"font-semibold",children:l.length})]})]})]})]})}),e.jsx(R.div,{className:"flex-1 min-h-[600px] lg:min-h-[800px]",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.3},children:e.jsx(y,{className:"h-full overflow-hidden shadow-2xl border-border/50",children:p?e.jsx("div",{className:"h-full flex items-center justify-center bg-muted/20",children:e.jsxs("div",{className:"text-center",children:[e.jsx(us,{className:"h-12 w-12 text-primary mx-auto mb-4 animate-pulse"}),e.jsx("p",{className:"text-muted-foreground",children:"Chargement de la carte..."})]})}):u?e.jsx("div",{className:"h-full flex items-center justify-center bg-muted/20",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-destructive mb-2",children:"Erreur de chargement"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Impossible de charger les propriétés"})]})}):e.jsx(Jl,{properties:j,onPropertyClick:C,showHeatmap:t,showClusters:!0,activePOILayers:l,showNeighborhoods:a,onNeighborhoodClick:_})})})]})})}),e.jsx(Cs,{children:o&&e.jsx(tc,{neighborhood:o,onClose:()=>d(null)})}),e.jsx("section",{className:"py-12 bg-muted/20",children:e.jsx("div",{className:"container mx-auto px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[e.jsxs("h2",{className:"text-h2 mb-6",children:["Une carte ",e.jsx("span",{className:"text-gradient-secondary",children:"vraiment intelligente"})]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-6 mt-8",children:[e.jsxs(y,{className:"p-6 hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(us,{className:"h-6 w-6 text-primary"})}),e.jsx("h3",{className:"font-semibold mb-2",children:"Clustering"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Regroupement intelligent des biens"})]}),e.jsxs(y,{className:"p-6 hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-secondary/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(ct,{className:"h-6 w-6 text-secondary"})}),e.jsx("h3",{className:"font-semibold mb-2",children:"Heatmap"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Zones de prix visualisées"})]}),e.jsxs(y,{className:"p-6 hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(ot,{className:"h-6 w-6 text-primary"})}),e.jsx("h3",{className:"font-semibold mb-2",children:"POI"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Écoles, transports, commerces"})]}),e.jsxs(y,{className:"p-6 hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-secondary/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(Ye,{className:"h-6 w-6 text-secondary"})}),e.jsx("h3",{className:"font-semibold mb-2",children:"Analyse"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Statistiques par quartier"})]})]})]})})})]}),e.jsx(ne,{})]})};function nc(){const s=Ie();return e.jsxs("div",{className:"container max-w-5xl py-8 space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs(N,{variant:"ghost",onClick:()=>s(-1),className:"gap-2",children:[e.jsx(Gs,{className:"h-4 w-4"}),"Retour"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Guide des Mandats d'Agence"}),e.jsx("p",{className:"text-lg text-muted-foreground",children:"Tout savoir sur le système de mandats entre propriétaires et agences immobilières"})]})]}),e.jsxs(y,{children:[e.jsx(P,{children:e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-5 w-5"}),"Qu'est-ce qu'un mandat d'agence ?"]})}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("p",{children:["Un ",e.jsx("strong",{children:"mandat d'agence"})," est un contrat par lequel un propriétaire autorise une agence immobilière à gérer un ou plusieurs de ses biens. Ce mandat définit les permissions, la rémunération et la durée de la collaboration."]}),e.jsxs(be,{children:[e.jsx(Ve,{className:"h-4 w-4"}),e.jsx(Ne,{children:"Les mandats sont sécurisés et traçables. Chaque action effectuée dans le cadre d'un mandat est enregistrée."})]})]})]}),e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(E,{children:"Types de mandats"}),e.jsx(O,{children:"Trois types de mandats sont disponibles selon vos besoins"})]}),e.jsx(k,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"border rounded-lg p-4 space-y-2",children:[e.jsx(z,{variant:"default",children:"Location"}),e.jsx("h4",{className:"font-semibold",children:"Mandat de location"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"L'agence gère la recherche de locataires et la signature des baux pour vos biens en location."})]}),e.jsxs("div",{className:"border rounded-lg p-4 space-y-2",children:[e.jsx(z,{variant:"default",children:"Gestion complète"}),e.jsx("h4",{className:"font-semibold",children:"Mandat de gestion complète"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"L'agence gère l'intégralité de vos biens : location, maintenance, finances, relations locataires."})]}),e.jsxs("div",{className:"border rounded-lg p-4 space-y-2",children:[e.jsx(z,{variant:"default",children:"Vente"}),e.jsx("h4",{className:"font-semibold",children:"Mandat de vente"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"L'agence est chargée de vendre votre bien aux meilleures conditions du marché."})]})]})})]}),e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(E,{children:"Portée du mandat"}),e.jsx(O,{children:"Mandat spécifique vs mandat global"})]}),e.jsx(k,{className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"border rounded-lg p-4 space-y-2",children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(ke,{className:"h-4 w-4"}),"Mandat spécifique"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Le mandat concerne ",e.jsx("strong",{children:"un bien précis"}),". L'agence ne peut gérer que ce bien."]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["✓ Idéal pour tester une collaboration",e.jsx("br",{}),"✓ Contrôle fin par bien"]})]}),e.jsxs("div",{className:"border rounded-lg p-4 space-y-2",children:[e.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[e.jsx(ke,{className:"h-4 w-4"}),"Mandat global"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Le mandat couvre ",e.jsx("strong",{children:"tous vos biens actuels et futurs"}),". L'agence gère l'ensemble de votre portefeuille."]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["✓ Gestion centralisée",e.jsx("br",{}),"✓ Gain de temps pour les grands propriétaires"]})]})]})})]}),e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(E,{children:"Permissions disponibles"}),e.jsx(O,{children:"Choisissez précisément ce que l'agence peut faire"})]}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(ke,{className:"h-4 w-4"}),"Gestion des propriétés"]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded",children:[e.jsx(ns,{className:"h-5 w-5 text-muted-foreground shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Voir les propriétés"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Accès en lecture seule aux fiches des biens"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded",children:[e.jsx(dt,{className:"h-5 w-5 text-muted-foreground shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Modifier les propriétés"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Mettre à jour prix, description, photos, etc."})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded",children:[e.jsx(Re,{className:"h-5 w-5 text-muted-foreground shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Créer des propriétés"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ajouter de nouveaux biens à votre portefeuille"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4"}),"Gestion des candidatures"]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded",children:[e.jsx(ns,{className:"h-5 w-5 text-muted-foreground shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Voir les candidatures"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Consulter les dossiers des candidats locataires"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded",children:[e.jsx(dt,{className:"h-5 w-5 text-muted-foreground shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Gérer les candidatures"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Accepter, refuser ou mettre en attente des candidats"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(mt,{className:"h-4 w-4"}),"Autres permissions"]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded",children:[e.jsx(Re,{className:"h-5 w-5 text-muted-foreground shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Créer des baux"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Générer et signer des contrats de location"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded",children:[e.jsx(cs,{className:"h-5 w-5 text-muted-foreground shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Voir les finances"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Accès aux paiements et statistiques financières"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded",children:[e.jsx(mt,{className:"h-5 w-5 text-muted-foreground shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Gérer la maintenance"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Traiter les demandes de réparation et travaux"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 border rounded",children:[e.jsx(Re,{className:"h-5 w-5 text-muted-foreground shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Gérer les documents"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Uploader et organiser les documents des biens"})]})]})]})]})]})})]}),e.jsxs(y,{children:[e.jsxs(P,{children:[e.jsx(E,{children:"Cycle de vie d'un mandat"}),e.jsx(O,{children:"Les différentes étapes d'un mandat"})]}),e.jsx(k,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-secondary text-secondary-foreground font-bold shrink-0",children:"1"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold",children:["Invitation ",e.jsx(z,{variant:"secondary",children:"En attente"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Le propriétaire crée un mandat et invite l'agence. L'agence reçoit une notification."})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-secondary text-secondary-foreground font-bold shrink-0",children:"2"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold",children:["Acceptation ",e.jsx(z,{variant:"default",children:"Actif"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"L'agence accepte le mandat. Les permissions sont activées et l'agence peut commencer la gestion."})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-secondary text-secondary-foreground font-bold shrink-0",children:"3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Gestion active"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"L'agence gère les biens selon les permissions accordées. Le propriétaire garde le contrôle et peut ajuster les permissions."})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-secondary text-secondary-foreground font-bold shrink-0",children:"4"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold",children:["Fin du mandat ",e.jsx(z,{variant:"destructive",children:"Résilié"})," ou ",e.jsx(z,{variant:"outline",children:"Expiré"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Le mandat prend fin soit par résiliation (propriétaire ou agence), soit automatiquement à la date de fin prévue."})]})]})]})})]}),e.jsxs(y,{children:[e.jsx(P,{children:e.jsx(E,{children:"Questions fréquentes (FAQ)"})}),e.jsx(k,{children:e.jsxs(Ue,{type:"single",collapsible:!0,className:"w-full",children:[e.jsxs(G,{value:"item-1",children:[e.jsx(H,{children:"Comment inviter une agence ?"}),e.jsx(Q,{className:"text-muted-foreground",children:`Depuis votre page "Mes Mandats", cliquez sur "Inviter une agence". Sélectionnez l'agence, le type de mandat, les permissions souhaitées et les conditions financières. L'agence recevra une notification et pourra accepter ou refuser.`})]}),e.jsxs(G,{value:"item-2",children:[e.jsx(H,{children:"Puis-je modifier les permissions après acceptation ?"}),e.jsx(Q,{className:"text-muted-foreground",children:'Oui ! En tant que propriétaire, vous pouvez à tout moment modifier les permissions accordées à une agence. Depuis la page "Mes Mandats", cliquez sur "Modifier les permissions" sur le mandat concerné.'})]}),e.jsxs(G,{value:"item-3",children:[e.jsx(H,{children:"Comment résilier un mandat ?"}),e.jsx(Q,{className:"text-muted-foreground",children:`Le propriétaire et l'agence peuvent tous deux résilier un mandat. Cliquez sur "Résilier" sur la carte du mandat, indiquez un motif, et confirmez. La résiliation est immédiate et l'agence perd toutes les permissions associées.`})]}),e.jsxs(G,{value:"item-4",children:[e.jsx(H,{children:"Quelle est la différence entre commission et frais fixes ?"}),e.jsxs(Q,{className:"text-muted-foreground",children:[e.jsx("strong",{children:"Commission"})," : Pourcentage sur les loyers collectés (ex: 10% du loyer mensuel).",e.jsx("br",{}),e.jsx("strong",{children:"Frais fixes"})," : Montant fixe par période (ex: 50 000 FCFA/mois).",e.jsx("br",{}),"Vous pouvez choisir l'un ou l'autre, ou combiner les deux selon votre accord avec l'agence."]})]}),e.jsxs(G,{value:"item-5",children:[e.jsx(H,{children:"Que se passe-t-il si je supprime un bien sous mandat ?"}),e.jsx(Q,{className:"text-muted-foreground",children:"Si vous supprimez un bien couvert par un mandat spécifique, le mandat reste actif mais sans bien associé. Pour un mandat global, seul ce bien est retiré, les autres restent gérés par l'agence."})]}),e.jsxs(G,{value:"item-6",children:[e.jsx(H,{children:"Puis-je avoir plusieurs mandats avec différentes agences ?"}),e.jsx(Q,{className:"text-muted-foreground",children:"Oui, mais attention : évitez d'avoir plusieurs mandats actifs pour le même bien. Le système vous alertera si vous tentez de créer un mandat en doublon."})]})]})})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(N,{onClick:()=>s(-1),size:"lg",children:"Retour à mes mandats"})})]})}const lc=i.lazy(()=>ae(()=>import("./route-property-b6Ka_7KN.js").then(s=>s.p),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9,12,13,10,14]))),cc=i.lazy(()=>ae(()=>import("./Offline-C6ZhGoZj.js"),__vite__mapDeps([19,1,2,3,4,5,6,7,8,9,10]))),oc=i.lazy(()=>ae(()=>import("./route-tenant-DNBKfVUX.js").then(s=>s.D),__vite__mapDeps([15,1,2,3,4,5,6,7,8,9,10,12,13,11,14]))),dc=i.lazy(()=>ae(()=>import("./route-admin-B1Ip8YDE.js").then(s=>s.b4),__vite__mapDeps([7,1,2,3,4,5,6,8,9]))),mc=i.lazy(()=>ae(()=>import("./route-admin-B1Ip8YDE.js").then(s=>s.b5),__vite__mapDeps([7,1,2,3,4,5,6,8,9]))),uc=i.lazy(()=>ae(()=>import("./route-owner-C83ejxxl.js").then(s=>s.O),__vite__mapDeps([12,1,2,3,4,5,6,7,8,9,13,10]))),xc=i.lazy(()=>ae(()=>import("./route-tenant-DNBKfVUX.js").then(s=>s.T),__vite__mapDeps([15,1,2,3,4,5,6,7,8,9,10,12,13,11,14]))),hc=i.lazy(()=>ae(()=>import("./route-agency-BEE2sWoQ.js").then(s=>s.A),__vite__mapDeps([13,1,2,3,4,5,6,7,8,9,10]))),pc=i.lazy(()=>ae(()=>import("./MyMandates-4dUaJinv.js"),__vite__mapDeps([20,1,2,3,4,5,6,7,8,9,13,10,14,11,12,15,16,17]))),fc=i.lazy(()=>ae(()=>import("./route-owner-C83ejxxl.js").then(s=>s.M),__vite__mapDeps([12,1,2,3,4,5,6,7,8,9,13,10]))),gc=i.lazy(()=>ae(()=>import("./AddProperty-B0ajWnQ5.js"),__vite__mapDeps([21,1,2,3,4,5,6,22,14,7,8,9,11,12,13,10,16,17,23,24,15]))),jc=i.lazy(()=>ae(()=>import("./EditProperty-gNlv7Mkn.js"),__vite__mapDeps([25,1,2,3,4,5,6,22,14,7,8,9,11,12,13,10,16,17,23,24]))),vc=i.lazy(()=>ae(()=>import("./Messages-_muaW2ep.js"),__vite__mapDeps([26,1,2,3,4,5,6,7,8,9,12,13,10]))),bc=i.lazy(()=>ae(()=>import("./Application-Bjaa90b3.js"),__vite__mapDeps([27,1,2,3,4,5,6,7,8,9,12,13,10,23,24,11,14]))),Nc=i.lazy(()=>ae(()=>import("./Applications-RUk__IqI.js"),__vite__mapDeps([28,1,2,3,4,5,6,7,8,9,12,13,10,11,14,15,16,17]))),yc=i.lazy(()=>ae(()=>import("./Leases-DmBdttAl.js"),__vite__mapDeps([29,1,2,3,4,5,6,7,8,9,12,13,10,14,11,15,16,17]))),wc=i.lazy(()=>ae(()=>import("./Payments-BqGMhMEA.js"),__vite__mapDeps([30,1,2,3,4,5,6,7,8,9,12,13,10]))),Cc=i.lazy(()=>ae(()=>import("./Maintenance-Ck1SRhR6.js"),__vite__mapDeps([31,1,2,3,4,5,6,7,8,9,12,13,10]))),Sc=i.lazy(()=>ae(()=>import("./ScheduleVisit-Dk2FBewP.js"),__vite__mapDeps([32,1,2,3,4,5,6,7,8,9,12,13,10,24]))),_c=()=>{Ui(),Oi();const s=ys(),t=i.useRef(s.pathname),[r,a]=i.useState("right");return i.useEffect(()=>{const n=["/","/recherche","/favoris","/messages","/profil"],l=n.indexOf(s.pathname),c=n.indexOf(t.current);l!==-1&&c!==-1&&a(l>c?"right":"left"),t.current=s.pathname},[s.pathname]),e.jsxs(e.Fragment,{children:[e.jsx(cn,{}),e.jsx(nn,{}),e.jsx(ln,{}),e.jsx("a",{href:"#main-content",className:"skip-to-main",children:"Aller au contenu principal"}),e.jsx(an,{}),e.jsx(Di,{}),e.jsx("main",{id:"main-content",tabIndex:-1,children:e.jsx("div",{className:te("animate-in duration-200",r==="right"?"slide-in-from-right-4":"slide-in-from-left-4"),children:e.jsxs(ka,{children:[e.jsx(q,{path:"/",element:e.jsx(gn,{})}),e.jsx(q,{path:"/offline",element:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(cc,{})})}),e.jsx(q,{path:"/recherche",element:e.jsx(qn,{})}),e.jsx(q,{path:"/explorer",element:e.jsx(Fl,{})}),e.jsx(q,{path:"/carte-intelligente",element:e.jsx(ic,{})}),e.jsx(q,{path:"/comment-ca-marche",element:e.jsx(Ul,{})}),e.jsx(q,{path:"/a-propos",element:e.jsx(Hl,{})}),e.jsx(q,{path:"/property/:id",element:e.jsx(i.Suspense,{fallback:e.jsx(Hi,{}),children:e.jsx(lc,{})})}),e.jsx(q,{path:"/certification",element:e.jsx(Vn,{})}),e.jsx(q,{path:"/auth",element:e.jsx(_n,{})}),e.jsx(q,{path:"/reset-password",element:e.jsx(Un,{})}),e.jsx(q,{path:"/guide",element:e.jsx(zl,{})}),e.jsx(q,{path:"/profil",element:e.jsx(Z,{children:e.jsx(Xn,{})})}),e.jsx(q,{path:"/dashboard",element:e.jsx(Z,{children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(oc,{})})})}),e.jsx(q,{path:"/admin",element:e.jsx(Z,{requiredRoles:["admin","super_admin"],children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(dc,{})})})}),e.jsx(q,{path:"/admin/certifications",element:e.jsx(Z,{requiredRoles:["admin","super_admin"],children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(mc,{})})})}),e.jsx(q,{path:"/analytics",element:e.jsx(Z,{allowedUserTypes:["proprietaire","agence"],children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(uc,{})})})}),e.jsx(q,{path:"/dashboard/tenant",element:e.jsx(Z,{allowedUserTypes:["locataire"],children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(xc,{})})})}),e.jsx(q,{path:"/tiers-dashboard",element:e.jsx(Z,{requiredRoles:["tiers_de_confiance"],children:e.jsx(Sl,{})})}),e.jsx(q,{path:"/dashboard/agence",element:e.jsx(Z,{allowedUserTypes:["agence"],children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(hc,{})})})}),e.jsx(q,{path:"/my-mandates",element:e.jsx(Z,{allowedUserTypes:["proprietaire","agence"],children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(pc,{})})})}),e.jsx(q,{path:"/mandates/help",element:e.jsx(Z,{allowedUserTypes:["proprietaire","agence"],children:e.jsx(nc,{})})}),e.jsx(q,{path:"/owner/guest-messages",element:e.jsx(Z,{allowedUserTypes:["proprietaire","agence"],children:e.jsx(tl,{})})}),e.jsx(q,{path:"/favoris",element:e.jsx(Z,{children:e.jsx(Wn,{})})}),e.jsx(q,{path:"/messages",element:e.jsx(Z,{children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(vc,{})})})}),e.jsx(q,{path:"/mes-biens",element:e.jsx(Z,{allowedUserTypes:["proprietaire","agence"],children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(fc,{})})})}),e.jsx(q,{path:"/ajouter-bien",element:e.jsx(Z,{allowedUserTypes:["proprietaire","agence"],children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(gc,{})})})}),e.jsx(q,{path:"/biens/:id/modifier",element:e.jsx(Z,{allowedUserTypes:["proprietaire","agence"],children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(jc,{})})})}),e.jsx(q,{path:"/biens/:id/candidatures",element:e.jsx(Z,{allowedUserTypes:["proprietaire","agence"],children:e.jsx(vi,{})})}),e.jsx(q,{path:"/maintenance/:propertyId",element:e.jsx(Z,{children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(Cc,{})})})}),e.jsx(q,{path:"/application/:propertyId",element:e.jsx(Z,{children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(bc,{})})})}),e.jsx(q,{path:"/schedule-visit/:propertyId",element:e.jsx(Z,{children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(Sc,{})})})}),e.jsx(q,{path:"/candidatures",element:e.jsx(Z,{children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(Nc,{})})})}),e.jsx(q,{path:"/baux",element:e.jsx(Z,{children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(yc,{})})})}),e.jsx(q,{path:"/payments",element:e.jsx(Z,{children:e.jsx(i.Suspense,{fallback:e.jsx(ue,{}),children:e.jsx(wc,{})})})}),e.jsx(q,{path:"/verification",element:e.jsx(Z,{children:e.jsx(sl,{})})}),e.jsx(q,{path:"/user/:userId/reviews",element:e.jsx(il,{})}),e.jsx(q,{path:"/publier",element:e.jsx(nl,{})}),e.jsx(q,{path:"/a-propos",element:e.jsx(jl,{})}),e.jsx(q,{path:"/conditions",element:e.jsx(vl,{})}),e.jsx(q,{path:"/confidentialite",element:e.jsx(bl,{})}),e.jsx(q,{path:"/mentions-legales",element:e.jsx(Nl,{})}),e.jsx(q,{path:"/certification-faq",element:e.jsx(_l,{})}),e.jsx(q,{path:"/tarifs",element:e.jsx(Al,{})}),e.jsx(q,{path:"/populate-images",element:e.jsx(Z,{requiredRoles:["admin","super_admin"],children:e.jsx(Tl,{})})}),e.jsx(q,{path:"/test-cryptoneo",element:e.jsx(Z,{requiredRoles:["admin","super_admin"],children:e.jsx(Ll,{})})}),e.jsx(q,{path:"*",element:e.jsx(rl,{})})]})},s.pathname)}),e.jsx(Gi,{})]})},kc=()=>e.jsx(Sa,{children:e.jsx(Ht,{client:Ss,children:e.jsxs(Xa,{children:[e.jsx(Ri,{}),e.jsx(qi,{}),e.jsx(_a,{children:e.jsx(Wa,{children:e.jsx(_c,{})})})]})})});Aa({dsn:"",environment:"production",integrations:[Ai(),Ti({maskAllText:!1,blockAllMedia:!1})],tracesSampleRate:1,replaysSessionSampleRate:.1,replaysOnErrorSampleRate:1,beforeSend(s,t){var a,n,l,c;const r=localStorage.getItem("supabase.auth.token");return r&&(s.user={...s.user,id:r}),(c=(l=(n=(a=s.exception)==null?void 0:a.values)==null?void 0:n[0])==null?void 0:l.value)!=null&&c.includes("ResizeObserver")?null:s},ignoreErrors:["ResizeObserver loop limit exceeded","Non-Error promise rejection captured","ChunkLoadError"]}),Mi();Ta(document.getElementById("root")).render(e.jsx(Pa.StrictMode,{children:e.jsx(Ht,{client:Ss,children:e.jsx(kc,{})})}));export{Il as E,wn as N,En as P,yl as T,Zi as a,In as p,Gc as q,Ln as u};
//# sourceMappingURL=index-LMib0YFl.js.map
