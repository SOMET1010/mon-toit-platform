import{r as a,j as e,bC as _,bz as k,ah as v,c3 as w}from"./react-vendor-CPmH2tz8.js";import{u as A,l as o,aX as R,W as n,B as c}from"./route-admin-B1Ip8YDE.js";import{P}from"./route-agency-BEE2sWoQ.js";import{p as T}from"./index-LMib0YFl.js";import{a as I}from"./route-property-b6Ka_7KN.js";import{cj as D}from"./common-vendor-CK5d0rWc.js";import"./query-vendor-ByjIuei6.js";import"./monitoring-vendor-C7yD_Gmu.js";import"./ui-vendor-Dua12RDV.js";import"./charts-vendor-16YcNskv.js";import"./supabase-vendor-CzsKfTY-.js";import"./animation-vendor-BJe5VoH_.js";import"./route-tenant-DNBKfVUX.js";import"./route-owner-C83ejxxl.js";import"./forms-vendor-DqOZ4YtP.js";import"./maps-vendor-B7X9GnXQ.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t.SENTRY_RELEASE={id:"b65e2d84341e79b518aed72b6e71dcc77eba934a"}}catch{}})();try{(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},i=new t.Error().stack;i&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[i]="610a776e-b02c-454f-b889-0e21eadc7391",t._sentryDebugIdIdentifier="sentry-dbid-610a776e-b02c-454f-b889-0e21eadc7391")})()}catch{}const Z=({limit:t=6})=>{const[i,h]=a.useState([]),[j,m]=a.useState(!0),[p,g]=a.useState(null),[u,x]=a.useState(!1),[l,y]=a.useState("Tous"),{toggleFavorite:N,isFavorite:C}=I(),{user:b}=A(),d=a.useCallback(async()=>{try{m(!0),g(null),o.debug("Fetching featured properties");const s=await T.fetchAll();if(o.debug("Featured properties data received",{count:(s==null?void 0:s.length)||0}),!s||s.length===0){o.warn("No properties returned from API"),h([]),m(!1),x(!1);return}const r=s.sort((f,z)=>(z.view_count||0)-(f.view_count||0)).slice(0,t);o.info("Featured properties prepared",{count:r.length}),h(r)}catch(s){o.logError(s,{context:"fetchFeaturedProperties"});let r="Impossible de charger les biens en vedette. Veuillez réessayer.";s instanceof Error&&(s.message.includes("Failed to fetch")||s.message.includes("network")?r="Problème de connexion. Vérifiez votre connexion internet.":s.message.includes("JWT")||s.message.includes("auth")?r="Session expirée. Veuillez vous reconnecter.":(s.message.includes("not found")||s.message.includes("404"))&&(r="Service temporairement indisponible. Réessayez dans quelques instants.")),g(r),R(s,r)}finally{m(!1),x(!1)}},[t]);a.useEffect(()=>{d()},[d]);const F=a.useCallback(async()=>{x(!0),await d()},[d]),S=a.useMemo(()=>l==="Tous"?i:i.filter(s=>l==="Appartements"?s.property_type.toLowerCase().includes("appartement"):l==="Villas"?s.property_type.toLowerCase().includes("villa"):l==="Studios"?s.property_type.toLowerCase().includes("studio"):!0),[i,l]),E=a.useMemo(()=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden shadow-md",children:[e.jsx(n,{className:"h-56 w-full rounded-none"}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx(n,{className:"h-6 w-3/4"}),e.jsx(n,{className:"h-4 w-1/2"}),e.jsxs("div",{className:"flex items-center gap-4 pt-2",children:[e.jsx(n,{className:"h-4 w-16"}),e.jsx(n,{className:"h-4 w-16"}),e.jsx(n,{className:"h-4 w-16"})]}),e.jsx(n,{className:"h-8 w-full mt-4"})]})]}),[]);return j?e.jsx("div",{className:"px-4 bg-white",children:e.jsxs("div",{className:"container mx-auto max-w-7xl",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between mb-12",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-bold mb-4 text-foreground",children:"Biens en vedette"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl",children:"Découvrez notre sélection de biens les plus consultés"})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:t}).map((s,r)=>e.jsx("div",{children:E},r))})]})}):p?e.jsx("div",{className:"px-4 bg-white",children:e.jsx("div",{className:"container mx-auto max-w-7xl",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-4",children:[e.jsx(_,{className:"w-12 h-12 text-destructive mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2 text-foreground",children:"Une erreur est survenue"}),e.jsx("p",{className:"text-muted-foreground mb-6 text-center max-w-md",children:p}),e.jsxs(c,{onClick:F,variant:"outline",disabled:u,children:[e.jsx(k,{className:`w-4 h-4 mr-2 ${u?"animate-spin":""}`}),u?"Chargement...":"Réessayer"]})]})})}):i.length===0?null:e.jsx("div",{className:"px-3 md:px-4 bg-gradient-to-b from-white via-primary/3 to-white border-t border-primary/10",children:e.jsxs("div",{className:"container mx-auto max-w-7xl",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end md:justify-between mb-6 animate-fade-in",children:[e.jsxs("div",{children:[e.jsx("h2",{id:"featured-properties-heading",className:"text-4xl md:text-5xl font-bold mb-3 text-foreground",children:"Biens en vedette"}),e.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl",children:"Découvrez les biens les plus populaires cette semaine"})]}),e.jsx(c,{size:"lg",variant:"outline",asChild:!0,className:"hidden md:flex items-center gap-2 mt-6 md:mt-0 font-semibold border-2 hover:bg-primary hover:text-white transition-all",children:e.jsxs(v,{to:"/recherche",children:["Voir toutes les annonces",e.jsx(w,{className:"h-5 w-5"})]})})]}),e.jsx("div",{className:"flex gap-2 mb-6 overflow-x-auto pb-2",children:["Tous","Appartements","Villas","Studios"].map(s=>e.jsx(c,{variant:l===s?"default":"ghost",size:"sm",onClick:()=>y(s),className:"whitespace-nowrap font-medium",children:s},s))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5",role:"list","aria-label":"Biens immobiliers en vedette",children:S.map((s,r)=>e.jsx("div",{role:"listitem",className:"animate-fade-in hover-scale",style:{animationDelay:`${r*100}ms`},children:e.jsx(P,{property:s,onFavoriteClick:f=>{if(!b){D.error("Connectez-vous pour ajouter des favoris");return}N(f)},isFavorite:b?C(s.id):!1,variant:"compact"})},s.id))}),e.jsx("div",{className:"text-center mt-8",children:e.jsx(c,{asChild:!0,size:"lg",className:"md:hidden font-semibold shadow-lg hover:shadow-xl",children:e.jsxs(v,{to:"/recherche",className:"flex items-center gap-2",children:["Voir toutes les annonces",e.jsx(w,{className:"h-5 w-5"})]})})})]})})};export{Z as default};
//# sourceMappingURL=FeaturedProperties-fpsYfsW4.js.map
