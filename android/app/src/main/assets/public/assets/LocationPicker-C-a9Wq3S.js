import{r as b,a5 as Ee,co as Pe,j as e,X as ee,c8 as we,cg as ie,bi as ce,ab as de,ac as me,a9 as Ae,bu as Re}from"./react-vendor-CPmH2tz8.js";import{o as Te,s as F,n as Le,a as Me,e as Ie,b as ne,c as Z,t as Oe}from"./forms-vendor-DqOZ4YtP.js";import{aY as y,aZ as O,s as D,l as k,aX as se,aV as re,a6 as G,aW as le,a_ as A,a$ as Se,b0 as Ce,ag as W,B as ae,_ as S,aO as Fe,C as H,b as V,d as q,e as J,ae as he,a7 as xe,a8 as je,a9 as ge,aa as fe,aH as De,ab as _e,aG as ke,$ as oe,j as ve,b1 as $e,b2 as ue}from"./route-admin-B1Ip8YDE.js";import{m as Ge,g as j,h,i as p,j as x,l as L,k as B}from"./route-property-b6Ka_7KN.js";import{cj as Q}from"./common-vendor-CK5d0rWc.js";import{m as K}from"./maps-vendor-B7X9GnXQ.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};r.SENTRY_RELEASE={id:"b65e2d84341e79b518aed72b6e71dcc77eba934a"}}catch{}})();try{(function(){var r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},c=new r.Error().stack;c&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[c]="8e7c2d21-078b-434e-85cf-ae6e53fd357c",r._sentryDebugIdIdentifier="sentry-dbid-8e7c2d21-078b-434e-85cf-ae6e53fd357c")})()}catch{}const Ue=Te({title:F().min(O.MIN_TITLE_LENGTH,`Le titre doit contenir au moins ${O.MIN_TITLE_LENGTH} caractères`).max(O.MAX_TITLE_LENGTH,`Le titre ne doit pas dépasser ${O.MAX_TITLE_LENGTH} caractères`),description:F().min(O.MIN_DESCRIPTION_LENGTH,`La description doit contenir au moins ${O.MIN_DESCRIPTION_LENGTH} caractères`).max(O.MAX_DESCRIPTION_LENGTH,`La description ne doit pas dépasser ${O.MAX_DESCRIPTION_LENGTH} caractères`),property_type:F().min(1,"Le type de bien est requis"),address:F().min(O.MIN_ADDRESS_LENGTH,`L'adresse doit contenir au moins ${O.MIN_ADDRESS_LENGTH} caractères`).max(O.MAX_ADDRESS_LENGTH,`L'adresse ne doit pas dépasser ${O.MAX_ADDRESS_LENGTH} caractères`),city:F().min(1,"La ville est requise"),bedrooms:Z.number().min(y.MIN_BEDROOMS,`Minimum ${y.MIN_BEDROOMS} chambre`).max(y.MAX_BEDROOMS,`Maximum ${y.MAX_BEDROOMS} chambres`),bathrooms:Z.number().min(y.MIN_BATHROOMS,`Minimum ${y.MIN_BATHROOMS} salle de bain`).max(y.MAX_BATHROOMS,`Maximum ${y.MAX_BATHROOMS} salles de bain`),surface_area:Z.number().min(y.MIN_SURFACE,`Minimum ${y.MIN_SURFACE}m²`).max(y.MAX_SURFACE,`Maximum ${y.MAX_SURFACE}m²`),monthly_rent:Z.number().min(y.MIN_RENT,`Minimum ${y.MIN_RENT} FCFA`).max(y.MAX_RENT,`Maximum ${y.MAX_RENT} FCFA`),deposit_amount:Z.number().min(1,"La caution est obligatoire et doit être supérieure à 0 FCFA"),is_furnished:ne().default(!1),has_ac:ne().default(!1),has_parking:ne().default(!1),has_garden:ne().default(!1),work_status:Ie(["aucun_travail","travaux_a_effectuer"]).default("aucun_travail"),work_description:F().optional(),work_images:Me(F()).optional().default([]),work_estimated_cost:Le().nullable().optional(),work_estimated_duration:F().nullable().optional(),work_start_date:F().nullable().optional(),title_deed_url:F().optional()}),qe=r=>{const[c,n]=b.useState(!1),[l,N]=b.useState(!1),g=Ee(),{user:_,profile:w}=Ge(),o=Pe({resolver:Oe(Ue),defaultValues:{title:"",description:"",property_type:"",address:"",city:"",bedrooms:0,bathrooms:0,surface_area:0,is_furnished:!1,has_ac:!1,has_parking:!1,has_garden:!1,monthly_rent:0,deposit_amount:0}}),a=async()=>{if(r){n(!0);try{const{data:s,error:m}=await D.from("properties").select("*").eq("id",r).single();if(m||!s){k.error("Failed to load property",{error:m,propertyId:r}),se(new re("PROPERTY_LOAD_FAILED")),g("/mes-biens");return}o.reset({title:s.title,description:s.description||"",property_type:s.property_type,address:s.address,city:s.city,bedrooms:s.bedrooms||1,bathrooms:s.bathrooms||1,surface_area:s.surface_area||50,is_furnished:s.is_furnished||!1,has_ac:s.has_ac||!1,has_parking:s.has_parking||!1,has_garden:s.has_garden||!1,monthly_rent:s.monthly_rent,deposit_amount:s.deposit_amount||0}),k.info("Property loaded successfully",{propertyId:r})}catch(s){se(s,G.PROPERTY_LOAD_FAILED)}finally{n(!1)}}},i=async(s,m)=>{try{const{data:M,error:R}=await D.functions.invoke("geocode-address",{body:{address:s,city:m}});return R||!M?(k.error("Geocoding failed",{error:R,address:s,city:m}),se(new re("GEOCODING_FAILED")),null):M}catch(M){return k.error("Geocode error",{error:M,address:s,city:m}),null}},t=async(s,m,M,R)=>{var U,f,T;if(!_||!w)throw new re("AUTH_REQUIRED");N(!0);try{let u=R?{latitude:R.lat,longitude:R.lng}:null;u||(u=await i(s.address,s.city));const E={title:s.title,description:s.description,property_type:s.property_type,address:s.address,city:s.city,bedrooms:s.bedrooms,bathrooms:s.bathrooms,surface_area:s.surface_area,is_furnished:s.is_furnished,has_ac:s.has_ac,has_parking:s.has_parking,has_garden:s.has_garden,monthly_rent:s.monthly_rent,deposit_amount:s.deposit_amount,owner_id:_.id,latitude:(u==null?void 0:u.latitude)||null,longitude:(u==null?void 0:u.longitude)||null,images:m.images,main_image:m.mainImage,video_url:m.videoUrl,panoramic_images:m.panoramas,floor_plans:m.floorPlans},z=M||r;if(z){const{error:X}=await D.from("properties").update(E).eq("id",z);if(X)throw k.error("Failed to update property",{error:X,targetId:z}),new re("PROPERTY_UPDATE_FAILED");return le("PROPERTY_UPDATED"),z}else{const{data:X,error:$}=await D.from("properties").insert([E]).select("id").single();if($){k.error("Failed to create property",{error:$,propertyData:E});let Y="Échec de la création de la propriété";if((U=$.message)!=null&&U.includes("null value")){const te=(f=$.message.match(/column "(\w+)"/))==null?void 0:f[1];Y=te?`Le champ "${te}" est requis mais n'a pas été fourni.`:"Un champ requis n'a pas été fourni."}else(T=$.message)!=null&&T.includes("violates")?Y="Les données fournies ne respectent pas les contraintes de validation.":$.message&&(Y=$.message);throw new Error(Y)}if(!X)throw new Error("La propriété a été créée mais aucune donnée n'a été retournée.");return le("PROPERTY_CREATED"),X.id}}catch(u){const E=u instanceof Error?u.message:r?G.PROPERTY_UPDATE_FAILED:G.PROPERTY_CREATE_FAILED;throw se(u,E),u}finally{N(!1)}};return b.useEffect(()=>{r&&a()},[r]),{form:o,loading:c,submitting:l,loadProperty:a,submitProperty:t}},Je=()=>{const[r,c]=b.useState(!1),[n,l]=b.useState(0),N=o=>{const a=[];return o.images.length===0&&a.push(G.FILE_REQUIRED),o.images.length>A.MAX_IMAGES_PER_PROPERTY&&a.push(`Maximum ${A.MAX_IMAGES_PER_PROPERTY} images autorisées`),o.images.forEach((i,t)=>{i.size>A.MAX_IMAGE_SIZE&&a.push(`Image ${t+1}: ${G.IMAGE_TOO_LARGE}`),Se(i)||a.push(`Image ${t+1}: Format non autorisé (JPG, PNG, WEBP uniquement)`)}),o.video&&(o.video.size>A.MAX_VIDEO_SIZE&&a.push(G.VIDEO_TOO_LARGE),Ce(o.video)||a.push("Format vidéo non autorisé (MP4, WEBM uniquement)")),o.panoramas.length>A.MAX_PANORAMAS_PER_PROPERTY&&a.push(`Maximum ${A.MAX_PANORAMAS_PER_PROPERTY} panoramas autorisés`),o.panoramas.forEach((i,t)=>{i.size>A.MAX_PANORAMA_SIZE&&a.push(`Panorama ${t+1}: Taille maximale 8MB`)}),o.floorPlans.length>A.MAX_FLOOR_PLANS_PER_PROPERTY&&a.push(`Maximum ${A.MAX_FLOOR_PLANS_PER_PROPERTY} plans autorisés`),o.floorPlans.forEach((i,t)=>{i.size>A.MAX_FLOOR_PLAN_SIZE&&a.push(`Plan ${t+1}: Taille maximale 5MB`)}),{valid:a.length===0,errors:a}},g=async(o,a,i)=>{try{const{data:t,error:s}=await D.storage.from(o).upload(a,i,{upsert:!0});if(s)throw k.error(`Failed to upload to ${o}`,{error:s,path:a}),new re("UPLOAD_FAILED");const{data:{publicUrl:m}}=D.storage.from(o).getPublicUrl(t.path);return m}catch(t){return k.error("Upload file error",{error:t,bucket:o,path:a}),null}};return{uploading:r,progress:n,uploadMedia:async(o,a,i)=>{c(!0),l(0);try{const t=a.images.length+(a.video?1:0)+a.panoramas.length+a.floorPlans.length;let s=0;const m=(i==null?void 0:i.images)||[];for(const f of a.images){const T=Date.now(),u=`${o}/${T}_${f.name}`,E=await g("property-images",u,f);E&&m.push(E),s++,l(Math.round(s/t*100))}let M=(i==null?void 0:i.videoUrl)||null;if(a.video){const f=Date.now(),T=`${o}/${f}_${a.video.name}`,u=await g("property-videos",T,a.video);u&&(M=u),s++,l(Math.round(s/t*100))}const R=(i==null?void 0:i.panoramas)||[];for(const f of a.panoramas){const T=Date.now(),u=`${o}/${T}_${f.name}`,E=await g("property-360",u,f);E&&R.push({url:E,title:f.name.replace(/\.[^/.]+$/,"")}),s++,l(Math.round(s/t*100))}const U=(i==null?void 0:i.floorPlans)||[];for(const f of a.floorPlans){const T=Date.now(),u=`${o}/${T}_${f.name}`,E=await g("property-plans",u,f);E&&U.push({url:E,title:f.name.replace(/\.[^/.]+$/,"")}),s++,l(Math.round(s/t*100))}return le("MEDIA_UPLOADED"),{images:m,mainImage:m.length>0?m[0]:(i==null?void 0:i.mainImage)||null,videoUrl:M,panoramas:R,floorPlans:U}}catch(t){throw se(t,G.UPLOAD_FAILED),t}finally{c(!1),l(0)}},deleteMedia:async o=>{try{const a=i=>{const s=new URL(i).pathname.split("/");return s.slice(s.indexOf("object")+2).join("/")};if(o.images.length>0){const i=o.images.map(a);await D.storage.from("property-images").remove(i)}if(o.videoUrl){const i=a(o.videoUrl);await D.storage.from("property-videos").remove([i])}if(o.panoramas.length>0){const i=o.panoramas.map(t=>a(t.url));await D.storage.from("property-360").remove(i)}if(o.floorPlans.length>0){const i=o.floorPlans.map(t=>a(t.url));await D.storage.from("property-plans").remove(i)}k.info("Media deleted successfully")}catch(a){throw k.error("Failed to delete media",{error:a}),a}},validateMediaFiles:N}},Ze=({onImagesChange:r,onVideoChange:c,onPanoramaChange:n,onFloorPlanChange:l,onVirtualTourUrlChange:N,existingImages:g=[],existingVideo:_=null,existingPanoramas:w=[],existingFloorPlans:o=[],existingVirtualTourUrl:a="",uploading:i=!1})=>{const[t,s]=b.useState(g),[m,M]=b.useState(_),[R,U]=b.useState([]),[f,T]=b.useState([]),[u,E]=b.useState(0),[z,X]=b.useState(a),$=v=>{const d=Array.from(v.target.files||[]);if(d.length+t.length>A.MAX_IMAGES_PER_PROPERTY){Q.error(`Maximum ${A.MAX_IMAGES_PER_PROPERTY} images autorisées`);return}if(d.filter(I=>I.size>A.MAX_IMAGE_SIZE).length>0){Q.error(G.IMAGE_TOO_LARGE);return}const P=d.map(I=>URL.createObjectURL(I));s([...t,...P]),r(d)},Y=v=>{var P;const d=(P=v.target.files)==null?void 0:P[0];if(!d)return;if(d.size>A.MAX_VIDEO_SIZE){Q.error(G.VIDEO_TOO_LARGE);return}if(!["video/mp4","video/webm","video/quicktime"].includes(d.type)){Q.error("Format vidéo non supporté (mp4, webm, mov uniquement)");return}M(URL.createObjectURL(d)),c(d)},te=v=>{const d=Array.from(v.target.files||[]);d.forEach(P=>{const I=new Image;I.onload=()=>{const Ne=I.width/I.height;Math.abs(Ne-2)>.1&&Q.warning(`${P.name} n'a pas le bon ratio (2:1 requis pour les images 360°)`)},I.src=URL.createObjectURL(P)});const C=d.map(P=>URL.createObjectURL(P));U([...R,...C]),n(d)},ye=v=>{const d=Array.from(v.target.files||[]),C=d.map(P=>URL.createObjectURL(P));T([...f,...C]),l(d)},be=v=>{const d=t.filter((C,P)=>P!==v);s(d)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(W,{htmlFor:"images",className:"text-base font-semibold",children:"Photos du bien"}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[t.length,"/10 • JPG, PNG • Max 5MB/photo"]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[t.map((v,d)=>e.jsxs("div",{className:"relative aspect-video group",children:[e.jsx("img",{src:v,alt:`Preview ${d+1}`,loading:"lazy",decoding:"async",className:"w-full h-full object-cover rounded-md border-2 border-border"}),e.jsx(ae,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>be(d),children:e.jsx(ee,{className:"h-3 w-3"})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/50 to-transparent p-2 opacity-0 group-hover:opacity-100 transition-opacity rounded-b-md",children:e.jsxs("p",{className:"text-xs text-white font-medium",children:["Photo ",d+1]})})]},d)),t.length<10&&e.jsxs("label",{className:"aspect-video border-2 border-dashed border-muted-foreground/25 rounded-md flex flex-col items-center justify-center cursor-pointer hover:border-primary hover:bg-primary/5 transition-all group",children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/png,image/webp",multiple:!0,onChange:$,className:"hidden"}),e.jsx(we,{className:"h-6 w-6 text-muted-foreground group-hover:text-primary transition-colors mb-1"}),e.jsx("span",{className:"text-xs text-muted-foreground group-hover:text-primary transition-colors",children:"Ajouter"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(W,{htmlFor:"video",className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(ie,{className:"h-5 w-5"}),"Vidéo de présentation"]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:"MP4, WebM, MOV • Max 100MB"})]}),e.jsx("div",{className:"flex items-center gap-4",children:m?e.jsxs("div",{className:"relative flex-1",children:[e.jsx("video",{src:m,controls:!0,className:"w-full rounded-md border-2 border-border"}),e.jsx(ae,{type:"button",variant:"destructive",size:"sm",className:"absolute top-2 right-2",onClick:()=>{M(null),c(null)},children:e.jsx(ee,{className:"h-4 w-4"})})]}):e.jsxs("label",{className:"flex-1 border-2 border-dashed border-muted-foreground/25 rounded-md p-8 text-center cursor-pointer hover:border-primary hover:bg-primary/5 transition-all group",children:[e.jsx("input",{type:"file",accept:"video/mp4,video/webm,video/quicktime",onChange:Y,className:"hidden"}),e.jsx(ie,{className:"h-10 w-10 mx-auto mb-3 text-muted-foreground group-hover:text-primary transition-colors"}),e.jsx("p",{className:"text-sm font-medium text-foreground mb-1",children:"Ajouter une vidéo"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Formats: MP4, WebM, MOV • Taille max: 100 MB"})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(W,{htmlFor:"panorama",className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5"}),"Images panoramiques 360°"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[R.map((v,d)=>e.jsxs("div",{className:"relative aspect-video group",children:[e.jsx("img",{src:v,alt:`Panorama ${d+1}`,loading:"lazy",decoding:"async",className:"w-full h-full object-cover rounded-md"}),e.jsx(ae,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{const C=R.filter((P,I)=>I!==d);U(C)},children:e.jsx(ee,{className:"h-4 w-4"})})]},d)),e.jsxs("label",{className:"aspect-video border-2 border-dashed rounded-md flex items-center justify-center cursor-pointer hover:border-primary transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:te,className:"hidden"}),e.jsx(ce,{className:"h-8 w-8 text-muted-foreground"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Les images doivent avoir un ratio 2:1 (équirectangulaire)"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(W,{htmlFor:"plans",className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(de,{className:"h-5 w-5"}),"Plans d'étage"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[f.map((v,d)=>e.jsxs("div",{className:"relative aspect-video group",children:[e.jsx("img",{src:v,alt:`Plan ${d+1}`,loading:"lazy",decoding:"async",className:"w-full h-full object-cover rounded-md"}),e.jsx(ae,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{const C=f.filter((P,I)=>I!==d);T(C)},children:e.jsx(ee,{className:"h-4 w-4"})})]},d)),e.jsxs("label",{className:"aspect-video border-2 border-dashed rounded-md flex items-center justify-center cursor-pointer hover:border-primary transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*,application/pdf",multiple:!0,onChange:ye,className:"hidden"}),e.jsx(de,{className:"h-8 w-8 text-muted-foreground"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(W,{htmlFor:"virtualTour",className:"text-base font-semibold",children:"Lien visite virtuelle (Matterport, etc.)"}),e.jsx(S,{id:"virtualTour",type:"url",placeholder:"https://my.matterport.com/show/...",value:z,onChange:v=>{X(v.target.value),N(v.target.value)}})]}),u>0&&u<100&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Fe,{value:u}),e.jsxs("p",{className:"text-sm text-center text-muted-foreground",children:["Upload en cours... ",u,"%"]})]})]})},We=({form:r})=>e.jsxs(H,{children:[e.jsx(V,{children:e.jsx(q,{children:"Informations générales"})}),e.jsxs(J,{className:"space-y-4",children:[e.jsx(j,{control:r.control,name:"title",render:({field:c})=>e.jsxs(h,{children:[e.jsx(p,{children:"Titre de l'annonce"}),e.jsx(x,{children:e.jsx(S,{placeholder:"Ex: Appartement F3 moderne à Cocody",...c})}),e.jsx(L,{})]})}),e.jsx(j,{control:r.control,name:"description",render:({field:c})=>e.jsxs(h,{children:[e.jsx(p,{children:"Description"}),e.jsx(x,{children:e.jsx(he,{placeholder:"Décrivez votre bien en détail...",className:"min-h-[120px]",...c})}),e.jsx(L,{})]})}),e.jsx(j,{control:r.control,name:"property_type",render:({field:c})=>e.jsxs(h,{children:[e.jsx(p,{children:"Type de bien"}),e.jsxs(xe,{onValueChange:c.onChange,value:c.value,children:[e.jsx(x,{children:e.jsx(je,{children:e.jsx(ge,{placeholder:"Sélectionnez un type"})})}),e.jsx(fe,{children:De.map(n=>e.jsx(_e,{value:n,children:n},n))})]}),e.jsx(L,{})]})})]})]}),Qe=({form:r})=>e.jsxs(H,{children:[e.jsx(V,{children:e.jsx(q,{children:"Localisation"})}),e.jsxs(J,{className:"space-y-4",children:[e.jsx(j,{control:r.control,name:"city",render:({field:c})=>e.jsxs(h,{children:[e.jsx(p,{children:"Ville"}),e.jsxs(xe,{onValueChange:c.onChange,value:c.value,children:[e.jsx(x,{children:e.jsx(je,{children:e.jsx(ge,{placeholder:"Sélectionnez une ville"})})}),e.jsx(fe,{children:ke.map(n=>e.jsx(_e,{value:n,children:n},n))})]}),e.jsx(L,{})]})}),e.jsx(j,{control:r.control,name:"address",render:({field:c})=>e.jsxs(h,{children:[e.jsx(p,{children:"Adresse complète"}),e.jsx(x,{children:e.jsx(S,{placeholder:"Ex: Rue des Jardins, près du marché",...c})}),e.jsx(L,{})]})})]})]}),Ke=({form:r})=>{const n=r.watch("property_type")==="Appartement";return e.jsxs(H,{children:[e.jsx(V,{children:e.jsx(q,{children:"Caractéristiques"})}),e.jsxs(J,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(j,{control:r.control,name:"bedrooms",render:({field:l})=>e.jsxs(h,{children:[e.jsx(p,{children:"Chambres"}),e.jsx(x,{children:e.jsx(S,{type:"number",min:"0",...l})}),e.jsx(L,{})]})}),e.jsx(j,{control:r.control,name:"bathrooms",render:({field:l})=>e.jsxs(h,{children:[e.jsx(p,{children:"Salles de bain"}),e.jsx(x,{children:e.jsx(S,{type:"number",min:"0",...l})}),e.jsx(L,{})]})}),e.jsx(j,{control:r.control,name:"surface_area",render:({field:l})=>e.jsxs(h,{children:[e.jsx(p,{children:"Surface (m²)"}),e.jsx(x,{children:e.jsx(S,{type:"number",min:"0",...l})}),e.jsx(L,{})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(p,{children:"Équipements"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(j,{control:r.control,name:"is_furnished",render:({field:l})=>e.jsxs(h,{className:"flex items-center space-x-2 space-y-0",children:[e.jsx(x,{children:e.jsx(oe,{checked:l.value,onCheckedChange:l.onChange})}),e.jsx(p,{className:"font-normal cursor-pointer",children:"Meublé"})]})}),e.jsx(j,{control:r.control,name:"has_ac",render:({field:l})=>e.jsxs(h,{className:"flex items-center space-x-2 space-y-0",children:[e.jsx(x,{children:e.jsx(oe,{checked:l.value,onCheckedChange:l.onChange})}),e.jsx(p,{className:"font-normal cursor-pointer",children:"Climatisation"})]})}),e.jsx(j,{control:r.control,name:"has_parking",render:({field:l})=>e.jsxs(h,{className:"flex items-center space-x-2 space-y-0",children:[e.jsx(x,{children:e.jsx(oe,{checked:l.value,onCheckedChange:l.onChange})}),e.jsx(p,{className:"font-normal cursor-pointer",children:"Parking"})]})}),!n&&e.jsx(j,{control:r.control,name:"has_garden",render:({field:l})=>e.jsxs(h,{className:"flex items-center space-x-2 space-y-0",children:[e.jsx(x,{children:e.jsx(oe,{checked:l.value,onCheckedChange:l.onChange})}),e.jsx(p,{className:"font-normal cursor-pointer",children:"Jardin"})]})})]})]})]})]})},es=({form:r})=>e.jsxs(H,{children:[e.jsx(V,{children:e.jsx(q,{children:"Tarification"})}),e.jsxs(J,{className:"space-y-4",children:[e.jsx(j,{control:r.control,name:"monthly_rent",render:({field:c})=>e.jsxs(h,{children:[e.jsx(p,{children:"Loyer mensuel (FCFA)"}),e.jsx(x,{children:e.jsx(S,{type:"number",min:"0",placeholder:"250000",...c})}),e.jsx(L,{})]})}),e.jsx(j,{control:r.control,name:"deposit_amount",render:({field:c})=>e.jsxs(h,{children:[e.jsx(p,{children:"Caution (FCFA)"}),e.jsx(x,{children:e.jsx(S,{type:"number",min:"0",placeholder:"500000",...c})}),e.jsx(B,{children:"Généralement équivalent à 2-3 mois de loyer"}),e.jsx(L,{})]})})]})]}),ss=({form:r})=>{const c=r.watch("work_status");return e.jsxs(H,{children:[e.jsxs(V,{children:[e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5 text-warning"}),"État des travaux"]}),e.jsx(ve,{children:"Informez les locataires potentiels de l'état du bien"})]}),e.jsxs(J,{className:"space-y-6",children:[e.jsx(j,{control:r.control,name:"work_status",render:({field:n})=>e.jsxs(h,{className:"space-y-3",children:[e.jsx(p,{children:"Travaux nécessaires ?"}),e.jsx(x,{children:e.jsxs($e,{onValueChange:n.onChange,defaultValue:n.value,className:"flex flex-col space-y-2",children:[e.jsxs(h,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(x,{children:e.jsx(ue,{value:"aucun_travail"})}),e.jsxs(p,{className:"font-normal cursor-pointer flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4 text-success"}),"Aucun travail - Logement prêt à occuper"]})]}),e.jsxs(h,{className:"flex items-center space-x-3 space-y-0",children:[e.jsx(x,{children:e.jsx(ue,{value:"travaux_a_effectuer"})}),e.jsxs(p,{className:"font-normal cursor-pointer flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4 text-warning"}),"Travaux à effectuer avant emménagement"]})]})]})}),e.jsx(L,{})]})}),c==="travaux_a_effectuer"&&e.jsxs("div",{className:"space-y-4 pt-4 border-t animate-fade-in",children:[e.jsx(j,{control:r.control,name:"work_description",render:({field:n})=>e.jsxs(h,{children:[e.jsx(p,{children:"Description des travaux *"}),e.jsx(x,{children:e.jsx(he,{placeholder:"Décrivez en détail les travaux à effectuer : peinture, plomberie, électricité, etc.",className:"min-h-[100px]",...n})}),e.jsx(B,{children:"Soyez transparent sur la nature et l'ampleur des travaux"}),e.jsx(L,{})]})}),e.jsx(j,{control:r.control,name:"work_images",render:({field:n})=>e.jsxs(h,{children:[e.jsx(p,{children:"Photos de l'état actuel"}),e.jsx(x,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:(n.value||[]).map((l,N)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:l,alt:`Travaux ${N+1}`,className:"w-full h-32 object-cover rounded-lg"}),e.jsx(ae,{type:"button",variant:"destructive",size:"icon",className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{const g=(n.value||[]).filter((_,w)=>w!==N);n.onChange(g)},children:e.jsx(ee,{className:"h-4 w-4"})})]},N))}),(n.value||[]).length<5&&e.jsx("div",{children:e.jsx(S,{type:"file",accept:"image/*",multiple:!0,onChange:l=>{Array.from(l.target.files||[]).forEach(g=>{const _=new FileReader;_.onload=w=>{var a;const o=n.value||[];o.length<5&&n.onChange([...o,(a=w.target)==null?void 0:a.result])},_.readAsDataURL(g)})}})})]})}),e.jsx(B,{children:"Photos montrant les zones nécessitant des travaux (maximum 5 photos)"}),e.jsx(L,{})]})}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-lg space-y-4 mt-4",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Estimations (optionnel)"}),e.jsx(j,{control:r.control,name:"work_estimated_cost",render:({field:n})=>e.jsxs(h,{children:[e.jsx(p,{children:"Coût estimé (FCFA)"}),e.jsx(x,{children:e.jsx(S,{type:"number",placeholder:"Ex: 500000",...n,value:n.value||"",onChange:l=>n.onChange(l.target.value?parseFloat(l.target.value):null)})}),e.jsx(B,{children:"Estimation du coût total des travaux"})]})}),e.jsx(j,{control:r.control,name:"work_estimated_duration",render:({field:n})=>e.jsxs(h,{children:[e.jsx(p,{children:"Durée estimée"}),e.jsx(x,{children:e.jsx(S,{placeholder:"Ex: 2 semaines, 1 mois",...n,value:n.value||""})}),e.jsx(B,{children:"Temps nécessaire pour réaliser les travaux"})]})}),e.jsx(j,{control:r.control,name:"work_start_date",render:({field:n})=>e.jsxs(h,{children:[e.jsx(p,{children:"Date de début prévue"}),e.jsx(x,{children:e.jsx(S,{type:"date",...n,value:n.value||""})}),e.jsx(B,{children:"Date prévue pour commencer les travaux"})]})})]})]})]})]})},pe={Abidjan:[-4.0083,5.36],Yamoussoukro:[-5.2767,6.8276],Bouaké:[-5.03,7.69],Daloa:[-6.4503,6.877],"San-Pédro":[-6.6361,4.7485],Korhogo:[-5.63,9.45],Man:[-7.5542,7.4125]},rs=({onLocationSelect:r,initialLat:c,initialLng:n,city:l})=>{const N=b.useRef(null),g=b.useRef(null),_=b.useRef(null),[w,o]=b.useState(c&&n?[n,c]:null);return b.useEffect(()=>{if(!N.current)return;const a=l?pe[l]:null,i=w||a||pe.Abidjan;return K.accessToken="pk.eyJ1IjoibG92YWJsZS1kZXYiLCJhIjoiY200N2lwbDJhMDBseTJrcHlnOTluZnN1biJ9.JLechweMLsxP7qlR6cT-Og",g.current=new K.Map({container:N.current,style:"mapbox://styles/mapbox/streets-v12",center:i,zoom:13}),g.current.addControl(new K.NavigationControl,"top-right"),w&&(_.current=new K.Marker({draggable:!0,color:"#EF4444"}).setLngLat(w).addTo(g.current),_.current.on("dragend",()=>{const t=_.current.getLngLat();o([t.lng,t.lat]),r(t.lat,t.lng)})),g.current.on("click",t=>{const s=t.lngLat;_.current?_.current.setLngLat(s):(_.current=new K.Marker({draggable:!0,color:"#EF4444"}).setLngLat(s).addTo(g.current),_.current.on("dragend",()=>{const m=_.current.getLngLat();o([m.lng,m.lat]),r(m.lat,m.lng)})),o([s.lng,s.lat]),r(s.lat,s.lng)}),()=>{var t;(t=g.current)==null||t.remove()}},[l]),e.jsxs(H,{children:[e.jsxs(V,{children:[e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-5 w-5"}),"Position sur la carte"]}),e.jsx(ve,{children:"Cliquez sur la carte pour définir l'emplacement exact de votre bien"})]}),e.jsxs(J,{children:[e.jsx("div",{ref:N,className:"h-[400px] rounded-lg"}),w&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Position : ",w[1].toFixed(6),", ",w[0].toFixed(6)]})]})]})};export{rs as L,Ze as M,We as P,Je as a,Qe as b,Ke as c,es as d,ss as e,qe as u};
//# sourceMappingURL=LocationPicker-C-a9Wq3S.js.map
