{"version":3,"file":"MyMandates-4dUaJinv.js","sources":["../../src/components/ui/command.tsx","../../src/hooks/useHelpSystem.ts","../../src/components/help/ContextualTooltip.tsx","../../src/components/mandates/InviteAgencyDialog.tsx","../../src/components/mandates/MandateCard.tsx","../../src/pages/MyMandates.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { type DialogProps } from \"@radix-ui/react-dialog\";\nimport { Command as CommandPrimitive } from \"cmdk\";\nimport { Search } from \"lucide-react\";\n\nimport { cn } from \"@/lib/utils\";\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\";\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className,\n    )}\n    {...props}\n  />\n));\nCommand.displayName = CommandPrimitive.displayName;\n\ninterface CommandDialogProps extends DialogProps {}\n\nconst CommandDialog = ({ children, ...props }: CommandDialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  );\n};\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className,\n      )}\n      {...props}\n    />\n  </div>\n));\n\nCommandInput.displayName = CommandPrimitive.Input.displayName;\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n));\n\nCommandList.displayName = CommandPrimitive.List.displayName;\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => <CommandPrimitive.Empty ref={ref} className=\"py-6 text-center text-sm\" {...props} />);\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName;\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className,\n    )}\n    {...props}\n  />\n));\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName;\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator ref={ref} className={cn(\"-mx-1 h-px bg-border\", className)} {...props} />\n));\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName;\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50\",\n      className,\n    )}\n    {...props}\n  />\n));\n\nCommandItem.displayName = CommandPrimitive.Item.displayName;\n\nconst CommandShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {\n  return <span className={cn(\"ml-auto text-xs tracking-widest text-muted-foreground\", className)} {...props} />;\n};\nCommandShortcut.displayName = \"CommandShortcut\";\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n};\n","import { useState, useCallback } from 'react';\nimport { supabase } from '@/lib/supabase';\nimport type { HelpInteraction } from '@/types/supabase-extended';\nimport { logger } from '@/services/logger';\n\nexport interface HelpContent {\n  id: string;\n  title: string;\n  description: string;\n  category: string;\n  videoUrl?: string;\n  steps?: string[];\n}\n\nexport const useHelpSystem = () => {\n  const [isHelpOpen, setIsHelpOpen] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n\n  const trackInteraction = useCallback(async (\n    helpType: 'tooltip' | 'tour' | 'search' | 'help_center',\n    contentId: string\n  ) => {\n    try {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) return;\n\n      await (supabase as any).from('help_interactions').insert({\n        user_id: user.id,\n        help_type: helpType,\n        content_id: contentId,\n      });\n    } catch (error) {\n      logger.debug('Failed to track help interaction', { helpType, contentId });\n    }\n  }, []);\n\n  const openHelp = useCallback(() => {\n    setIsHelpOpen(true);\n    trackInteraction('help_center', 'opened');\n  }, [trackInteraction]);\n\n  const closeHelp = useCallback(() => {\n    setIsHelpOpen(false);\n  }, []);\n\n  const searchHelp = useCallback((query: string) => {\n    setSearchQuery(query);\n    if (query.length > 2) {\n      trackInteraction('search', query);\n    }\n  }, [trackInteraction]);\n\n  return {\n    isHelpOpen,\n    searchQuery,\n    openHelp,\n    closeHelp,\n    searchHelp,\n    trackInteraction,\n  };\n};\n","import { HelpCircle } from 'lucide-react';\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from '@/components/ui/tooltip';\nimport { useHelpSystem } from '@/hooks/useHelpSystem';\n\ninterface ContextualTooltipProps {\n  id: string;\n  title: string;\n  content: string;\n  videoUrl?: string;\n}\n\nexport const ContextualTooltip = ({ id, title, content, videoUrl }: ContextualTooltipProps) => {\n  const { trackInteraction } = useHelpSystem();\n\n  return (\n    <TooltipProvider>\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <button\n            type=\"button\"\n            className=\"inline-flex items-center text-muted-foreground hover:text-primary transition-colors\"\n            onClick={() => trackInteraction('tooltip', id)}\n          >\n            <HelpCircle className=\"h-4 w-4\" />\n          </button>\n        </TooltipTrigger>\n        <TooltipContent className=\"max-w-sm space-y-2\" side=\"right\">\n          <div className=\"font-semibold\">{title}</div>\n          <p className=\"text-sm text-muted-foreground\">{content}</p>\n          {videoUrl && (\n            <a\n              href={videoUrl}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"text-xs text-primary hover:underline inline-block mt-1\"\n            >\n              Voir la vidéo explicative →\n            </a>\n          )}\n        </TooltipContent>\n      </Tooltip>\n    </TooltipProvider>\n  );\n};\n","import { useState, useEffect } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { zodResolver } from '@hookform/resolvers/zod';\nimport * as z from 'zod';\nimport type { Agency, MandateSubmission } from '@/types/admin';\nimport { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from '@/components/ui/dialog';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle } from '@/components/ui/alert-dialog';\nimport { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from '@/components/ui/form';\nimport { Input } from '@/components/ui/input';\nimport { Button } from '@/components/ui/button';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Switch } from '@/components/ui/switch';\nimport { useAgencyMandates } from '@/hooks/useAgencyMandates';\nimport { useProperties } from '@/hooks/useProperties';\nimport { Calendar } from '@/components/ui/calendar';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\nimport { CalendarIcon, Search, Building2, AlertTriangle } from 'lucide-react';\nimport { format } from 'date-fns';\nimport { fr } from 'date-fns/locale';\nimport { cn } from '@/lib/utils';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Command, CommandEmpty, CommandGroup, CommandInput, CommandItem } from '@/components/ui/command';\nimport { supabase } from '@/lib/supabase';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { ContextualTooltip } from '@/components/help/ContextualTooltip';\nimport { Link } from 'react-router-dom';\nimport { HelpCircle } from 'lucide-react';\n\nconst formSchema = z.object({\n  agency_id: z.string().min(1, 'Sélectionnez une agence'),\n  property_id: z.string().optional(),\n  mandate_type: z.enum(['location', 'gestion_complete', 'vente']),\n  commission_rate: z.coerce.number().min(0).max(100).optional(),\n  fixed_fee: z.coerce.number().min(0).optional(),\n  billing_frequency: z.enum(['mensuel', 'trimestriel', 'annuel', 'par_transaction']).optional(),\n  start_date: z.date(),\n  end_date: z.date().optional(),\n  notes: z.string().optional(),\n  permissions: z.object({\n    can_view_properties: z.boolean().default(true),\n    can_edit_properties: z.boolean().default(false),\n    can_create_properties: z.boolean().default(false),\n    can_delete_properties: z.boolean().default(false),\n    can_view_applications: z.boolean().default(true),\n    can_manage_applications: z.boolean().default(false),\n    can_create_leases: z.boolean().default(false),\n    can_view_financials: z.boolean().default(false),\n    can_manage_maintenance: z.boolean().default(false),\n    can_communicate_tenants: z.boolean().default(true),\n    can_manage_documents: z.boolean().default(false),\n  }),\n}).refine((data) => {\n  if (data.end_date && data.start_date) {\n    return data.end_date > data.start_date;\n  }\n  return true;\n}, {\n  message: \"La date de fin doit être postérieure à la date de début\",\n  path: [\"end_date\"],\n});\n\ninterface InviteAgencyDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n}\n\nexport function InviteAgencyDialog({ open, onOpenChange }: InviteAgencyDialogProps) {\n  const { createMandate, asOwner } = useAgencyMandates();\n  const { data: properties = [] } = useProperties();\n  const [agencies, setAgencies] = useState<Agency[]>([]);\n  const [loadingAgencies, setLoadingAgencies] = useState(false);\n  const [agenciesOpen, setAgenciesOpen] = useState(false);\n  const [duplicateWarning, setDuplicateWarning] = useState(false);\n  const [confirmDialogOpen, setConfirmDialogOpen] = useState(false);\n  const [pendingSubmission, setPendingSubmission] = useState<MandateSubmission | null>(null);\n\n  const form = useForm<z.infer<typeof formSchema>>({\n    resolver: zodResolver(formSchema),\n    defaultValues: {\n      mandate_type: 'location',\n      start_date: new Date(),\n      permissions: {\n        can_view_properties: true,\n        can_edit_properties: false,\n        can_create_properties: false,\n        can_delete_properties: false,\n        can_view_applications: true,\n        can_manage_applications: false,\n        can_create_leases: false,\n        can_view_financials: false,\n        can_manage_maintenance: false,\n        can_communicate_tenants: true,\n        can_manage_documents: false,\n      },\n    },\n  });\n\n  // Fetch agencies from profiles\n  useEffect(() => {\n    const fetchAgencies = async () => {\n      setLoadingAgencies(true);\n      const { data, error } = await supabase\n        .from('profiles')\n        .select('id, full_name, city, created_at')\n        .eq('user_type', 'agence')\n        .order('full_name');\n      \n      if (!error && data) {\n        setAgencies(data.map(a => ({\n          ...a,\n          user_type: 'agence' as const,\n        })));\n      }\n      setLoadingAgencies(false);\n    };\n    \n    if (open) {\n      fetchAgencies();\n    }\n  }, [open]);\n\n  // Check for duplicate mandates\n  useEffect(() => {\n    const agencyId = form.watch('agency_id');\n    const propertyId = form.watch('property_id');\n    \n    if (agencyId) {\n      const hasDuplicate = asOwner.some(\n        m => m.agency_id === agencyId && \n        m.status === 'active' &&\n        (m.property_id === propertyId || (!propertyId && !m.property_id))\n      );\n      setDuplicateWarning(hasDuplicate);\n    }\n  }, [form.watch('agency_id'), form.watch('property_id'), asOwner]);\n\n  const onSubmit = (values: z.infer<typeof formSchema>) => {\n    if (duplicateWarning) {\n      return;\n    }\n    \n    // Préparer la soumission pour confirmation\n    const submissionData: MandateSubmission = {\n      agency_id: values.agency_id,\n      property_id: values.property_id || null,\n      mandate_type: values.mandate_type,\n      commission_rate: values.commission_rate,\n      fixed_fee: values.fixed_fee,\n      billing_frequency: values.billing_frequency,\n      start_date: values.start_date.toISOString().split('T')[0],\n      end_date: values.end_date?.toISOString().split('T')[0],\n      notes: values.notes,\n      permissions: {\n        can_view_properties: values.permissions.can_view_properties,\n        can_edit_properties: values.permissions.can_edit_properties,\n        can_create_properties: values.permissions.can_create_properties,\n        can_delete_properties: values.permissions.can_delete_properties,\n        can_view_applications: values.permissions.can_view_applications,\n        can_manage_applications: values.permissions.can_manage_applications,\n        can_create_leases: values.permissions.can_create_leases,\n        can_view_financials: values.permissions.can_view_financials,\n        can_manage_maintenance: values.permissions.can_manage_maintenance,\n        can_communicate_tenants: values.permissions.can_communicate_tenants,\n        can_manage_documents: values.permissions.can_manage_documents,\n      },\n    };\n    \n    setPendingSubmission(submissionData);\n    setConfirmDialogOpen(true);\n  };\n\n  const handleConfirmedSubmit = () => {\n    if (pendingSubmission) {\n      createMandate(pendingSubmission);\n      setConfirmDialogOpen(false);\n      setPendingSubmission(null);\n      onOpenChange(false);\n      form.reset();\n    }\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <div className=\"flex items-center justify-between\">\n            <DialogTitle>Inviter une agence</DialogTitle>\n            <Button variant=\"ghost\" size=\"sm\" asChild>\n              <Link to=\"/mandates/help\" className=\"gap-2\">\n                <HelpCircle className=\"h-4 w-4\" />\n                Aide\n              </Link>\n            </Button>\n          </div>\n          <DialogDescription>\n            Donnez à une agence immobilière l'accès à vos biens pour qu'elle les gère en votre nom\n          </DialogDescription>\n        </DialogHeader>\n\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n            {/* Sélection agence avec recherche */}\n            <FormField\n              control={form.control}\n              name=\"agency_id\"\n              render={({ field }) => (\n                <FormItem className=\"flex flex-col\">\n                      <FormLabel className=\"flex items-center gap-2\">\n                        Agence\n                        <ContextualTooltip\n                          id=\"select_agency\"\n                          title=\"Choisir une agence\"\n                          content=\"Sélectionnez l'agence immobilière à qui vous souhaitez confier la gestion de votre bien. Assurez-vous que l'agence est bien enregistrée sur la plateforme.\"\n                        />\n                      </FormLabel>\n                      <Popover open={agenciesOpen} onOpenChange={setAgenciesOpen}>\n                    <PopoverTrigger asChild>\n                      <FormControl>\n                        <Button\n                          variant=\"outline\"\n                          role=\"combobox\"\n                          className={cn(\n                            \"justify-between\",\n                            !field.value && \"text-muted-foreground\"\n                          )}\n                        >\n                          {field.value\n                            ? agencies.find((agency) => agency.id === field.value)?.full_name\n                            : \"Rechercher une agence...\"}\n                          <Search className=\"ml-2 h-4 w-4 shrink-0 opacity-50\" />\n                        </Button>\n                      </FormControl>\n                    </PopoverTrigger>\n                    <PopoverContent className=\"w-[400px] p-0\">\n                      <Command>\n                        <CommandInput placeholder=\"Rechercher une agence...\" />\n                        <CommandEmpty>Aucune agence trouvée.</CommandEmpty>\n                        <CommandGroup>\n                          {agencies.map((agency) => (\n                            <CommandItem\n                              value={agency.full_name}\n                              key={agency.id}\n                              onSelect={() => {\n                                form.setValue(\"agency_id\", agency.id);\n                                setAgenciesOpen(false);\n                              }}\n                            >\n                              <Building2 className=\"mr-2 h-4 w-4\" />\n                              <div className=\"flex flex-col\">\n                                <span className=\"font-medium\">{agency.full_name}</span>\n                                {agency.city && (\n                                  <span className=\"text-xs text-muted-foreground\">{agency.city}</span>\n                                )}\n                              </div>\n                            </CommandItem>\n                          ))}\n                        </CommandGroup>\n                      </Command>\n                    </PopoverContent>\n                  </Popover>\n                  <FormDescription>\n                    Recherchez et sélectionnez l'agence qui gérera vos biens\n                  </FormDescription>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            {/* Warning for duplicate mandate */}\n            {duplicateWarning && (\n              <Alert variant=\"destructive\">\n                <AlertTriangle className=\"h-4 w-4\" />\n                <AlertDescription>\n                  Un mandat actif existe déjà avec cette agence pour cette portée. \n                  Veuillez terminer le mandat existant avant d'en créer un nouveau.\n                </AlertDescription>\n              </Alert>\n            )}\n\n            {/* Type de mandat */}\n            <FormField\n              control={form.control}\n              name=\"mandate_type\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Type de mandat</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger>\n                        <SelectValue />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"location\">Location</SelectItem>\n                      <SelectItem value=\"gestion_complete\">Gestion complète</SelectItem>\n                      <SelectItem value=\"vente\">Vente</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            {/* Bien spécifique ou global */}\n            <FormField\n              control={form.control}\n              name=\"property_id\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel className=\"flex items-center gap-2\">\n                    Bien concerné (optionnel)\n                    <ContextualTooltip\n                      id=\"mandate_scope\"\n                      title=\"Mandat spécifique vs Global\"\n                      content=\"Mandat spécifique : l'agence gère UN seul bien. Mandat global : l'agence gère TOUS vos biens actuels et futurs. Idéal pour une gestion centralisée.\"\n                    />\n                  </FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"Tous mes biens (mandat global)\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"\">Tous mes biens</SelectItem>\n                      {properties.map(property => (\n                        <SelectItem key={property.id} value={property.id}>\n                          {property.title}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                  <FormDescription>\n                    Laissez vide pour un mandat global sur tous vos biens\n                  </FormDescription>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            {/* Conditions financières */}\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"commission_rate\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel className=\"flex items-center gap-2\">\n                      Commission (%)\n                      <ContextualTooltip\n                        id=\"commission_rate\"\n                        title=\"Commission\"\n                        content=\"Pourcentage prélevé sur les loyers perçus. Exemple : 10% signifie que l'agence touchera 10% du loyer mensuel. Négociez ce taux avec votre agence.\"\n                      />\n                    </FormLabel>\n                    <FormControl>\n                      <Input type=\"number\" min=\"0\" max=\"100\" step=\"0.1\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"fixed_fee\"\n                render={({ field }) => (\n                  <FormItem>\n                      <FormLabel className=\"flex items-center gap-2\">\n                        Frais fixes (FCFA)\n                        <ContextualTooltip\n                          id=\"fixed_fee\"\n                          title=\"Frais fixes\"\n                          content=\"Montant fixe payé à l'agence indépendamment des loyers. Exemple : 50 000 FCFA/mois. Vous pouvez combiner commission + frais fixes selon votre accord.\"\n                        />\n                      </FormLabel>\n                      <FormControl>\n                      <Input type=\"number\" min=\"0\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <FormField\n              control={form.control}\n              name=\"billing_frequency\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Fréquence de facturation</FormLabel>\n                  <Select onValueChange={field.onChange} defaultValue={field.value}>\n                    <FormControl>\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"Sélectionnez\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      <SelectItem value=\"mensuel\">Mensuel</SelectItem>\n                      <SelectItem value=\"trimestriel\">Trimestriel</SelectItem>\n                      <SelectItem value=\"annuel\">Annuel</SelectItem>\n                      <SelectItem value=\"par_transaction\">Par transaction</SelectItem>\n                    </SelectContent>\n                  </Select>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            {/* Dates */}\n            <div className=\"grid grid-cols-2 gap-4\">\n              <FormField\n                control={form.control}\n                name=\"start_date\"\n                render={({ field }) => (\n                  <FormItem className=\"flex flex-col\">\n                    <FormLabel>Date de début</FormLabel>\n                    <Popover>\n                      <PopoverTrigger asChild>\n                        <FormControl>\n                          <Button variant=\"outline\" className={cn(!field.value && \"text-muted-foreground\")}>\n                            {field.value ? format(field.value, \"PPP\", { locale: fr }) : \"Sélectionner\"}\n                            <CalendarIcon className=\"ml-auto h-4 w-4 opacity-50\" />\n                          </Button>\n                        </FormControl>\n                      </PopoverTrigger>\n                      <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                        <Calendar mode=\"single\" selected={field.value} onSelect={field.onChange} initialFocus />\n                      </PopoverContent>\n                    </Popover>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"end_date\"\n                render={({ field }) => (\n                  <FormItem className=\"flex flex-col\">\n                    <FormLabel>Date de fin (optionnel)</FormLabel>\n                    <Popover>\n                      <PopoverTrigger asChild>\n                        <FormControl>\n                          <Button variant=\"outline\" className={cn(!field.value && \"text-muted-foreground\")}>\n                            {field.value ? format(field.value, \"PPP\", { locale: fr }) : \"Indéterminé\"}\n                            <CalendarIcon className=\"ml-auto h-4 w-4 opacity-50\" />\n                          </Button>\n                        </FormControl>\n                      </PopoverTrigger>\n                      <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                        <Calendar mode=\"single\" selected={field.value} onSelect={field.onChange} initialFocus />\n                      </PopoverContent>\n                    </Popover>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            {/* Permissions */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-base\">Permissions</CardTitle>\n                <CardDescription>Définissez ce que l'agence peut faire</CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <FormField\n                  control={form.control}\n                  name=\"permissions.can_view_properties\"\n                  render={({ field }) => (\n                    <FormItem className=\"flex items-center justify-between\">\n                      <FormLabel className=\"text-sm font-normal\">Voir les propriétés</FormLabel>\n                      <FormControl>\n                        <Switch checked={field.value} onCheckedChange={field.onChange} />\n                      </FormControl>\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"permissions.can_edit_properties\"\n                  render={({ field }) => (\n                    <FormItem className=\"flex items-center justify-between\">\n                      <FormLabel className=\"text-sm font-normal\">Modifier les propriétés</FormLabel>\n                      <FormControl>\n                        <Switch checked={field.value} onCheckedChange={field.onChange} />\n                      </FormControl>\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"permissions.can_view_applications\"\n                  render={({ field }) => (\n                    <FormItem className=\"flex items-center justify-between\">\n                      <FormLabel className=\"text-sm font-normal\">Voir les candidatures</FormLabel>\n                      <FormControl>\n                        <Switch checked={field.value} onCheckedChange={field.onChange} />\n                      </FormControl>\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"permissions.can_manage_applications\"\n                  render={({ field }) => (\n                    <FormItem className=\"flex items-center justify-between\">\n                      <FormLabel className=\"text-sm font-normal\">Gérer les candidatures</FormLabel>\n                      <FormControl>\n                        <Switch checked={field.value} onCheckedChange={field.onChange} />\n                      </FormControl>\n                    </FormItem>\n                  )}\n                />\n                <FormField\n                  control={form.control}\n                  name=\"permissions.can_create_leases\"\n                  render={({ field }) => (\n                    <FormItem className=\"flex items-center justify-between\">\n                      <FormLabel className=\"text-sm font-normal\">Créer des baux</FormLabel>\n                      <FormControl>\n                        <Switch checked={field.value} onCheckedChange={field.onChange} />\n                      </FormControl>\n                    </FormItem>\n                  )}\n                />\n              </CardContent>\n            </Card>\n\n            {/* Notes */}\n            <FormField\n              control={form.control}\n              name=\"notes\"\n              render={({ field }) => (\n                <FormItem>\n                  <FormLabel>Notes (optionnel)</FormLabel>\n                  <FormControl>\n                    <Textarea {...field} rows={3} />\n                  </FormControl>\n                  <FormMessage />\n                </FormItem>\n              )}\n            />\n\n            <div className=\"flex justify-end gap-3\">\n              <Button type=\"button\" variant=\"outline\" onClick={() => onOpenChange(false)}>\n                Annuler\n              </Button>\n              <Button \n                type=\"submit\"\n                disabled={!!duplicateWarning}\n              >\n                Envoyer l'invitation\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n\n      {/* Confirmation dialog */}\n      <AlertDialog open={confirmDialogOpen} onOpenChange={setConfirmDialogOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Confirmer l'invitation</AlertDialogTitle>\n            <AlertDialogDescription>\n              Vous êtes sur le point d'inviter une agence à gérer {pendingSubmission?.property_id ? 'ce bien' : 'tous vos biens'}.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          \n          {pendingSubmission && (\n            <div className=\"space-y-2 py-4\">\n              <div className=\"grid grid-cols-2 gap-2 text-sm\">\n                <span className=\"text-muted-foreground\">Type de mandat:</span>\n                <span className=\"font-medium\">\n                  {pendingSubmission.mandate_type === 'location' ? 'Location' : \n                   pendingSubmission.mandate_type === 'gestion_complete' ? 'Gestion complète' : 'Vente'}\n                </span>\n                \n                <span className=\"text-muted-foreground\">Portée:</span>\n                <span className=\"font-medium\">\n                  {pendingSubmission.property_id ? 'Bien spécifique' : 'Tous les biens'}\n                </span>\n                \n                <span className=\"text-muted-foreground\">Début:</span>\n                <span className=\"font-medium\">\n                  {format(new Date(pendingSubmission.start_date), 'dd MMMM yyyy', { locale: fr })}\n                </span>\n                \n                {pendingSubmission.end_date && (\n                  <>\n                    <span className=\"text-muted-foreground\">Fin:</span>\n                    <span className=\"font-medium\">\n                      {format(new Date(pendingSubmission.end_date), 'dd MMMM yyyy', { locale: fr })}\n                    </span>\n                  </>\n                )}\n                \n                {pendingSubmission.commission_rate && (\n                  <>\n                    <span className=\"text-muted-foreground\">Commission:</span>\n                    <span className=\"font-medium\">{pendingSubmission.commission_rate}%</span>\n                  </>\n                )}\n                \n                {pendingSubmission.fixed_fee && (\n                  <>\n                    <span className=\"text-muted-foreground\">Frais fixes:</span>\n                    <span className=\"font-medium\">{pendingSubmission.fixed_fee} FCFA</span>\n                  </>\n                )}\n              </div>\n            </div>\n          )}\n          \n          <AlertDialogFooter>\n            <AlertDialogCancel onClick={() => setPendingSubmission(null)}>\n              Annuler\n            </AlertDialogCancel>\n            <AlertDialogAction onClick={handleConfirmedSubmit}>\n              Confirmer l'invitation\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </Dialog>\n  );\n}\n","import { AgencyMandate, useAgencyMandates } from '@/hooks/useAgencyMandates';\nimport { useAuth } from '@/hooks/useAuth';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { Building2, Edit, Trash2, CheckCircle, XCircle } from 'lucide-react';\nimport { format } from 'date-fns';\nimport { fr } from 'date-fns/locale';\nimport { ContextualTooltip } from '@/components/help/ContextualTooltip';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\nimport { Textarea } from '@/components/ui/textarea';\nimport { useState } from 'react';\n\ninterface MandateCardProps {\n  mandate: AgencyMandate;\n}\n\nexport function MandateCard({ mandate }: MandateCardProps) {\n  const { terminateMandate, acceptMandate, refuseMandate } = useAgencyMandates();\n  const { user } = useAuth();\n  const [terminationReason, setTerminationReason] = useState('');\n  const [refusalReason, setRefusalReason] = useState('');\n\n  const getStatusBadge = (status: AgencyMandate['status']) => {\n    const variants = {\n      pending: { variant: 'secondary' as const, label: 'En attente' },\n      active: { variant: 'default' as const, label: 'Actif' },\n      suspended: { variant: 'outline' as const, label: 'Suspendu' },\n      terminated: { variant: 'destructive' as const, label: 'Résilié' },\n      expired: { variant: 'outline' as const, label: 'Expiré' },\n    };\n    const config = variants[status];\n    return <Badge variant={config.variant}>{config.label}</Badge>;\n  };\n\n  const getMandateTypeLabel = (type: AgencyMandate['mandate_type']) => {\n    const labels = {\n      location: 'Location',\n      gestion_complete: 'Gestion complète',\n      vente: 'Vente',\n    };\n    return labels[type];\n  };\n\n  return (\n    <Card>\n      <CardHeader>\n        <div className=\"flex items-start justify-between\">\n              <div className=\"flex-1\">\n                <div className=\"flex items-center gap-2 mb-2\">\n                  <CardTitle className=\"text-lg\">\n                    {getMandateTypeLabel(mandate.mandate_type)}\n                  </CardTitle>\n                  {getStatusBadge(mandate.status)}\n                  <ContextualTooltip\n                    id=\"mandate_status\"\n                    title=\"Statut du mandat\"\n                    content={\n                      mandate.status === 'pending' ? 'En attente d\\'acceptation par l\\'agence' :\n                      mandate.status === 'active' ? 'Mandat actif - L\\'agence gère vos biens' :\n                      mandate.status === 'suspended' ? 'Mandat suspendu temporairement' :\n                      mandate.status === 'terminated' ? 'Mandat résilié - Plus aucune permission' :\n                      'Mandat expiré à la date prévue'\n                    }\n                  />\n                </div>\n                <CardDescription>\n                  {mandate.property_id ? 'Mandat spécifique' : 'Mandat global'} \n                  {' • '}\n                  Depuis le {format(new Date(mandate.start_date), 'dd MMMM yyyy', { locale: fr })}\n                  {mandate.end_date ? ` jusqu'au ${format(new Date(mandate.end_date), 'dd MMMM yyyy', { locale: fr })}` : ' • Durée indéterminée'}\n                </CardDescription>\n              </div>\n\n          {/* Boutons pour l'agence (mandat en attente) */}\n          {mandate.status === 'pending' && user?.id === mandate.agency_id && (\n            <div className=\"flex gap-2\">\n              <Button \n                size=\"sm\" \n                variant=\"default\"\n                onClick={() => acceptMandate(mandate.id)}\n              >\n                <CheckCircle className=\"h-4 w-4 mr-1\" />\n                Accepter\n              </Button>\n              \n              <AlertDialog>\n                <AlertDialogTrigger asChild>\n                  <Button size=\"sm\" variant=\"outline\">\n                    <XCircle className=\"h-4 w-4 mr-1\" />\n                    Refuser\n                  </Button>\n                </AlertDialogTrigger>\n                <AlertDialogContent>\n                  <AlertDialogHeader>\n                    <AlertDialogTitle>Refuser ce mandat ?</AlertDialogTitle>\n                    <AlertDialogDescription>\n                      Le propriétaire sera notifié de votre refus. Cette action est définitive.\n                    </AlertDialogDescription>\n                  </AlertDialogHeader>\n                  <div className=\"py-4\">\n                    <label className=\"text-sm font-medium\">Motif de refus (obligatoire)</label>\n                    <Textarea\n                      value={refusalReason}\n                      onChange={(e) => setRefusalReason(e.target.value)}\n                      placeholder=\"Expliquez pourquoi vous refusez ce mandat...\"\n                      className=\"mt-2\"\n                      rows={3}\n                    />\n                  </div>\n                  <AlertDialogFooter>\n                    <AlertDialogCancel onClick={() => setRefusalReason('')}>Annuler</AlertDialogCancel>\n                    <AlertDialogAction\n                      onClick={() => {\n                        if (refusalReason.trim()) {\n                          refuseMandate({ \n                            mandateId: mandate.id, \n                            reason: refusalReason \n                          });\n                          setRefusalReason('');\n                        }\n                      }}\n                      disabled={!refusalReason.trim()}\n                      className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                    >\n                      Confirmer le refus\n                    </AlertDialogAction>\n                  </AlertDialogFooter>\n                </AlertDialogContent>\n              </AlertDialog>\n            </div>\n          )}\n\n          {/* Boutons pour le propriétaire (mandat actif) */}\n          {mandate.status === 'active' && user?.id === mandate.owner_id && (\n            <div className=\"flex gap-2\">\n              <AlertDialog>\n                <AlertDialogTrigger asChild>\n                  <Button size=\"sm\" variant=\"destructive\">\n                    <Trash2 className=\"h-4 w-4 mr-1\" />\n                    Résilier\n                  </Button>\n                </AlertDialogTrigger>\n                <AlertDialogContent>\n                  <AlertDialogHeader>\n                    <AlertDialogTitle>Résilier ce mandat ?</AlertDialogTitle>\n                    <AlertDialogDescription>\n                      L'agence perdra immédiatement l'accès à vos biens. Cette action est irréversible.\n                    </AlertDialogDescription>\n                  </AlertDialogHeader>\n                  <div className=\"py-4\">\n                    <label className=\"text-sm font-medium\">Motif de résiliation</label>\n                    <Textarea\n                      value={terminationReason}\n                      onChange={(e) => setTerminationReason(e.target.value)}\n                      placeholder=\"Expliquez pourquoi vous résiliez ce mandat...\"\n                      className=\"mt-2\"\n                      rows={3}\n                    />\n                  </div>\n                  <AlertDialogFooter>\n                    <AlertDialogCancel>Annuler</AlertDialogCancel>\n                    <AlertDialogAction\n                      onClick={() => {\n                        terminateMandate({ \n                          mandateId: mandate.id, \n                          reason: terminationReason || 'Résilié par le propriétaire' \n                        });\n                      }}\n                      className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                    >\n                      Confirmer la résiliation\n                    </AlertDialogAction>\n                  </AlertDialogFooter>\n                </AlertDialogContent>\n              </AlertDialog>\n            </div>\n          )}\n        </div>\n      </CardHeader>\n\n      <CardContent>\n        <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n          {mandate.commission_rate && (\n            <div>\n              <p className=\"text-sm text-muted-foreground\">Commission</p>\n              <p className=\"font-medium\">{mandate.commission_rate}%</p>\n            </div>\n          )}\n          {mandate.fixed_fee && (\n            <div>\n              <p className=\"text-sm text-muted-foreground\">Frais fixes</p>\n              <p className=\"font-medium\">{mandate.fixed_fee} FCFA</p>\n            </div>\n          )}\n          {mandate.billing_frequency && (\n            <div>\n              <p className=\"text-sm text-muted-foreground\">Facturation</p>\n              <p className=\"font-medium capitalize\">{mandate.billing_frequency}</p>\n            </div>\n          )}\n          {mandate.end_date && (\n            <div>\n              <p className=\"text-sm text-muted-foreground\">Fin prévue</p>\n              <p className=\"font-medium\">\n                {format(new Date(mandate.end_date), 'dd/MM/yyyy')}\n              </p>\n            </div>\n          )}\n        </div>\n\n        {/* Permissions */}\n        <div className=\"mt-4 pt-4 border-t\">\n          <p className=\"text-sm font-medium mb-2\">Permissions accordées :</p>\n          <div className=\"flex flex-wrap gap-2\">\n            {Object.entries(mandate.permissions)\n              .filter(([_, value]) => value)\n              .map(([key]) => (\n                <Badge key={key} variant=\"secondary\" className=\"text-xs\">\n                  {key.replace('can_', '').replace(/_/g, ' ')}\n                </Badge>\n              ))}\n          </div>\n        </div>\n\n        {(mandate.notes || mandate.termination_reason) && (\n          <div className=\"mt-4 pt-4 border-t\">\n            <p className=\"text-sm text-muted-foreground\">\n              {mandate.termination_reason || mandate.notes}\n            </p>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n","import { useState } from 'react';\nimport { useAuth } from '@/hooks/useAuth';\nimport { useAgencyMandates } from '@/hooks/useAgencyMandates';\nimport { useAgencyProperties } from '@/hooks/useAgencyProperties';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Alert, AlertDescription } from '@/components/ui/alert';\nimport { Plus, Building2, Users, Home, DollarSign, AlertTriangle, HelpCircle } from 'lucide-react';\nimport { Navigate, Link } from 'react-router-dom';\nimport { InviteAgencyDialog } from '@/components/mandates/InviteAgencyDialog';\nimport { MandateCard } from '@/components/mandates/MandateCard';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\n\nexport default function MyMandates() {\n  const { profile } = useAuth();\n  const { asOwner, isLoading } = useAgencyMandates();\n  const { stats: agencyStats } = useAgencyProperties();\n  const [inviteDialogOpen, setInviteDialogOpen] = useState(false);\n\n  // Redirection si pas propriétaire\n  if (profile && profile.user_type !== 'proprietaire' && profile.user_type !== 'agence') {\n    return <Navigate to=\"/dashboard\" replace />;\n  }\n\n  const activeMandates = asOwner.filter(m => m.status === 'active');\n  const pendingMandates = asOwner.filter(m => m.status === 'pending');\n  const terminatedMandates = asOwner.filter(m => \n    m.status === 'terminated' || m.status === 'expired'\n  );\n\n  // Mandats expirant dans moins de 30 jours\n  const expiringSoon = activeMandates.filter(m => {\n    if (!m.end_date) return false;\n    const daysUntilExpiry = (new Date(m.end_date).getTime() - Date.now()) / (1000 * 60 * 60 * 24);\n    return daysUntilExpiry > 0 && daysUntilExpiry <= 30;\n  });\n\n  // Calculate statistics\n  const totalCommissionRevenue = activeMandates.reduce((acc, m) => {\n    if (m.commission_rate && agencyStats.totalProperties) {\n      // Estimation simplifiée: supposons un loyer moyen de 150000 FCFA\n      return acc + (150000 * (m.commission_rate / 100));\n    }\n    return acc + (m.fixed_fee || 0);\n  }, 0);\n\n  return (\n    <div className=\"container mx-auto py-8 space-y-8\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">Mes mandats de gestion</h1>\n          <p className=\"text-muted-foreground mt-2\">\n            Gérez les agences qui ont accès à vos biens\n          </p>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          <Button variant=\"ghost\" size=\"sm\" asChild>\n            <Link to=\"/mandates/help\" className=\"gap-2\">\n              <HelpCircle className=\"h-4 w-4\" />\n              Aide\n            </Link>\n          </Button>\n          <Button onClick={() => setInviteDialogOpen(true)} size=\"lg\">\n            <Plus className=\"h-5 w-5 mr-2\" />\n            Inviter une agence\n          </Button>\n        </div>\n      </div>\n\n      {/* Alertes */}\n      {expiringSoon.length > 0 && (\n        <Alert variant=\"destructive\">\n          <AlertTriangle className=\"h-4 w-4\" />\n          <AlertDescription>\n            ⚠️ {expiringSoon.length} mandat{expiringSoon.length > 1 ? 's' : ''} expire\n            {expiringSoon.length > 1 ? 'nt' : ''} dans les 30 prochains jours.\n          </AlertDescription>\n        </Alert>\n      )}\n\n      {/* Stats */}\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-6\">\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Mandats actifs</CardTitle>\n            <Building2 className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{activeMandates.length}</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {asOwner.length} total\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Biens sous mandat</CardTitle>\n            <Home className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{agencyStats.totalProperties || 0}</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              {agencyStats.totalOwners || 0} propriétaires\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\n            <CardTitle className=\"text-sm font-medium\">Revenus estimés</CardTitle>\n            <DollarSign className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">\n              {Math.round(totalCommissionRevenue).toLocaleString()}\n            </div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              FCFA / mois\n            </p>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\n            <CardTitle className=\"text-sm font-medium\">En attente</CardTitle>\n            <Users className=\"h-4 w-4 text-muted-foreground\" />\n          </CardHeader>\n          <CardContent>\n            <div className=\"text-2xl font-bold\">{pendingMandates.length}</div>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Invitations envoyées\n            </p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Liste des mandats */}\n      <Tabs defaultValue=\"active\" className=\"space-y-6\">\n        <TabsList className=\"grid w-full grid-cols-3\">\n          <TabsTrigger value=\"active\">\n            Actifs ({activeMandates.length})\n          </TabsTrigger>\n          <TabsTrigger value=\"pending\">\n            En attente ({pendingMandates.length})\n          </TabsTrigger>\n          <TabsTrigger value=\"terminated\">\n            Terminés ({terminatedMandates.length})\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"active\" className=\"space-y-4\">\n          {activeMandates.length === 0 ? (\n            <Card>\n              <CardContent className=\"pt-6\">\n                <div className=\"text-center py-12\">\n                  <Building2 className=\"mx-auto h-12 w-12 text-muted-foreground mb-4\" />\n                  <h3 className=\"text-lg font-semibold mb-2\">Aucun mandat actif</h3>\n                  <p className=\"text-muted-foreground mb-4\">\n                    Invitez une agence pour commencer à déléguer la gestion de vos biens\n                  </p>\n                  <Button onClick={() => setInviteDialogOpen(true)}>\n                    <Plus className=\"mr-2 h-4 w-4\" />\n                    Inviter une agence\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"grid gap-4\">\n              {activeMandates.map(mandate => (\n                <MandateCard key={mandate.id} mandate={mandate} />\n              ))}\n            </div>\n          )}\n        </TabsContent>\n\n        <TabsContent value=\"pending\" className=\"space-y-4\">\n          {pendingMandates.length === 0 ? (\n            <Card>\n              <CardContent className=\"pt-6\">\n                <div className=\"text-center py-12 text-muted-foreground\">\n                  Aucune invitation en attente\n                </div>\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"grid gap-4\">\n              {pendingMandates.map(mandate => (\n                <MandateCard key={mandate.id} mandate={mandate} />\n              ))}\n            </div>\n          )}\n        </TabsContent>\n\n        <TabsContent value=\"terminated\" className=\"space-y-4\">\n          {terminatedMandates.length === 0 ? (\n            <Card>\n              <CardContent className=\"pt-6\">\n                <div className=\"text-center py-12 text-muted-foreground\">\n                  Aucun mandat terminé\n                </div>\n              </CardContent>\n            </Card>\n          ) : (\n            <div className=\"grid gap-4\">\n              {terminatedMandates.map(mandate => (\n                <MandateCard key={mandate.id} mandate={mandate} />\n              ))}\n            </div>\n          )}\n        </TabsContent>\n      </Tabs>\n\n      <InviteAgencyDialog \n        open={inviteDialogOpen} \n        onOpenChange={setInviteDialogOpen}\n      />\n    </div>\n  );\n}\n"],"names":["Command","React.forwardRef","className","props","ref","jsx","CommandPrimitive","cn","CommandInput","jsxs","Search","CommandList","CommandEmpty","CommandGroup","CommandSeparator","CommandItem","useHelpSystem","isHelpOpen","setIsHelpOpen","useState","searchQuery","setSearchQuery","trackInteraction","useCallback","helpType","contentId","user","supabase","logger","openHelp","closeHelp","searchHelp","query","ContextualTooltip","id","title","content","videoUrl","TooltipProvider","Tooltip","TooltipTrigger","HelpCircle","TooltipContent","formSchema","z.object","z.string","z.enum","z.coerce","z.date","z.boolean","data","InviteAgencyDialog","open","onOpenChange","createMandate","asOwner","useAgencyMandates","properties","useProperties","agencies","setAgencies","loadingAgencies","setLoadingAgencies","agenciesOpen","setAgenciesOpen","duplicateWarning","setDuplicateWarning","confirmDialogOpen","setConfirmDialogOpen","pendingSubmission","setPendingSubmission","form","useForm","zodResolver","useEffect","error","a","agencyId","propertyId","hasDuplicate","m","onSubmit","values","submissionData","_a","handleConfirmedSubmit","Dialog","DialogContent","DialogHeader","DialogTitle","Button","Link","DialogDescription","Form","FormField","field","FormItem","FormLabel","Popover","PopoverTrigger","FormControl","agency","PopoverContent","Building2","FormDescription","FormMessage","Alert","AlertTriangle","AlertDescription","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","property","Input","format","fr","CalendarIcon","Calendar","Card","CardHeader","CardTitle","CardDescription","CardContent","Switch","Textarea","AlertDialog","AlertDialogContent","AlertDialogHeader","AlertDialogTitle","AlertDialogDescription","Fragment","AlertDialogFooter","AlertDialogCancel","AlertDialogAction","MandateCard","mandate","terminateMandate","acceptMandate","refuseMandate","useAuth","terminationReason","setTerminationReason","refusalReason","setRefusalReason","getStatusBadge","status","config","Badge","getMandateTypeLabel","type","CheckCircle","AlertDialogTrigger","XCircle","e","Trash2","_","value","key","MyMandates","profile","agencyStats","useAgencyProperties","inviteDialogOpen","setInviteDialogOpen","Navigate","activeMandates","pendingMandates","terminatedMandates","expiringSoon","daysUntilExpiry","totalCommissionRevenue","acc","Plus","Home","DollarSign","Users","Tabs","TabsList","TabsTrigger","TabsContent"],"mappings":"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"}