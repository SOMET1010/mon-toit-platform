{"version":3,"file":"AddProperty-B0ajWnQ5.js","sources":["../../src/components/property/TitleDeedUploader.tsx","../../src/pages/AddProperty.tsx"],"sourcesContent":["import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { supabase } from \"@/lib/supabase\";\nimport { Upload, FileText, X, Loader2, CheckCircle } from \"lucide-react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { logger } from \"@/services/logger\";\n\ninterface TitleDeedUploaderProps {\n  propertyId: string;\n  onUploadSuccess?: (url: string) => void;\n  existingUrl?: string | null;\n}\n\nexport const TitleDeedUploader = ({\n  propertyId,\n  onUploadSuccess,\n  existingUrl,\n}: TitleDeedUploaderProps) => {\n  const [uploading, setUploading] = useState(false);\n  const [uploadedUrl, setUploadedUrl] = useState<string | null>(existingUrl || null);\n  const { toast } = useToast();\n\n  const handleFileSelect = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    // Validation\n    const maxSize = 10 * 1024 * 1024; // 10 MB\n    const allowedTypes = ['application/pdf', 'image/jpeg', 'image/png'];\n\n    if (file.size > maxSize) {\n      toast({\n        title: \"‚ùå Fichier trop volumineux\",\n        description: \"La taille maximale est de 10 MB\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    if (!allowedTypes.includes(file.type)) {\n      toast({\n        title: \"‚ùå Format non accept√©\",\n        description: \"Formats accept√©s : PDF, JPEG, PNG\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    setUploading(true);\n    try {\n      // Structure: /property-documents/{propertyId}/title_deed.{ext}\n      const fileExt = file.name.split('.').pop();\n      const filePath = `${propertyId}/title_deed.${fileExt}`;\n\n      const { data, error } = await supabase.storage\n        .from('property-documents')\n        .upload(filePath, file, {\n          upsert: true, // Remplacer si existe\n          cacheControl: '3600',\n        });\n\n      if (error) throw error;\n\n      const fullPath = `property-documents/${data.path}`;\n      setUploadedUrl(fullPath);\n      onUploadSuccess?.(fullPath);\n\n      toast({\n        title: \"‚úÖ Titre de propri√©t√© ajout√©\",\n        description: \"Le document a √©t√© upload√© avec succ√®s\",\n      });\n    } catch (error: any) {\n      logger.logError(error, { context: 'TitleDeedUploader', action: 'upload', propertyId });\n      toast({\n        title: \"‚ùå Erreur d'upload\",\n        description: error.message || \"Impossible d'uploader le fichier\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  const handleRemove = async () => {\n    if (!uploadedUrl) return;\n\n    try {\n      const pathParts = uploadedUrl.split('property-documents/')[1];\n      const { error } = await supabase.storage\n        .from('property-documents')\n        .remove([pathParts]);\n\n      if (error) throw error;\n\n      setUploadedUrl(null);\n      onUploadSuccess?.(\"\");\n\n      toast({\n        title: \"‚úÖ Document supprim√©\",\n        description: \"Le titre de propri√©t√© a √©t√© retir√©\",\n      });\n    } catch (error: any) {\n      logger.logError(error, { context: 'TitleDeedUploader', action: 'remove', propertyId });\n      toast({\n        title: \"‚ùå Erreur\",\n        description: \"Impossible de supprimer le fichier\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <Alert>\n        <FileText className=\"h-4 w-4\" />\n        <AlertDescription>\n          <strong>Document officiel :</strong> Le titre de propri√©t√© sera accessible uniquement\n          au propri√©taire, aux locataires avec un bail actif, et aux administrateurs.\n        </AlertDescription>\n      </Alert>\n\n      {uploadedUrl ? (\n        <Card className=\"border-success\">\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-3\">\n                <CheckCircle className=\"h-5 w-5 text-success\" />\n                <div>\n                  <p className=\"font-medium\">Titre de propri√©t√© ajout√©</p>\n                  <p className=\"text-sm text-muted-foreground\">Document s√©curis√©</p>\n                </div>\n              </div>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={handleRemove}\n                disabled={uploading}\n              >\n                <X className=\"h-4 w-4\" />\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      ) : (\n        <div className=\"border-2 border-dashed rounded-lg p-8 text-center\">\n          <input\n            type=\"file\"\n            id=\"title-deed-input\"\n            className=\"hidden\"\n            accept=\".pdf,.jpg,.jpeg,.png\"\n            onChange={handleFileSelect}\n            disabled={uploading}\n          />\n          <label htmlFor=\"title-deed-input\" className=\"cursor-pointer\">\n            {uploading ? (\n              <div className=\"flex flex-col items-center gap-3\">\n                <Loader2 className=\"h-12 w-12 animate-spin text-primary\" />\n                <p className=\"text-sm text-muted-foreground\">Upload en cours...</p>\n              </div>\n            ) : (\n              <div className=\"flex flex-col items-center gap-3\">\n                <Upload className=\"h-12 w-12 text-muted-foreground\" />\n                <div>\n                  <p className=\"font-medium\">Cliquez pour ajouter le titre de propri√©t√©</p>\n                  <p className=\"text-sm text-muted-foreground mt-1\">\n                    PDF, JPEG ou PNG (max 10 MB)\n                  </p>\n                </div>\n              </div>\n            )}\n          </label>\n        </div>\n      )}\n\n      <p className=\"text-xs text-muted-foreground\">\n        üîí Ce document sera stock√© de mani√®re s√©curis√©e et soumis √† des contr√¥les d'acc√®s stricts.\n      </p>\n    </div>\n  );\n};\n","import { useState, useEffect, useRef } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { usePropertyForm } from '@/hooks/usePropertyForm';\nimport { useMediaUpload, type MediaFiles } from '@/hooks/useMediaUpload';\nimport { usePropertyPermissions } from '@/hooks/usePropertyPermissions';\nimport { toast } from '@/hooks/use-toast';\nimport Navbar from '@/components/Navbar';\nimport Footer from '@/components/Footer';\nimport { DynamicBreadcrumb } from '@/components/navigation/DynamicBreadcrumb';\nimport { FormProgressIndicator, type Step } from '@/components/forms/FormProgressIndicator';\nimport { FormStepper } from '@/components/forms/FormStepper';\nimport { StickyHeader } from '@/components/ui/sticky-header';\nimport { Button } from '@/components/ui/button';\nimport { Form } from '@/components/ui/form';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Loader2, Save } from 'lucide-react';\nimport { MediaUploader } from '@/components/property/MediaUploader';\nimport { type PropertyFormData } from '@/components/property/form/PropertyFormSchema';\nimport { PropertyBasicInfo } from '@/components/property/form/PropertyBasicInfo';\nimport { PropertyLocation } from '@/components/property/form/PropertyLocation';\nimport { PropertyCharacteristicsForm } from '@/components/property/form/PropertyCharacteristicsForm';\nimport { PropertyPricing } from '@/components/property/form/PropertyPricing';\nimport { PropertyWorkStatus } from '@/components/property/form/PropertyWorkStatus';\nimport { LocationPicker } from '@/components/property/LocationPicker';\nimport { TitleDeedUploader } from '@/components/property/TitleDeedUploader';\nimport { NavigationHelp } from '@/components/navigation/NavigationHelp';\nimport { LazyIllustration } from '@/components/illustrations/LazyIllustration';\nimport { getIllustrationPath } from '@/lib/utils';\n\nconst propertyFormSteps: Step[] = [\n  { id: 'basic', label: 'Type de bien' },\n  { id: 'location', label: 'Informations g√©n√©rales' },\n  { id: 'characteristics', label: 'Photos et description' },\n  { id: 'pricing', label: 'Prix et disponibilit√©' },\n  { id: 'media', label: 'V√©rification' }\n];\n\nconst AddProperty = () => {\n  const [currentStep, setCurrentStep] = useState(0);\n  const [isSticky, setIsSticky] = useState(false);\n  const basicInfoRef = useRef<HTMLDivElement>(null);\n  const locationRef = useRef<HTMLDivElement>(null);\n  const characteristicsRef = useRef<HTMLDivElement>(null);\n  const pricingRef = useRef<HTMLDivElement>(null);\n  const mediaRef = useRef<HTMLDivElement>(null);\n  const navigate = useNavigate();\n  const { requireOwnerAccess } = usePropertyPermissions();\n  const { form, submitting, submitProperty } = usePropertyForm();\n  const { uploading, progress, uploadMedia, validateMediaFiles } = useMediaUpload();\n  \n  const [mediaFiles, setMediaFiles] = useState<MediaFiles>({\n    images: [],\n    video: null,\n    panoramas: [],\n    floorPlans: [],\n    virtualTourUrl: '',\n  });\n\n  const [selectedLocation, setSelectedLocation] = useState<{lat: number, lng: number} | null>(null);\n  const [propertyId] = useState<string>(() => crypto.randomUUID());\n\n  // Track scroll position to update current step and sticky header\n  useEffect(() => {\n    const handleScroll = () => {\n      setIsSticky(window.scrollY > 100);\n      \n      const sections = [\n        { ref: basicInfoRef, step: 0 },\n        { ref: locationRef, step: 1 },\n        { ref: characteristicsRef, step: 2 },\n        { ref: pricingRef, step: 3 },\n        { ref: mediaRef, step: 4 }\n      ];\n\n      for (let i = sections.length - 1; i >= 0; i--) {\n        const section = sections[i];\n        if (section.ref.current) {\n          const rect = section.ref.current.getBoundingClientRect();\n          if (rect.top <= 200) {\n            setCurrentStep(section.step);\n            break;\n          }\n        }\n      }\n    };\n\n    window.addEventListener('scroll', handleScroll);\n    return () => window.removeEventListener('scroll', handleScroll);\n  }, []);\n\n  const onSubmit = async (data: PropertyFormData) => {\n    // Validate media files\n    const validation = validateMediaFiles(mediaFiles);\n    if (!validation.valid) {\n      validation.errors.forEach(error => {\n        toast({\n          title: \"Erreur\",\n          description: error,\n          variant: \"destructive\",\n        });\n      });\n      return;\n    }\n\n    try {\n      // 1. Create property first (without media URLs)\n      const propertyId = await submitProperty(data, {\n        images: [],\n        mainImage: null,\n        videoUrl: null,\n        panoramas: [],\n        floorPlans: [],\n      });\n\n      // 2. Upload all media\n      const mediaUrls = await uploadMedia(propertyId, mediaFiles);\n\n      // 3. Update property with media URLs\n      await submitProperty(data, mediaUrls, propertyId);\n\n      navigate('/mes-biens');\n    } catch (error) {\n      // Errors are already handled by the hooks\n    }\n  };\n\n  const accessCheck = requireOwnerAccess();\n  if (!accessCheck.hasAccess) {\n    return (\n      <div className=\"min-h-screen flex flex-col\">\n        <Navbar />\n        <main className=\"flex-1 container mx-auto px-4 py-12\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Acc√®s refus√©</CardTitle>\n              <CardDescription>\n                {accessCheck.error}\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <Button onClick={() => navigate('/')}>\n                Retour √† l'accueil\n              </Button>\n            </CardContent>\n          </Card>\n        </main>\n        <Footer />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen flex flex-col\">\n      <Navbar />\n      \n      {/* Sticky Header */}\n      {isSticky && (\n        <StickyHeader offsetTop=\"top-16\" className=\"shadow-md\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h2 className=\"font-semibold text-lg\">Nouvelle Propri√©t√©</h2>\n              <p className=\"text-sm text-muted-foreground\">\n                √âtape {currentStep + 1} sur {propertyFormSteps.length}\n              </p>\n            </div>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={() => {\n                toast({\n                  title: \"Brouillon sauvegard√©\",\n                  description: \"Vos modifications ont √©t√© enregistr√©es\",\n                });\n              }}\n              className=\"gap-2\"\n            >\n              <Save className=\"h-4 w-4\" />\n              Enregistrer brouillon\n            </Button>\n          </div>\n        </StickyHeader>\n      )}\n      \n      <main className=\"flex-1 container mx-auto px-4 py-8 pt-24\">\n        <div className=\"max-w-4xl mx-auto\">\n          <DynamicBreadcrumb />\n          \n          <div className=\"mb-6 mt-4\">\n            <NavigationHelp backTo=\"/dashboard\" backLabel=\"Retour au dashboard\" />\n          </div>\n\n          {/* Illustration motivante */}\n          <div className=\"mb-8 grid md:grid-cols-[1fr,300px] gap-6 items-center p-6 rounded-2xl bg-gradient-to-br from-primary/5 to-secondary/5 border border-border/50\">\n            <div className=\"space-y-2\">\n              <h1 className=\"text-3xl font-bold text-foreground\">Publiez votre bien</h1>\n              <p className=\"text-lg text-muted-foreground\">Remplissez le formulaire en quelques clics et touchez des milliers de locataires</p>\n            </div>\n            <LazyIllustration\n              src={getIllustrationPath(\"ivorian-family-house\")}\n              alt=\"Publier un bien\"\n              className=\"hidden md:block w-full h-[180px] rounded-xl\"\n              animate={true}\n            />\n          </div>\n\n          <FormStepper steps={propertyFormSteps} currentStep={currentStep} />\n          <FormProgressIndicator steps={propertyFormSteps} currentStep={currentStep} className=\"mt-6\" />\n\n          <Form {...form}>\n            <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-8\">\n              <div ref={basicInfoRef} className=\"scroll-mt-32\">\n                <PropertyBasicInfo form={form} />\n              </div>\n              <div ref={locationRef} className=\"scroll-mt-32\">\n                <PropertyLocation form={form} />\n              </div>\n              \n              <LocationPicker \n                city={form.watch(\"city\")}\n                onLocationSelect={(lat, lng) => setSelectedLocation({ lat, lng })}\n              />\n\n              <div ref={characteristicsRef} className=\"scroll-mt-32\">\n                <PropertyCharacteristicsForm form={form} />\n              </div>\n              <div ref={pricingRef} className=\"scroll-mt-32\">\n                <PropertyPricing form={form} />\n              </div>\n              <PropertyWorkStatus form={form} />\n\n              {/* Titre de propri√©t√© */}\n              <Card>\n                <CardHeader>\n                  <CardTitle>üìÑ Titre de propri√©t√© (optionnel)</CardTitle>\n                  <CardDescription>\n                    Document officiel attestant de votre propri√©t√© du bien (PDF, JPEG, PNG)\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <TitleDeedUploader\n                    propertyId={propertyId}\n                    onUploadSuccess={(url) => form.setValue(\"title_deed_url\", url)}\n                    existingUrl={form.watch(\"title_deed_url\")}\n                  />\n                </CardContent>\n              </Card>\n\n              {/* Multimedia */}\n              <Card ref={mediaRef} className=\"scroll-mt-32\">\n                <CardHeader>\n                  <CardTitle>M√©dias</CardTitle>\n                  <CardDescription>Ajoutez des photos, vid√©os, vues 360¬∞ et plans</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <MediaUploader\n                    onImagesChange={(files) => setMediaFiles(prev => ({ ...prev, images: files }))}\n                    onVideoChange={(file) => setMediaFiles(prev => ({ ...prev, video: file }))}\n                    onPanoramaChange={(files) => setMediaFiles(prev => ({ ...prev, panoramas: files }))}\n                    onFloorPlanChange={(files) => setMediaFiles(prev => ({ ...prev, floorPlans: files }))}\n                    onVirtualTourUrlChange={(url) => setMediaFiles(prev => ({ ...prev, virtualTourUrl: url }))}\n                    uploading={uploading}\n                  />\n                  \n                  {uploading && progress > 0 && (\n                    <div className=\"space-y-2\">\n                      <div className=\"flex justify-between text-sm\">\n                        <span>T√©l√©chargement des m√©dias...</span>\n                        <span>{progress}%</span>\n                      </div>\n                      <div className=\"w-full bg-secondary rounded-full h-2\">\n                        <div \n                          className=\"bg-primary h-2 rounded-full transition-all duration-300\"\n                          style={{ width: `${progress}%` }}\n                        />\n                      </div>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n\n              <div className=\"flex gap-4\">\n                <Button\n                  type=\"button\"\n                  variant=\"outline\"\n                  onClick={() => navigate('/mes-biens')}\n                  disabled={submitting || uploading}\n                  className=\"flex-1\"\n                >\n                  Annuler\n                </Button>\n                <Button type=\"submit\" disabled={submitting || uploading} className=\"flex-1\">\n                  {submitting || uploading ? (\n                    <>\n                      <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                      Publication en cours...\n                    </>\n                  ) : (\n                    'Publier le bien'\n                  )}\n                </Button>\n              </div>\n            </form>\n          </Form>\n        </div>\n      </main>\n\n      <Footer />\n    </div>\n  );\n};\n\nexport default AddProperty;\n"],"names":["TitleDeedUploader","propertyId","onUploadSuccess","existingUrl","uploading","setUploading","useState","uploadedUrl","setUploadedUrl","toast","useToast","handleFileSelect","e","file","_a","maxSize","allowedTypes","fileExt","filePath","data","error","supabase","fullPath","logger","handleRemove","pathParts","jsxs","Alert","jsx","FileText","AlertDescription","Card","CardContent","CheckCircle","Button","X","Loader2","Upload","propertyFormSteps","AddProperty","currentStep","setCurrentStep","isSticky","setIsSticky","basicInfoRef","useRef","locationRef","characteristicsRef","pricingRef","mediaRef","navigate","useNavigate","requireOwnerAccess","usePropertyPermissions","form","submitting","submitProperty","usePropertyForm","progress","uploadMedia","validateMediaFiles","useMediaUpload","mediaFiles","setMediaFiles","selectedLocation","setSelectedLocation","useEffect","handleScroll","sections","i","section","onSubmit","validation","mediaUrls","accessCheck","Navbar","StickyHeader","Save","DynamicBreadcrumb","NavigationHelp","LazyIllustration","getIllustrationPath","FormStepper","FormProgressIndicator","Form","PropertyBasicInfo","PropertyLocation","LocationPicker","lat","lng","PropertyCharacteristicsForm","PropertyPricing","PropertyWorkStatus","CardHeader","CardTitle","CardDescription","url","MediaUploader","files","prev","Fragment","Footer"],"mappings":"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"}